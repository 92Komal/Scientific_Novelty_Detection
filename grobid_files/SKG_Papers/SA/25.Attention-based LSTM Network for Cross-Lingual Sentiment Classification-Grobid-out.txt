title
Attention-based LSTM Network for Cross-Lingual Sentiment Classification

abstract
Most of the state-of-the-art sentiment classification methods are based on supervised learning algorithms which require large amounts of manually labeled data. However, the labeled resources are usually imbalanced in different languages. Cross-lingual sentiment classification tackles the problem by adapting the sentiment resources in a resource-rich language to resource-poor languages. In this study, we propose an attention-based bilingual representation learning model which learns the distributed semantics of the documents in both the source and the target languages. In each language, we use Long Short Term Memory (LSTM) network to model the documents, which has been proved to be very effective for word sequences. Meanwhile, we propose a hierarchical attention mechanism for the bilingual LSTM network. The sentence-level attention model learns which sentences of a document are more important for determining the overall sentiment while the word-level attention model learns which words in each sentence are decisive. The proposed model achieves good results on a benchmark dataset using English as the source language and Chinese as the target language.

Introduction Most of the sentiment analysis research focuses on sentiment classification which aims to determine whether the users attitude is positive, neutral or negative. There are two classes of mainstreaming sentiment classification algorithms: unsupervised methods which usually require a sentiment lexicon  (Taboada et al., 2011)  and supervised methods  (Pang et al., 2002)  which require manually labeled data. However, both of these sentiment resources are unbalanced in different languages. The sentiment lexicon or labeled data are rich in several languages such as English and are poor in others. Manually building these resources for all the languages will be expensive and time-consuming. Cross-lingual sentiment classification tackles the problem by trying to adapt the resources in one language to other languages. It can also be regarded as a special kind of cross-lingual text classification task. Recently, there have been several bilingual representation learning methods such as  (Hermann and Blunsom, 2014; Gouws et al., 2014)  for cross-lingual sentiment or text classification which achieve promising results. They try to learn a joint embedding space for different languages such that the training data in the source language can be directly applied to the test data in the target language. However, most of the studies only use simple functions, e.g. arithmetic average, to synthesize representations for larger text sequences. Some of them use more complicated compositional models such as the bi-gram non-linearity model in  (Hermann and Blunsom, 2014)  which also fail to capture the long distance dependencies in texts. In this study, we propose an attention-based bilingual LSTM network for cross-lingual sentiment classification. LSTMs have been proved to be very effective to model word sequences and are powerful to learn on data with long range temporal dependencies. After translating the training data into the target language using machine translation tools, we use the bidirectional LSTM network to model the documents in both of the source and the target languages. The LSTMs show strong ability to capture the compositional semantics for the bilingual texts in our experiments. For the traditional LSTM network, each word in the input document is treated with equal importance, which is reasonable for traditional text classification tasks. In this paper, we propose a hierarchical attention mechanism which enables our model to focus on certain part of the input document. The motivation mainly comes from the following three observations: 1) the machine translation tool that we use to translate the documents will always introduce much noise for sentiment classification. We hope that the attention mechanism can help to filter out these noises. 2) In each individual language, the sentiment of a document is usually decided by a relative small part of it. In a long review document, the user might discuss both the advantages and disadvantages of a product. The sentiment will be confusing if we consider each sentence of the same contribution. For example, in the first review of Table  1 , the first sentence reveals a negative sentiment towards the movie but the second one reveals a positive sentiment. As human readers, we can understand that the review is expressing a positive overall sentiment but it is hard for the sequence modeling algorithms including LSTM to capture. 3) At the sentence level, it is important to focus on the sentiment signals such as the sentiment words. They are usually very decisive to determine the polarity even for a very long sentence, e.g. "easy" and "nice" in the second example of Table  1 . "I felt it could have been a lot better with a little less comedy and a little more drama to get the point across. However, its still a must see for any Jim Carrey fan. " "It is easy to read, it is easy to look things up in and provides a nice section on the treatments." 2) We propose a hierarchical bilingual attention mechanism for our model. To the best of our knowledge, this is the first attention-based model designed for cross-lingual sentiment analysis. 3) The proposed framework achieves good results on a benchmark dataset from a cross-language sentiment classification evaluation. It outperforms the best team in the evaluation as well as several strong baseline methods. 

 Related Work Sentiment analysis is the field of studying and analyzing peoples opinions, sentiments, evaluations, appraisals, attitudes, and emotions  (Liu, 2012) . The most common task of sentiment analysis is polarity classification which arises with the emergence of customer reviews on the Internet.  Pang et al. (2002)  used supervised learning methods and achieved promising results with simple unigram and bi-gram features. In subsequent research, more features and learning algorithms were tried for sentiment classification by a large number of researchers. Recently, the emerging of deep learning has also shed light on this area. Lots of representation learning methods has been proposed to address the sentiment classification task and many of them achieve the state-of-the-art performance on several benchmark datasets, such as the recursive neural tensor network  (Socher et al., 2013), paragraph vector (Le and Mikolov, 2014) , multi-channel convolutional neural networks (Kim, 2012), dynamic convolutional neural network  (Blunsom et al., 2014)  and tree structure LSTM  (Tai et al., 2015) . Very recently,  Yang et al. (2016)  proposed a similar hierarchical attention network based on GRU in the monolingual setting. Note that our work is independent with theirs and their study was released online after we submitted this study. Cross-lingual sentiment classification is also a popular research topic in the sentiment analysis community which aims to solve the sentiment classification task from a cross-language view. It is of great importance since it can exploit the existing labeled information in a source language to build a sentiment classification system in any other target language. Cross-lingual sentiment classification has been extensively studied in the very recent years.  Mihalcea et al. (2007)  translated English subjectivity words and phrases into the target language to build a lexicon-based classifier.  Wan (2009)  translated both the training data (English to Chinese) and the test data (Chinese to English) to train different models in both the source and target languages.  Chen et al. (2015)  proposed a knowledge validation method and incorporated it into a boosting model to transfer credible information between the two languages during training. There have also been several studies addressing the task via multi-lingual text representation learning.  Xiao and Guo (2013)   Compared to the existing studies, we propose to use the bilingual LSTM network to learn the document representations of reviews in each individual language. It has obvious advantage to model the compositional semantics and to capture the long distance dependencies between words. Besides, we propose a hierarchical neural attention mechanism to capture the sentiment attention in each document. The attention model helps to filter out the noise which is irrelevant to the overall sentiment. 

 Preliminaries 

 Problem Definition Cross-language sentiment classification aims to use the training data in the source language to build a model which is adaptable for the test data in the target language. In our setting, we have labeled training data in English L EN = {x i , y i } N i=1 , where x i is the review text and y i is the sentiment label vector. y i = (1, 0) represents the positive sentiment and y i = (0, 1) represents the negative sentiment. In the target language Chinese, we have the test data T CN = {x i } T i=1 and unlabeled data U CN = {x i } M i=1 . The task is to use L EN and U CN to learn a model and classify the sentiment polarity for the review texts in T CN . In our method, the labeled, unlabeled and test data are all translated into the other language using an online machine translation tool. In the subsequent part of the paper, we refer to a document and its corresponding translation in the other language as a pair of parallel documents. 

 RNN and LSTM Recurrent neural network (RNN)  (Rumelhart et al., 1988 ) is a special kind of feed-forward neural network which is useful for modeling time-sensitive sequences. At each time t, the model receives input from the current example and also from the hidden layer of the network's previous state. The output is calculated given the hidden state at that time stamp. The recurrent connection makes the output at each time associated with all the previous inputs. The vanilla RNN model has been considered to be difficult to train due to the well-known problem of vanishing and exploding gradients. The LSTM (Hochreiter and Schmidhuber, 1997) addresses the problem by re-parameterizing the RNN model. The core idea of LSTM is introducing the "gates" to control the data flow in the recurrent neural unit. The LSTM structure ensures that the gradient of the long-term dependencies cannot vanish. The detailed architecture that we use in shown in Figure  1 .   

 Architecture The general architecture of our approach is shown in Figure  2 . For a pair of parallel documents x cn and x en , each of them is sent into the attention based LSTM network. The English-side and Chineseside architectures are the same but have different parameters. We only show the Chinese-side network in the figure due to space limit. The whole model is divided into four layers. In the input layer, the documents are represented as a word sequence where each position corresponds to a word vector from pre-trained word embeddings. In the LSTM layer, we get the high-level representation from a bidirectional LSTM network. We use the hidden units from both the forward and backward LSTMs. In the document representation layer, we incorporate the attention model into the network and derive the final document representation. At the output layer, we concatenate the representations of the English and Chinese documents and use the softmax function to predict the sentiment label. Input Layer: The input layer of the network is the word sequences in a document x which can be either Chinese or English. The document x contains several sentences {s i } |x| i=1 and each sentence is composed of several words s i = {w i,j } |s i | j=1 . We represent each word in the document as a fixed-size vector from pre-trained word embeddings. LSTM Layer: In each individual language, we use bi-directional LSTMs to model the input sequences. In the bidirectional architecture, there are two layers of hidden nodes from two separate LSTMs. The two LSTMs capture the dependencies in different directions. The first hidden layers have recurrent connections from the past words while second one's direction of recurrent of connections is flipped, passing activation backwards in the texts. Therefore, in the LSTM layer, we can get the forward hidden state h i,j from the forward LSTM network and the backward hidden state h i,j from the backward LSTM network. We represent the final state at position (i, j), i.e. the j-th word in the i-th sentence of the document, with the concatenation of h i,j and h i,j . h i,j = h i,j h i,j It captures the compositional semantics in both directions of the word sequences. Document Representation Layer:As described above, different parts of the document usually have different importance for the overall sentiment. Some sentences or words can be decisive while the others are irrelevant. In this study, we use a hierarchical attention mechanism which assigns a real value score for each word and a real value score for each sentence. The detailed strategy of our attention model will be described in the next subsection. Suppose we have the sentence attention score A i for each sentence s i ? x, and the word attention score a i,j for each word w i,j ? s i , both of the scores are normalized which satisfy the following equations, i A i = 1 and j a i,j = 1 The sentence attention measures which sentence is more important for the overall sentiment while the word attention captures sentiment signals such as sentiment words in each sentence. Therefore, the document representation r for document x is calculated as follows, r = i [A i ? j (a i,j ? h i,j )] Note that many LSTM based models represent the word sequences only using the hidden layer at the final node. In this study, the hidden states at all the positions are considered with different attention weights. We believe that, for document sentiment classification, focusing on some certain parts of the document will be effective to filter out the sentimentirrelevant noise. Output Layer: At the output layer, we need to predict the overall sentiment of the document. For each English document x en and its corresponding translation x cn , suppose the document representations of them are obtained in previous steps as r en and r cn , we simply concatenate them as the feature vector and use the softmax function to predict the final sentiment. ? = sof tmax(r cn r en ) 

 Hierarchical Attention Mechanism For document-level sentiment classification task, we have shown that capturing both the sentence and word level attention is important. The general idea is inspired by previous works such as  Bahdanau et al. (2014) and Hermann et al. (2015)  which have successfully applied the attention model to machine translation and question answering. Bahdanau et al. (  2014 ) incorporated the attention model into the sequence to sequence learning framework. During the decoding phase of the machine translation task, the attention model helps to find which input word should be "aligned" to the current output. In our case, the output of the model is not a sequence but only one sentiment vector. We hope to find the important units in the input sequence which are influential for the output. We propose to learn a hierarchical attention model jointly with the bilingual LSTM network. The first level is the sentence attention model which measures which sentences are more important for the overall sentiment of a document. For each sentence s i = {w i,j } |s i | j=1 in the document, we represent the sentence via the final hidden state of the forward LSTM and the backward LSTM, i.e. s i = h i,|s i | h i,1 We use a two-layer feed-forward neural network to predict the attention score of s i ?i = f (s i ; ? s ) A i = exp( ?i ) j exp( ?j ) where f denotes the two-layer feed-forward neural network and ? s denotes the parameters in it. At the word level, we represent each word w i,j using its word embedding and the hidden state of the bidirectional LSTM layer, i.e. h i,j . Similarly, we use a two-layer feed forward neural network to predict the attention score of w i,j , e i,j = w i,j h i,j h i,j ?i,j = f (e i,j ; ? w ) a i,j = exp(? i,j ) 

 Training of the Proposed Model The proposed model is trained in a semi-supervised manner. In the supervised part, we use the cross entropy loss to minimize the sentiment prediction error between the output results and the gold standard labels, L 1 = (xen,xcn) i ?y i log(? i ) where x en and x cn are a pair of parallel documents in the training data, y is the gold-standard sentiment vector and ? is the predicted vector from our model. The unsupervised part tries to minimize the document representations between the parallel data. Following previous research, we simply measure the distance of two parallel documents via the Euclidean Distance, L 2 = (xen,xcn) r en ? r cn 2 where x en and x cn are a pair of parallel documents from both the labeled and unlabeled data. The final objective function is a weighted sum of L 1 and L 2 , L = L 1 + ? ? L 2 where ? is the hyper-parameter controlling the weight. We use Adadelta  (Zeiler, 2012)  to update the parameters during training. It can dynamically adapt over time using only first order information and has minimal computational overhead beyond vanilla stochastic gradient descent. In the test phase, the test document in T CN is sent into our model along with the corresponding machine translated text in T EN . The final sentiment is predicted via a softmax function over the concatenated representation of the bilingual texts as described above. 

 Experiment 

 Dataset We use the dataset from the cross-language sentiment classification evaluation of NLP&CC 2013. The dataset contains reviews in three domains including book, DVD and music. In each domain, it has 2000 positive reviews and 2000 negative reviews in English for training and 4000 Chinese reviews for test. It also contains 44113, 17815 and 29678 unlabeled reviews for book, DVD and music respectively. 

 Implementation Detail We use Google Translate 2 to translate the labeled data to Chinese and translate the unlabeled data and test data to English. All the texts are tokenized and converted into lower case. In the proposed framework, the dimensions of the word vectors and the hidden layers of LSTMs are set as 50. The initial word embeddings are trained on both the unlabeled and labeled reviews using word2vec in each individual language. The word vectors are fine-tuned during the training procedure. The hyper-parameter a is set to 0.2. The dropout rate is set to 0.5 to prevent overfitting. Ten percent of the training data are randomly selected as validation set. The training procedure is stopped when the prediction accuracy does not improve for 10 iterations. We implement the framework based on theano  (Bastien et al., 2012)  and use a GTX 980TI graphic card for training. 

 Baselines and Results To evaluate the performance of our model, we compared it with the following baseline methods: LR A-Eval: This is the average performance of all the teams in the NLP&CC 2013 cross-lingual sentiment classification evaluation. The attention-based models EN-Attention, CN-Attention and BI-Attention: Bi-Attention is the model described in the above sections which concatenate the document representations of the English side and the Chinese side texts.  EN  Table  2  shows the cross-lingual sentiment classification accuracy of all the approaches. The first kind baseline algorithms are based on traditional bag-of-word features. SVM performs better than LR on book and DVD but gets much worse result on music. The second kind baseline algorithms are based on deep learning methods which learn the vector representations for words or documents. MT-PV achieves similar results with LR. Bi-PV improves the accuracy by about 0.03 using both the bilingual documents. While MT-PV and Bi-PV directly learn document representations, BSWE learns the embedding for the words in a bilingual sentiment lexicon. It gets higher accuracy than both Bi-PV and MT-PV which shows that the sentiment words are very important for this task. Our attention based models achieve the highest prediction accuracy among all the approaches. The results show that CN-Attention always outperforms EN-Attention. The combination of the English-side and Chinese-side model brings improvement to both the book and music domains and yields the highest average prediction accuracy. The attention-based models outperform the algorithms using traditional features as well as the existing deep learning based methods. Compared to the highest performance in the NLP&CC evaluation, we improve the average accuracy by about 0.05. 

 Influence of the Attention Mechanism In this study, we propose a hierarchical attention mechanism to capture the sentiment-related information of each document. In table 3, we show the results of models with different attention mechanisms. All the models are based on the bilingual bi-directional LSTM network as shown in Figure  2 . LSTM is the basic bilingual bi-directional LSTM network. LSTM+SA considers only sentence-level attention while LSTM+WA considers only wordlevel attention. LSTM+HA combines both wordlevel and sentence-level attentions. From the results, we can observe that LSTM+HA outperforms the other three methods, which proves the effectiveness of the hierarchical attention mechanism. Besides, the word-level attention shows better performance than the sentence-level attention. 

 Method Average Accuracy LSTM 0.811 LSTM+SA 0.814 LSTM+WA 0.821 LSTM+HA 0.824 We also conduct a case study using the examples in Table  1 . We show the visualized word attention using a heat map in Figure  3  by drawing the attention of each word in it. The darker color reveals higher attention scores while the lighter part has little importance. We can observe that our model successfully identifies the important units of the sentence. The sentiment word "easy" gets much higher attention score than the other words. The word "nice" gets the third highest score in the sentence right after the two "easy". Note that our attention mechanism considers both the word embedding vector and the hidden state vectors. Therefore, the same word "easy" gets different scores in different positions.  Table  4  shows the performance of our model in these settings. Rand gets the lowest accuracy among them. The fine-tuned word embeddings perform better than static which fits the results in previous study  (Kim, 2012) . Multi-channel gets similar results with fine-tuned on DVD and music but is a bit lower on book. We also find that using pre-trained word embeddings helps the model to converge much faster than random initialization. 

 Influence of Vector Sizes In our experiment, we set the size of the hidden layers in both the forward and backward LSTMs the same as the size of the input word vectors. Therefore, the dimension of the document representation is twice of the word vector size. In Figure  4 , we show the performance of our model with different input vector sizes. We use the vector size in the following set {10, 25, 50, 100, 150, 200}. Note that the dimensions of all the units in the model also change with that. We can observe from Figure  4  that the prediction accuracy for the book domain keeps steady when the vector size changes. For DVD and music, the performance increases at the beginning and becomes stable after the vector size grows larger than 50. It shows that our model is robust to a wide range of vector sizes.  

 Conclusion In this paper, we propose an attention based LSTM network for cross-language sentiment classification. We use the bilingual bi-directional LSTMs to model the word sequences in the source and target languages. Based on the special characteristics of the sentiment classification task, we propose a hierarchical attention model which is jointly trained with the LSTM network. The sentence level attention enables us to find the key sentences in a document and the word level attention helps to capture the sentiment signals. The proposed model achieves promising results on a benchmark dataset using Chinese as the source language and English as the target language. It outperforms the best results in the NLPC&CC cross-language sentiment classification evaluation as well as several strong baselines. In future work, we will evaluate the performance of our model on more datasets and more language pairs. The sentiment lexicon is also another kind of useful resource for classification. We will explore how to make full usages of these resources in the proposed framework. learned different representations for words in different languages. Part of the word vector is shared among different languages and the rest is language-dependent. Klementiev et al. (2012) treated the task as a multi-task learning problem where each task corresponds to a single word, and the task relatedness is derived from cooccurrence statistics in bilingual parallel corpora. Chandar A P et al. (2014) and Zhou et al. (2015) used the autoencoders to model the connections between bilingual sentences. It aims to minimize the reconstruction error between the bag-of-words representations of two parallel sentences. Pham et al. (2015) extended the paragraph model into bilingual setting. Each pair of parallel sentences shares the same paragraph vector. 
