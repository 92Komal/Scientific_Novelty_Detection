title
Knowledge-enriched Two -layered Attention Network for Sentiment Analysis
abstract
We propose a novel two -layered attention network based on Bidirectional Long Short - Term Memory for sentiment analysis .
The novel two -layered attention network takes advantage of the external knowledge bases to improve the sentiment prediction .
It uses the Knowledge Graph Embedding generated using the Word- Net .
We build our model by combining the two -layered attention network with the supervised model based on Support Vector Regression using a Multilayer Perceptron network for sentiment analysis .
We evaluate our model on the benchmark dataset of SemEval 2017 Task 5 .
Experimental results show that the proposed model surpasses the top system of SemEval 2017 Task 5 .
The model performs significantly better by improving the state - of- the - art system at SemEval 2017
Task 5 by 1.7 and 3.7 points for sub-tracks 1 and 2 respectively .
Introduction
With the rise of microblogging websites , people have access and option to reach to the large crowd using as few words as possible .
Microblog and news headlines are one of the common ways to dispense information online .
The dynamic nature of these texts can be effectively used in the financial domain to track and predict the stock prices ( Goonatilake and Herath , 2007 ) .
These can be used by an individual or an organization to make an informed prediction related to any company or stock ( Si et al. , 2013 ) .
This gives rise to an interesting problem of sentiment analysis in financial domain .
A study indicates that sentiment analysis of public mood derived from Twitter feeds can be used to eventually forecast movements of individual stock prices ( Smailovi ?
et al. , 2014 ) .
An efficient system for sentiment analysis is a core component of a company involved in financial stock market price prediction .
Social media texts are prone to word shortening , exaggeration , lack of grammar and appropriate punctuations .
Moreover , the word limit constraint forces a user to limit their content and squeeze in their opinion about companies .
These inconsistencies make it challenging to solve any natural language processing tasks including sentiment analysis ( Khanarian and Alwarez - Melis , 2012 ) .
Bag-of-words and named entities were used by Schumaker and Chen ( 2009 ) for predicting stock market .
For predicting the explicit and implicit sentiment in the financial text , de Kauter et al . ( 2015 ) used a fine- grained sentiment annotation scheme .
used a classical supervised approach based on Support Vector Regression for sentiment analysis in financial domain .
Oliveira et al. ( 2013 ) relied on multiple regression models .
used an ensemble of four different systems for predicting the sentiment .
It used a combination of Long Short - Term Memory ( LSTM ) ( Hochreiter and Schmidhuber , 1997 ) , Gated Recurrent Unit ( GRU ) ( Cho et al. , 2014 ) , Convolutional Neural Network ( CNN ) ( Kim , 2014 ) and Support Vector Regression ( SVR ) ( Smola and Sch?lkopf , 2004 ) .
Yang et al. ( 2016 ) used a hierarchical attention network to build the document representation incrementally for document classification .
Our model focuses on interpretability and usage of knowledge bases .
Knowledge bases have been recognized important for natural language understanding tasks ( Minsky , 1986 ) .
Our main contribution is a two -layered attention network which utilizes background knowledge bases to build good word level representation at the primary level .
The secondary attention mechanism works on top of the primary layer to build meaningful sentence representations .
This provides a good intuitive working insight of the attention network .
Proposed Methodology
We propose a two -layered attention network which leverages external knowledge for sentiment analysis .
It consists of a bidirectional Long Short - Term Memory ( BiLSTM ) ( Graves et al. , 2005 ) based word encoder , word level attention mechanism for capturing the background knowledge and a sentence level attention mechanism aimed at grasping the context and the important words .
The output of the two -layered attention network is then ensembled with the output of the feature based SVR using the Multilayer perceptron based approach described in .
The overall ensembled system is shown in Figure 2 . Each of the components is explained in the following subsections and an overview of the twolayered attention network is depicted in Figure 1 .
The two hidden states ? ? h t and ? ? h t for forward and backward LSTM are the information about past and future respectively at any time step t.
Their concatenation h t = [ ? ? h t , ? ? h t ] provides complete information .
Each word of the sentence is fed to the network in form of word embeddings which are encoded using the BiLSTM .
Word Level Attention External knowledge in form of Knowledge Graph Embedding ( Yang et al. , 2015 ) or top-k similar words are captured by using the word level attention mechanism .
This serves the purpose of primary attention which leverages the external knowledge to get the best representation for each word .
At each time step we get V( x t ) relevant terms of each input x t with v i being the embedding for each term .
( Relevant terms and embeddings are described in next section ) .
The primary attention mechanism assigns an attention coefficient to each of relevant term having index i ?
V( x t ) : ? ti ? h T t W v v i ( 1 ) where W v is a parameter matrix to be learned .
m t = i?V ( xt ) ? ti v i ( 2 ) h t = m t + h t ( 3 )
The knowledge aware vector ( m t ) is calculated as Equation 2 , which is concatenated with the hidden state vector to get the final vector representation for each word .
Sentence Level Attention
The secondary attention mechanism captures important words in a sentence with the help of context vectors .
Each final vector representing the words is assigned a weight indicating its relative importance with respect to other words .
The attention coefficient ?
t for each final vector representation is calculated as : ? t ? h T t W s u s ( 4 ) H = t ? t h t ( 5 ) where W s is a parameter matrix and u s is the context vector to be learned .
H is finally fed to a one layer feed forward neural network .
Relevant Terms and Embeddings External knowledge can provide explicit information for the model which the training data lacks .
This helps the model to make better predictions .
We relied on Knowledge Graph Embeddings based on WordNet and Distributional Thesaurus to get relevant terms and their corresponding embeddings for each word in the text .
Knowledge Graph Embedding WordNet 1 is a lexical database which contains triplets in the form of ( subject , relation , object ) .
Both subject and object are synsets in WordNet .
Each word in the text serves as the subject of the triplet .
The relevant terms for the current word are the triplets having the current word as the subject .
We then employ Knowledge Graph Embeddings to learn the representation of the triplet .
A 100 - dimensional dense vector representation for each subject , relation and object were learned using the DistMult approach ( Yang et al. , 2015 ) and concatenated .
These served as the relevant embeddings .
An example of triplet in WordNet is ( bronze age , part of , prehistory ) .
Distributional Thesaurus Distributional Thesaurus ( DT ) ( Biemann and Riedl , 2013 ) is an automatically computed word list which ranks words according to their semantic similarity .
We use a pre-trained DT to expand a current word .
For each current word , top - 4 target words are found which are the relevant terms .
The relevant embeddings are obtained by using a 300 - dimensional pre-trained Word2Vec ( Mikolov et al. , 2013 ) and GloVe ( Pennington et al. , 2014 ) model .
An example of the DT expansion of the word ' touchpad ' is mouse , trackball , joystick and trackpad .
Feature Based Model - SVR
The following hand -crafted features are extracted and used to train a Support Vector Regression ( SVR ) .
- Tf - Idf : Term frequency - inverse document frequency ( Tf - Idf ) reflects the importance of each word in a document .
We use Tf - Idf score as a feature value for each word .
- Lexicon Features : Sentiment lexicons are an important resource for sentiment analysis .
We employ the following lexicons : Bing Liu opinion lexicon ( Ding et al. , 2008 ) and MPQA subjectivity lexicon ( Wilson et al. , 2005 ) , SentiWordNet ( Baccianella et al. , 2010 ) and Vader sentiment ( Gilbert , 2014 ) .
From the above lexicons we extracted the agreement score ( Rao and Srivastava , 2012 ) and the count of the number of occurrences of all positive and negative words in the text .
- Word embedding :
We use the 300 - dimensional pre-trained Word2Vec and GloVe embedding .
The sentence embedding was obtained by concatenating the embedding for all words in the sentence .
Implementation Details
We implement our model using Tensorflow and Scikit-learn on a single GPU .
We use a single layer BiLSTM with the two -layered attention mechanism followed by a one layer feed forward neural network .
The number of units in each LSTM cell of the BiLSTM was 150 .
The batch size was 64 and the dropout was 0.3 ( Srivastava et al. , 2014 ) with the Adam ( Kingma and Ba , 2014 ) optimizer .
The length of context vector in the secondary attention network was 300 .
For each experiment , we report the average of five random runs .
Cosine similarity is a measure of similarity .
It represents the degree of agreement between the predicted and gold values .
Cosine similarity was used for evaluation as per the guideline .
Results
We compare our system with the state- of- the - art systems of SemEval 2017
Task 5 and the system proposed by .
Table 1 shows evaluation of our various models .
Team ECNU ( Lan et al. , 2017 ) and Fortia-FBK ( Mansar et al. , 2017 ) were the top systems for sub-tracks 1 and 2 respectively .
Team ECNU and Fortia- FBK reported a cosine similarity of 0.777 and 0.745 for sub-tracks 1 and 2 respectively .
Team ECNU employed a number of systems - Support Vector Regression , XGBoost Regressor , AdaBoost Regressor and Bagging Regressor ensembled together .
Team Fortia-FBK used a Convolutional Neural Network for this task .
The system proposed by Akhtar et al. utilizes an ensemble of LSTM , GRU , CNN and a SVR and reported a cosine similarity of 0.797 and 0.786 for the two sub-tracks .
Our proposed system has a cosine similarity of 0.794 and 0.782 for sub-tracks 1 and 2 respectively .
The proposed system performs significantly better than top systems of SemEval 2017
Task 5 for both the tasks .
Moreover , the system performs at par with the system proposed by Akhtar et al. with half the number of subsystems involved in the ensemble .
This shows that our proposed system is not only robust since it performs for both the task equally well but also powerful as it involves fewer subcomponents while having the same expressive power .
The two -layered attention network alone performs better than the best system of SemEval 2017
Task for both the sub-track .
It manages to achieve much higher score than any of the deep learning component utilized by the system proposed by as shown in Table 2 .
This shows that the two -layered attention network helps to reduce overall model complexity without compromising the performance .
Models
Error Analysis
We performed error analysis and observed that the proposed system faces difficulty at times .
Following are the situations when the system failed and incorrectly predicted values of the opposite polarity : ?
Sometimes the system fails to identify an intensifier .
In the example below , ' pure ' is used as an intensifier .
Text : Pure garbage stock Actual : - 0.946 Predicted : 0.042 ?
The system fails when it does not have enough real-world information .
In the example below , a low share price is a good opportunity to buy for an individual but from a company 's point of view , a low share price does not indicate a prosperous situation .
Text : Good opportunity to buy Actual : - 0.771 Predicted : 0.260
Conclusion
In this paper , we proposed an ensemble of a novel two -layered attention network and a classical supervised Support Vector Regression for sentiment analysis .
The two -layered attention network has an intuitive working .
It builds the representation hierarchically from word to sentence level utilizing the knowledge bases .
The proposed system performed remarkably well on the benchmark datasets of SemEval 2017 Task 5 .
It outperformed the existing top systems for both the sub-tracks comfortably .
Experimental results demonstrate that the system improves the state- of- the - art system of SemEval 2017
Task 5 by 1.7 and 3.7 points for sub-tracks 1 and 2 respectively .
This robust system can be effectively used as a submodule in an end-to - end stock market price prediction system .
256 Figure 1 : 1 Figure 1 : Two -layered attention network
