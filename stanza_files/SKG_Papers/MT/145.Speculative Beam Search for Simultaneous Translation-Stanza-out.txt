title
Speculative Beam Search for Simultaneous Translation
abstract
Beam search is universally used in fullsentence translation but its application to simultaneous translation remains non-trivial , where output words are committed on the fly .
In particular , the recently proposed wait -k policy ) is a simple and effective method that ( after an initial wait ) commits one output word on receiving each input word , making beam search seemingly impossible .
To address this challenge , we propose a speculative beam search algorithm that hallucinates several steps into the future in order to reach a more accurate decision , implicitly benefiting from a target language model .
This makes beam search applicable for the first time to the generation of a single word in each step .
Experiments over diverse language pairs show large improvements over previous work .
Introduction
Beam search has been widely used in neural text generation such as machine translation ( Sutskever et al. , 2014 ; Bahdanau et al. , 2014 ) , summarization ( Rush et al. , 2015 ; Ranzato et al. , 2016 ) , and image captioning ( Vinyals et al. , 2015 ; Xu et al. , 2015 ) .
It often leads to substantial improvement over greedy search and becomes an essential component in almost all text generation systems .
However , beam search is easy for the above tasks because they are all full-sequence problems , where the whole input sequence is available at the beginning and the output sequence only needs to be revealed in full at the end .
By contrast , in language and speech processing , there are many incremental processing tasks with simultaneity requirements , where the output needs to be revealed to the user incrementally without revision ( word by word , or in chunks ) and the input is also being *
These authors contributed equally .
received incrementally .
Two most salient examples are streaming speech recognition ( Chiu et al. , 2018 ) , widely used in speech input and dialog systems ( such as Siri ) , and simultaneous translation ( Bangalore et al. , 2012 ; Oda et al. , 2015 ; Grissom II et al. , 2014 ; Jaitly et al. , 2016 ) , widely used in international conferences and negotiations .
In these tasks , the use of full-sentence beam search becomes seemingly impossible as output words need to be committed on the fly .
How to adapt beam search for such incremental tasks in order to improve their generation quality ?
We propose a general technique of speculative beam search ( SBS ) , and apply it to simultaneous translation .
At a very high level , to generate a single word , instead of simply choosing the highest - scoring one ( as in greedy search ) , we further speculate w steps into the future , and use the ranking at step w + 1 to reach a more informed decision for step 1 ( the current step ) ; this method implicitly benefits from a target language model , alleviating the label bias problem in neural generation ( Murray and Chiang , 2018 ; .
We apply this algorithm to two representative approaches to simultaneous translation : the fixed policy method and the adaptive policy method ( Gu et al. , 2017 ) .
In both cases , we show that SBS improves translation quality while maintaining latency ( i.e. , simultaneity ) .
Preliminaries
We first review standard full-sentence NMT and beam search to set up the notations , and then review different approaches to simultaneous MT .
Full Sentence NMT and Beam Search
The encoder processes the input sequence x = ( x 1 , ... , x n ) , where x i ?
R d represents an input token as a d dimensional vector , and produces a new list of hidden states h = f ( x ) = ( h 1 , ... , h n ) 1396 Figure 1 : Wait - 1 policy example to illustrate the procedure of SBS .
The top Chinese words are the source side inputs which are incrementally revealed to the encoder .
Gloss is annotated above Chinese word and Pinyin is underneath .
There are two extra steps ( speculative window ) are taken ( red part ) beyond greedy .
When source reaches the last word " ? " ( debt ) , the decoder gets into tail and performs conventional beam search ( in green ) .
to represent x .
The encoding function f can be RNN , CNN or Transformer .
On the other hand , the ( greedy ) decoder selects the highest - scoring word y t given source representation h and previously generated target tokens , y <t = ( y 1 , ... , y t?1 ) .
The greedy search continues until it emits < eos > , and the final hypothesis y = ( y 1 , ... , y t ) with y t = < eos > p(y | x ) = |y | t=1 p(y t | x , y < t ) ( 1 )
As greedy search only explores one single path among exponential many alternatives , beam search is used to improve the search .
At each step t , it maintains a beam B t of size b , which is an ordered list of hypothesis , probability pairs ; for example B 0 = [ < s > , 1 ] .
We then define one-step transition from the previous beam to the next as 1 ( B t?1 ) .
As a shorthand , we also define the multi-step beam search function recursively : next b i ( B ) = next b 1 ( next b i ?1 ( B ) ) ( 2 ) Full-sentence beam search ( over a maximum of T steps ) yields the best hypothesis y * with score s * ( see Huang et al . ( 2017 ) for stopping criteria ) : y * , s * = top 1 ( next b T ( [ < s > , 1 ] ) ) ( 3 )
Simultaneous MT : Policies and Models
There are two main categories of policies in neural simultaneous translation decoding ( Tab. 1 ) : 1 . The first method is to use a fixed - latency policy , such as the wait -k policy .
Such a method would , after an initial wait of k source words , commit one target word on receiving each new source word .
When the source sentence ends , the decoder can do a tail beam search on the remaining target words , but beam search is seemingly impossible before the source sentence ends .
policy model sequence- to-sequence prefix-to- prefix ( full-sentence model ) ( simultaneous model ) fixedlatency test- time wait -k ( Dalvi et al. , 2018 ; wait -k adaptive RL MILk ( Gu et al. , 2017 ) ( Arivazhagan et al. , 2019 ) Supervised Learning Imitation Learning ) Table 1 : Recent advances in simultaneous translation .
2 . The second method learns an adaptive policy which uses either supervised or reinforcement learning ( Grissom II et al. , 2014 ; Gu et al. , 2017 ) to decide whether to READ ( the next source word ) or WRITE ( the next target word ) .
Here the decoder can commit a chunk of multiple words for a series of consecutive WRITEs .
In terms of modeling ( which is orthogonal to decoding policies ) , we can also divide most simultaneous translatoin efforts into two camps : 1 . Use the standard full-sentence translation model trained by classical seq-to-seq ( Dalvi et al. , 2018 ; Gu et al. , 2017 ; . For example , the " test- time waitk " scheme uses the full-sentence translation model and performs wait -k decoding at test time .
However , the obvious training -testing mismatch in this scheme usually leads to inferior quality .
2 . Use a genuinely simultaneous model trained by the recently proposed prefix-to- prefix framework Arivazhagan et al. , 2019 ; . There is no training -testing mismatch in this new scheme , with the cost of slower training .
Speculative Beam Search
We first present our speculative beam search on the fixed - latency wait -k policy ( generating a single word per step ) , and then adapt it to the adaptive policies ( generating multiple words per step ) .
y <t < l a t e x i t s h a 1 _ b a s e 6 4 = " X / h D 3 q R r q y B G H y C w D X V E 4 9 A d / 0 Y = " > A A A C A X i c b V D L S s N A F J 3 U V 6 2 v q k s 3 g 0 V w V R I R d O G i 6 M Z l B f u A N J T J d N I O n U e Y m Q g h Z O U 3 u N W 1 O 3 H r l 7 j 0 T 5 y 0 W d j W A x c O 5 9 z L v f e E M a P a u O 6 3 U 1 l b 3 9 j c q m 7 X d n b 3 9 g / q h 0 d d L R O F S Q d L J l U / R J o w K k j H U M N I P 1 Y E 8 Z C R X j i 9 K / z e E 1 G a S v F o 0 p g E H I 0 F j S h G x k r + I O R Z m g + z G 5 M P 6 w 2 3 6 c 4 A V 4 l X k g Y o 0 R 7 W f w Y j i R N O h M E M a e 1 7 b m y C D C l D M S N 5 b Z B o E i M 8 R W P i W y o Q J z r I Z i f n 8 M w q I x h J Z U s Y O F P / T m S I a 5 3 y 0 H Z y Z C Z 6 2 S v E / z w / M d F 1 k F E R J 4 Y I P F 8 U J Q w a C Y v / 4 Y g q g g 1 L L U F Y U X s r x B O k E D Y 2 p Y U t I S 8 y 8 Z Y T W C X d i 6 b n N r 2 H y 0 b r t k y n C k 7 A K T g H H r g C L X A P 2 q A D M J D g B b y C N + f Z e X c + n M 9 5 a 8 U p Z 4 7 B A p y v X 6 Q 5 m C E = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " X / h D 3 q R r q y B G H y C w D X V E 4 9 A d / 0 Y = " > A A A C A X i c b V D L S s N A F J 3 U V 6 2 v q k s 3 g 0 V w V R I R d O G i 6 M Z l B f u A N J T J d N I O n U e Y m Q g h Z O U 3 u N W 1 O 3 H r l 7 j 0 T 5 y 0 W d j W A x c O 5 9 z L v f e E M a P a u O 6 3 U 1 l b 3 9 j c q m 7 X d n b 3 9 g / q h 0 d d L R O F S Q d L J l U / R J o w K k j H U M N I P 1 Y E 8 Z C R X j i 9 K / z e E 1 G a S v F o 0 p g E H I 0 F j S h G x k r + I O R Z m g + z G 5 M P 6 w 2 3 6 c 4 A V 4 l X k g Y o 0 R 7 W f w Y j i R N O h M E M a e 1 7 b m y C D C l D M S N 5 b Z B o E i M 8 R W P i W y o Q J z r I Z i f n 8 M w q I x h J Z U s Y O F P / T m S I a 5 3 y 0 H Z y Z C Z 6 2 S v E / z w / M d F 1 k F E R J 4 Y I P F 8 U J Q w a C Y v / 4 Y g q g g 1 L L U F Y U X s r x B O k E D Y 2 p Y U t I S 8 y 8 Z Y T W C X d i 6 b n N r 2 H y 0 b r t k y n C k 7 A K T g H H r g C L X A P 2 q A D M J D g B b y C N + f Z e X c + n M 9 5 a 8 U p Z 4 7 B A p y v X 6 Q 5 m C E = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " X / h D 3 q R r q y B G H y C w D X V E 4 9 A d / 0 Y = " > A A A C A X i c b V D L S s N A F J 3 U V 6 2 v q k s 3 g 0 V w V R I R d O G i 6 M Z l B f u A N J T J d N I O n U e Y m Q g h Z O U 3 u N W 1 O 3 H r l 7 j 0 T 5 y 0 W d j W A x c O 5 9 z L v f e E M a P a u O 6 3 U 1 l b 3 9 j c q m 7 X d n b 3 9 g / q h 0 d d L R O F S Q d L J l U / R J o w K k j H U M N I P 1 Y E 8 Z C R X j i 9 K / z e E 1 G a S v F o 0 p g E H I 0 F j S h G x k r + I O R Z m g + z G 5 M P 6 w 2 3 6 c 4 A V 4 l X k g Y o 0 R 7 W f w Y j i R N O h M E M a e 1 7 b m y C D C l D M S N 5 b Z B o E i M 8 R W P i W y o Q J z r I Z i f n 8 M w q I x h J Z U s Y O F P / T m S I a 5 3 y 0 H Z y Z C Z 6 2 S v E / z w / M d F 1 k F E R J 4 Y I P F 8 U J Q w a C Y v / 4 Y g q g g 1 L L U F Y U X s r x B O k E D Y 2 p Y U t I S 8 y 8 Z Y T W C X d i 6 b n N r 2 H y 0 b r t k y n C k 7 A K T g H H r g C L X A P 2 q A D M J D g B b y C N + f Z e X c + n M 9 5 a 8 U p Z 4 7 B A p y v X 6 Q 5 m C E = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " X / h D 3 q R r q y B G H y C w D X V E 4 9 A d / 0 Y = " > A A A C A X i c b V D L S s N A F J 3 U V 6 2 v q k s 3 g 0 V w V R I R d O G i 6 M Z l B f u A N J T J d N I O n U e Y m Q g h Z O U 3 u N W 1 O 3 H r l 7 j 0 T 5 y 0 W d j W A x c O 5 9 z L v f e E M a P a u O 6 3 U 1 l b 3 9 j c q m 7 X d n b 3 9 g / q h 0 d d L R O F S Q d L J l U / R J o w K k j H U M N I P 1 Y E 8 Z C R X j i 9 K / z e E 1 G a S v F o 0 p g E H I 0 F j S h G x k r + I O R Z m g + z G 5 M P 6 w 2 3 6 c 4 A V 4 l X k g Y o 0 R 7 W f w Y j i R N O h M E M a e 1 7 b m y C D C l D M S N 5 b Z B o E i M 8 R W P i W y o Q J z r I Z i f n 8 M w q I x h J Z U s Y O F P / T m S I a 5 3 y 0 H Z y Z C Z 6 2 S v E / z w / M d F 1 k F E R J 4 Y I P F 8 U J Q w a C Y v / 4 Y g q g g 1 L L U F Y U X s r x B O k E D Y 2 p Y U t I S 8 y 8 Z Y T W C X d i 6 b n N r 2 H y 0 b r t k y n C k 7 A K T g H H r g C L X A P 2 q A D M J D g B b y C N + f Z e X c + n M 9 5 a 8 U p Z 4 7 B A p y v X 6 Q 5 m C E = < / l a t e x i t > y <t < l a t e x i t s h a 1 _ b a s e 6 4 = " X / h D 3 q R r q y B G H y C w D X V E 4 9 A d / 0 Y = " > A A A C A X i c b V D L S s N A F J 3 U V 6 2 v q k s 3 g 0 V w V R I R d O G i 6 M Z l B f u A N J T J d N I O n U e Y m Q g h Z O U 3 u N W 1 O 3 H r l 7 j 0 T 5 y 0 W d j W A x c O 5 9 z L v f e E M a P a u O 6 3 U 1 l b 3 9 j c q m 7 X d n b 3 9 g / q h 0 d d L R O F S Q d L J l U / R J o w K k j H U M N I P 1 Y E 8 Z C R X j i 9 K / z e E 1 G a S v F o 0 p g E H I 0 F j S h G x k r + I O R Z m g + z G 5 M P 6 w 2 3 6 c 4 A V 4 l X k g Y o 0 R 7 W f w Y j i R N O h M E M a e 1 7 b m y C D C l D M S N 5 b Z B o E i M 8 R W P i W y o Q J z r I Z i f n 8 M w q I x h J Z U s Y O F P / T m S I a 5 3 y 0 H Z y Z C Z 6 2 S v E / z w / M d F 1 k F E R J 4 Y I P F 8 U J Q w a C Y v / 4 Y g q g g 1 L L U F Y U X s r x B O k E D Y 2 p Y U t I S 8 y 8 Z Y T W C X d i 6 b n N r 2 H y 0 b r t k y n C k 7 A K T g H H r g C L X A P 2 q A D M J D g B b y C N + f Z e X c + n M 9 5 a 8 U p Z 4 7 B A p y v X 6 Q 5 m C E = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " X / h D 3 q R r q y B G H y C w D X V E 4 9 A d / 0 Y = " > A A A C A X i c b V D L S s N A F J 3 U V 6 2 v q k s 3 g 0 V w V R I R d O G i 6 M Z l B f u A N J T J d N I O n U e Y m Q g h Z O U 3 u N W 1 O 3 H r l 7 j 0 T 5 y 0 W d j W A x c O 5 9 z L v f e E M a P a u O 6 3 U 1 l b 3 9 j c q m 7 X d n b 3 9 g / q h 0 d d L R O F S Q d L J l U / R J o w K k j H U M N I P 1 Y E 8 Z C R X j i 9 K / z e E 1 G a S v F o 0 p g E H I 0 F j S h G x k r + I O R Z m g + z G 5 M P 6 w 2 3 6 c 4 A V 4 l X k g Y o 0 R 7 W f w Y j i R N O h M E M a e 1 7 b m y C D C l D M S N 5 b Z B o E i M 8 R W P i W y o Q J z r I Z i f n 8 M w q I x h J Z U s Y O F P / T m S I a 5 3 y 0 H Z y Z C Z 6 2 S v E / z w / M d F 1 k F E R J 4 Y I P F 8 U J Q w a C Y v / 4 Y g q g g 1 L L U F Y U X s r x B O k E D Y 2 p Y U t I S 8 y 8 Z Y T W C X d i 6 b n N r 2 H y 0 b r t k y n C k 7 A K T g H H r g C L X A P 2 q A D M J D g B b y C N + f Z e X c + n M 9 5 a 8 U p Z 4 7 B A p y v X 6 Q 5 m C E = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " X / h D 3 q R r q y B G H y C w D X V E 4 9 A d / 0 Y = " > A A A C A X i c b V D L S s N A F J 3 U V 6 2 v q k s 3 g 0 V w V R I R d O G i 6 M Z l B f u A N J T J d N I O n U e Y m Q g h Z O U 3 u N W 1 O 3 H r l 7 j 0 T 5 y 0 W d j W A x c O 5 9 z L v f e E M a P a u O 6 3 U 1 l b 3 9 j c q m 7 X d n b 3 9 g / q h 0 d d L R O F S Q d L J l U / R J o w K k j H U M N I P 1 Y E 8 Z C R X j i 9 K / z e E 1 G a S v F o 0 p g E H I 0 F j S h G x k r + I O R Z m g + z G 5 M P 6 w 2 3 6 c 4 A V 4 l X k g Y o 0 R 7 W f w Y j i R N O h M E M a e 1 7 b m y C D C l D M S N 5 b Z B o E i M 8 R W P i W y o Q J z r I Z i f n 8 M w q I x h J Z U s Y O F P / T m S I a 5 3 y 0 H Z y Z C Z 6 2 S v E / z w / M d F 1 k F E R J 4 Y I P F 8 U J Q w a C Y v / 4 Y g q g g 1 L L U F Y U X s r x B O k E D Y 2 p Y U t I S 8 y 8 Z Y T W C X d i 6 b n N r 2 H y 0 b r t k y n C k 7 A K T g H H r g C L X A P 2 q A D M J D g B b y C N + f Z e X c + n M 9 5 a 8 U p Z 4 7 B A p y v X 6 Q 5 m C E = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = "
X / h D 3 q R r q y B G H y C w D q i m i t t p t r k l x 2 + d M s e L 2 L i n A W / U f z s y q q x d q 8 h V K g o r + 7 9 X i P d 5 k x Q W n W k m d J I C 1 2 w 7 a J F K D D E u g s F z Y T g D u X a E M i P c r p i t q K E M X H x 7 U y J V Z P L 3 c P w w G T b 8 g P j B e a v W + 7 R L p 4 T e o C o 6 R Q F q o x 7 6 j P p o g B j 6 i r 6 j H + i n 9 8 3 7 5 f 3 2 r r e l B 9 6 u 5 z X a g 3 d z B 4 V Z o G 4 = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " s 2 S 1 x F t p l M g M m o + q i m i t t p t r k l x 2 + d M s e L 2 L i n A W / U f z s y q q x d q 8 h V K g o r + 7 9 X i P d 5 k x Q W n W k m d J I C 1 2 w 7 a J F K D D E u g s F z Y T g D u X a E M i P c r p i t q K E M X H x 7 U y J V Z P L 3 c P w w G T b 8 g P j B e a v W + 7 R L p 4 T e o C o 6 R Q F q o x 7 6 j P p o g B j 6 i r 6 j H + i n 9 8 3 7 5 f 3 2 r r e l B 9 6 u 5 z X a g 3 d z B 4 V Z o G 4 = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " s 2 S 1 x F t p l M g M m o + q i m i t t p t r k l x 2 + d M s e L 2 L i n A W / U f z s y q q x d q 8 h V K g o r + 7 9 X i P d 5 k x Q W n W k m d J I C 1 2 w 7 a J F K D D E u g s F z Y T g D u X a E M i P c r p i t q K E M X H x 7 U y J V Z P L 3 c P w w G T b 8 g P j B e a v W + 7 R L p 4 T e o C o 6 R Q F q o x 7 6 j P p o g B j 6 i r 6 j H + i n 9 8 3 7 5 f 3 2 r r e l B 9 6 u 5 z X a g 3 d z B 4 V Z o G 4 = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " s 2 S 1 x F t p l M g M m o + X V E 4 9 A d / 0 Y = " > A A A C A X i c b V D L S s N A F J 3 U V 6 2 v q k s 3 g 0 V w V R I R d O G i 6 M Z l B f u A N J T J d N I O n U e Y m Q g h Z O U 3 u N W 1 O 3 H r l 7 j 0 T 5 y 0 W d j W A x c O 5 9 z L v f e E M a P a u O 6 3 U 1 l b 3 9 j c q m 7 X d n b 3 9 g / q h 0 d d L R O F S Q d L J l U / R J o w K k j H U M N I P 1 Y E 8 Z C R X j i 9 K / z e E 1 G a S v F o 0 p g E H I 0 F j S h G x k r + I O R Z m g + z G 5 M P 6 w 2 3 6 c 4 A V 4 l X k g Y o 0 R 7 W f w Y j i R N O h M E M a ?>
t + n < l a t e x i t s h a 1 _ b a s e 6 4 = "
V v j g R l i A Z G l D z 4 K R 3 R R 9 n P 5 J I 8 8 = " > A A A C C 3 i c d V B N S w M x E M 3 W r / p d 7 d F L s A i C s G T b Y t u L F L 1 4 V L A q t K V k 0 9 S G J t k l m R W W Z X + C v 8 G r n r 2 J V 3 + E R / + J u 7 W C i j 4 Y e L w 3 w 8 w 8 P 5 T C A i F v T m F u f m F x q b i 8 s r q 2 v r F Z 2 t q + t E F k G O + w Q A b m 2 q e W S 6 F 5 B w R I f h 0 a T p U v + Z U / O c n 9 q 1 t u r A j 0 B c Q h 7 y t 6 o 8 V I M A q Z N C i V e 7 5 K e m M K S Z y m g + Q I D n Q 6 K F W I 2 6 g 2 6 6 0 a J i 4 5 b N X r J C e 1 R r X R x J 5 L p q i g G c 4 G p f f e M G C R 4 h q Y p N Z 2 P R J C P 6 E G B J M 8 X e l F l o e U T e g N 7 2 Z U U 8 V t P 5 k e n + K 9 T B n i U W C y 0 o C n 6 v e J h C p r Y + V n n Y r C 2 P 7 2 c v E v r x v B q N l P h A 4 j 4 J p 9 L h p F E k O A 8 y T w U B j O Q M Y Z o c y I 7 F b M x t R Q B l l e P 7 b 4 K s / k 6 3 H 8 P 7 m s u h 5 x v f N 6 p X 0 8 S 6 e I d t A u 2 k c e a q A 2 O k V n q I M Y i t E 9 e k C P z p 3 z 5 D w 7 L 5 + t B W c 2 U 0 Y / 4 L x + A P J 9 n C E = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = "
V v j g R l i A Z G l D z 4 K R 3 R R 9 n P 5 J I 8 8 = " > A A A C C 3 i c d V B N S w M x E M 3 W r / p d 7 d F L s A i C s G T b Y t u L F L 1 4 V L A q t K V k 0 9 S G J t k l m R W W Z X + C v 8 G r n r 2 J V 3 + E R / + J u 7 W C i j 4 Y e L w 3 w 8 w 8 P 5 T C A i F v T m F u f m F x q b i 8 s r q 2 v r F Z 2 t q + t E F k G O + w Q A b m 2 q e W S 6 F 5 B w R I f h 0 a T p U v + Z U / O c n 9 q 1 t u r A j 0 B c Q h 7 y t 6 o 8 V I M A q Z N C i V e 7 5 K e m M K S Z y m g + Q I D n Q 6 K F W I 2 6 g 2 6 6 0 a J i 4 5 b N X r J C e 1 R r X R x J 5 L p q i g G c 4 G p f f e M G C R 4 h q Y p N Z 2 P R J C P 6 E G B J M 8 X e l F l o e U T e g N 7 2 Z U U 8 V t P 5 k e n + K 9 T B n i U W C y 0 o C n 6 v e J h C p r Y + V n n Y r C 2 P 7 2 c v E v r x v B q N l P h A 4 j 4 J p 9 L h p F E k O A 8 y T w U B j O Q M Y Z o c y I 7 F b M x t R Q B l l e P 7 b 4 K s / k 6 3 H 8 P 7 m s u h 5 x v f N 6 p X 0 8 S 6 e I d t A u 2 k c e a q A 2 O k V n q I M Y i t E 9 e k C P z p 3 z 5 D w 7 L 5 + t B W c 2 U 0 Y / 4 L x + A P J 9 n C E = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = "
V v j g R l i A Z G l D z 4 K R 3 R R 9 n P 5 J I 8 8 = " > A A A C C 3 i c d V B N S w M x E M 3 W r / p d 7 d F L s A i C s G T b Y t u L F L 1 4 V L A q t K V k 0 9 S G J t k l m R W W Z X + C v 8 G r n r 2 J V 3 + E R / + J u 7 W C i j 4 Y e L w 3 w 8 w 8 P 5 T C A i F v T m F u f m F x q b i 8 s r q 2 v r F Z 2 t q + t E F k G O + w Q A b m 2 q e W S 6 F 5 B w R I f h 0 a T p U v + Z U / O c n 9 q 1 t u r A j 0 B c Q h 7 y t 6 o 8 V I M A q Z N C i V e 7 5 K e m M K S Z y m g + Q I D n Q 6 K F W I 2 6 g 2 6 6 0 a J i 4 5 b N X r J C e 1 R r X R x J 5 L p q i g G c 4 G p f f e M G C R 4 h q Y p N Z 2 P R J C P 6 E G B J M 8 X e l F l o e U T e g N 7 2 Z U U 8 V t P 5 k e n + K 9 T B n i U W C y 0 o C n 6 v e J h C p r Y + V n n Y r C 2 P 7 2 c v E v r x v B q N l P h A 4 j 4 J p 9 L h p F E k O A 8 y T w U B j O Q M Y Z o c y I 7 F b M x t R Q B l l e P 7 b 4 K s / k 6 3 H 8 P 7 m s u h 5 x v f N 6 p X 0 8 S 6 e I d t A u 2 k c e a q A 2 O k V n q I M Y i t E 9 e k C P z p 3 z 5 D w 7 L 5 + t B W c 2 U 0 Y / 4 L x + A P J 9 n C E = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = "
V v j g R l i A Z G l D z 4 K R 3 R R 9 n P 5 J I 8 8 = " > A A A C C 3 i c d V B N S w M x E M 3 W r / p d 7 d F L s A i C s G T b Y t u L F L 1 4 V L A q t K V k 0 9 S G J t k l m R W W Z X + C v 8 G r n r 2 J V 3 + E R / + J u 7 W C i j 4 Y e L w 3 w 8 w 8 P 5 T C A i F v T m F u f m F x q b i 8 s r q 2 v r F Z 2 t q + t E F k G O + w Q A b m 2 q e W S 6 F 5 B w R I f h 0 a T p U v + Z U / O c n 9 q 1 t u r A j 0 B c Q h 7 y t 6 o 8 V I M A q Z N C i V e 7 5 K e m M K S Z y m g + Q I D n Q 6 K F W I 2 6 g 2 6 6 0 a J i 4 5 b N X r J C e 1 R r X R x J 5 L p q i g G c 4 G p f f e M G C R 4 h q Y p N Z 2 P R J C P 6 E G B J M 8 X e l F l o e U T e g N 7 2 Z U U 8 V t P 5 k e n + K 9 T B n i U W C y 0 o C n 6 v e J h C p r Y + V n n Y r C 2 P 7 2 c v E v r x v B q N l P h A 4 j 4 J p 9 L h p F E k O A 8 y T w U B j O Q M Y Z o c y I 7 F b M x t R Q B l l e P 7 b 4 K s / k 6 3 H 8 P 7 m s u h 5 x v f N 6 p X 0 8 S 6 e I d t A u 2 k c e a q A 2 O k V n q I M Y i t E 9 e k C P z p 3 z 5 D w 7 L 5 + t B W c 2 U 0 Y / 4 L x + A P J 9 n C E = < / l a t e x i t > ?t < l a t e x i t s h a 1 _ b a s e 6 4 = " l 4 N Y C n 8 C z f U I b 1 / 7 p D u X 8 R R 9 9 p k = " > A A A C A X i c d V D J S g N B E O 2 J W 4 x b 1 K O X x i B 4 G n q y m O Q W 9 O I x g j G B J I S e T k / S p G e h u 0 Y I w 5 z 8 B q 9 6 9 i Z e / R K P / o m d R T C i D w o e 7 1 V R V c + N p N B A y I e V W V v f 2 N z K b u d 2 d v f 2 D / K H R 3 c 6 j B X j L R b K U H V c q r k U A W + B A M k 7 k e L U d y V v u 5 O r m d + + 5 0 q L M L i F a c T 7 P h 0 F w h O M g p G 6 v T G F Z J o O E k g H + Q K x S d m p 1 y q Y 2 C V S q V a K h l z U 6 6 R U x o 5 N 5 i i g J Z q D / G d v G L L Y 5 w E w S b X u O i S C f k I V C C Z 5 m u v F m k e U T e i I d w 0 N q M 9 1 P 5 m f n O I z o w y x F y p T A e C 5 + n M i o b 7 W U 9 8 1 n T 6 F s f 7 t z c S / v G 4 M X q 2 f i C C K g Q d s s c i L J Y Y Q z / 7 H Q 6 E 4 A z k 1 h D I l z K 2 Y j a m i D E x K K 1 t c f 5 b J 9 + P 4 f 3 J X t B 1 i O z f l Q u N y m U 4 W n a B T d I 4 c V E U N d I 2 a q I U Y C t E j e k L P 1 o P 1 Y r 1 a b 4 v W j L W c O U Y r s N 6 / A G u H m K M = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " l 4 N Y C n 8 C z f U I b 1 / 7 p D u X 8 R R 9 9 p k = " > A A A C A X i c d V D J S g N B E O 2 J W 4 x b 1 K O X x i B 4 G n q y m O Q W 9 O I x g j G B J I S e T k / S p G e h u 0 Y I w 5 z 8 B q 9 6 9 i Z e / R K P / o m d R T C i D w o e 7 1 V R V c + N p N B A y I e V W V v f 2 N z K b u d 2 d v f 2 D / K H R 3 c 6 j B X j L R b K U H V c q r k U A W + B A M k 7 k e L U d y V v u 5 O r m d + + 5 0 q L M L i F a c T 7 P h 0 F w h O M g p G 6 v T G F Z J o O E k g H + Q K x S d m p 1 y q Y 2 C V S q V a K h l z U 6 6 R U x o 5 N 5 i i g J Z q D / G d v G L L Y 5 w E w S b X u O i S C f k I V C C Z 5 m u v F m k e U T e i I d w 0 N q M 9 1 P 5 m f n O I z o w y x F y p T A e C 5 + n M i o b 7 W U 9 8 1 n T 6 F s f 7 t z c S / v G 4 M X q 2 f i C C K g Q d s s c i L J Y Y Q z / 7 H Q 6 E 4 A z k 1 h D I l z K 2 Y j a m i D E x K K 1 t c f 5 b J 9 + P 4 f 3 J X t B 1 i O z f l Q u N y m U 4 W n a B T d I 4 c V E U N d I 2 a q I U Y C t E j e k L P 1 o P 1 Y r 1 a b 4 v W j L W c O U Y r s N 6 / A G u H m K M = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " l 4 N Y C n 8 C z f U I b 1 / 7 p D u X 8 R R 9 9 p k = " > A A A C A X i c d V D J S g N B E O 2 J W 4 x b 1 K O X x i B 4 G n q y m O Q W 9 O I x g j G B J I S e T k / S p G e h u 0 Y I w 5 z 8 B q 9 6 9 i Z e / R K P / o m d R T C i D w o e 7 1 V R V c + N p N B A y I e V W V v f 2 N z K b u d 2 d v f 2 D / K H R 3 c 6 j B X j L R b K U H V c q r k U A W + B A M k 7 k e L U d y V v u 5 O r m d + + 5 0 q L M L i F a c T 7 P h 0 F w h O M g p G 6 v T G F Z J o O E k g H + Q K x S d m p 1 y q Y 2 C V S q V a K h l z U 6 6 R U x o 5 N 5 i i g J Z q D / G d v G L L Y 5 w E w S b X u O i S C f k I V C C Z 5 m u v F m k e U T e i I d w 0 N q M 9 1 P 5 m f n O I z o w y x F y p T A e C 5 + n M i o b 7 W U 9 8 1 n T 6 F s f 7 t z c S / v G 4 M X q 2 f i C C K g Q d s s c i L J Y Y Q z / 7 H Q 6 E 4 A z k 1 h D I l z K 2 Y j a m i D E x K K 1 t c f 5 b J 9 + P 4 f 3 J X t B 1 i O z f l Q u N y m U 4 W n a B T d I 4 c V E U N d I 2 a q I U Y C t E j e k L P 1 o P 1 Y r 1 a b 4 v W j L W c O U Y r s N 6 / A G u H m K M = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " l 4 N Y C n 8 C z f U I b 1 / 7 p D u X 8 R R 9 9 p k = " > A A A C A X i c d V D J S g N B E O 2 J W 4 x b 1 K O X x i B 4 G n q y m O Q W 9 O I x g j G B J I S e T k / S p G e h u 0 Y I w 5 z 8 B q 9 6 9 i Z e / R K P / o m d R T C i D w o e 7 1 V R V c + N p N B A y I e V W V v f 2 N z K b u d 2 d v f 2 D / K H R 3 c 6 j B X j L R b K U H V c q r k U A W + B A M k 7 k e L U d y V v u 5 O r m d + + 5 0 q L M L i F a c T 7 P h 0 F w h O M g p G 6 v T G F Z J o O E k g H + Q K x S d m p 1 y q Y 2 C V S q V a K h l z U 6 6 R U x o 5 N 5 i i g J Z q D / G d v G L L Y 5 w E w S b X u O i S C f k I V C C Z 5 m u v F m k e U T e i I d w 0 N q M 9 1 P 5 m f n O I z o w y x F y p T A e C 5 + n M i o b 7 W U 9 8 1 n T 6 F s f 7 t z c S / v G 4 M X q 2 f i C C K g Q d s s c i L J Y Y Q z / 7 H Q 6 E 4 A z k 1 h D I l z K 2 Y j a m i D E x K K 1 t c f 5 b J 9 + P 4 f 3 J X t B 1 i O z f l Q u N y m U 4 W n a B T d I 4 c V E U N d I 2 a q I U Y C t E j e k L P 1 o P 1 Y r 1 a b 4 v W j L W c O U Y r s N 6 / A G u H m K M = < / l a t e x i t > w < l a t e x i t s h a 1 _ b a s e 6 4 = " s r 7 9 D 3 N k Q o M r W j 8 g M B T N F Q e I u p M = " > A A A B 9 3 i c b V A 9 S w N B E J 2 L X z F + R S 1 t F o N g F e 5 E 0 D J o Y 5 m A + Y D k C H u b u W T J 7 t 2 x u 6 c c I b / A V m s 7 s f X n W P p P 3 C R X m M Q H A 4 / 3 Z p i Z F y S C a + O 6 3 0 5 h Y 3 N r e 6 e 4 W 9 r b P z g 8 K h + f t H S c K o Z N F o t Y d Q K q U f A I m 4 Y b g Z 1 E I Z W B w H Y w v p / 5 7 S d U m s f R o 8 k S 9 C U d R j z k j B o r N Z 7 7 5 Y p b d e c g 6 8 T L S Q V y 1 P v l n 9 4 g Z q n E y D B B t e 5 6 b m L 8 C V W G M 4 H T U i / V m F A 2 p k P s W h p R i d q f z A + d k g u r D E g Y K 1 u R I X P 1 7 8 S E S q 0 z G d h O S c 1 I r 3 o z 8 T + v m 5 r w 1 p / w K E k N R m y x K E w F M T G Z f U 0 G X C E z I r O E M s X t r Y S N q K L M 2 G y W t g R y a j P x V h N Y J 6 2 r q u d W v c Z 1 p X a X p 1 O E M z i H S / D g B m r w A H V o A g O E F 3 i F N y d z 3 p 0 P 5 3 P R W n D y m V N Y g v P 1 C 4 m 2 k 5 E = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " s r 7 9 D 3 N k Q o M r W j 8 g M B T N F Q e I u p M = " > A A A B 9 3 i c b V A 9 S w N B E J 2 L X z F + R S 1 t F o N g F e 5 E 0 D J o Y 5 m A + Y D k C H u b u W T J 7 t 2 x u 6 c c I b / A V m s 7 s f X n W P p P 3 C R X m M Q H A 4 / 3 Z p i Z F y S C a + O 6 3 0 5 h Y 3 N r e 6 e 4 W 9 r b P z g 8 K h + f t H S c K o Z N F o t Y d Q K q U f A I m 4 Y b g Z 1 E I Z W B w H Y w v p / 5 7 S d U m s f R o 8 k S 9 C U d R j z k j B o r N Z 7 7 5 Y p b d e c g 6 8 T L S Q V y 1 P v l n 9 4 g Z q n E y D B B t e 5 6 b m L 8 C V W G M 4 H T U i / V m F A 2 p k P s W h p R i d q f z A + d k g u r D E g Y K 1 u R I X P 1 7 8 S E S q 0 z G d h O S c 1 I r 3 o z 8 T + v m 5 r w 1 p / w K E k N R m y x K E w F M T G Z f U 0 G X C E z I r O E M s X t r Y S N q K L M 2 G y W t g R y a j P x V h N Y J 6 2 r q u d W v c Z 1 p X a X p 1 O E M z i H S / D g B m r w A H V o A g O E F 3 i F N y d z 3 p 0 P 5 3 P R W n D y m V N Y g v P 1 C 4 m 2 k 5 E = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " s r 7 9 D 3 N k Q o M r W j 8 g M B T N F Q e I u p M = " > A A A B 9 3 i c b V A 9 S w N B E J 2 L X z F + R S 1 t F o N g F e 5 E 0 D J o Y 5 m A + Y D k C H u b u W T J 7 t 2 x u 6 c c I b / A V m s 7 s f X n W P p P 3 C R X m M Q H A 4 / 3 Z p i Z F y S C a + O 6 3 0 5 h Y 3 N r e 6 e 4 W 9 r b P z g 8 K h + f t H S c K o Z N F o t Y d Q K q U f A I m 4 Y b g Z 1 E I Z W B w H Y w v p / 5 7 S d U m s f R o 8 k S 9 C U d R j z k j B o r N Z 7 7 5 Y p b d e c g 6 8 T L S Q V y 1 P v l n 9 4 g Z q n E y D B B t e 5 6 b m L 8 C V W G M 4 H T U i / V m F A 2 p k P s W h p R i d q f z A + d k g u r D E g Y K 1 u R I X P 1 7 8 S E S q 0 z G d h O S c 1 I r 3 o z 8 T + v m 5 r w 1 p / w K E k N R m y x K E w F M T G Z f U 0 G X C E z I r O E M s X t r Y S N q K L M 2 G y W t g R y a j P x V h N Y J 6 2 r q u d W v c Z 1 p X a X p 1 O E M z i H S / D g B m r w A H V o A g O E F 3 i F N y d z 3 p 0 P 5 3 P R W n D y m V N Y g v P 1 C 4 m 2 k 5 E = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " s r 7 9 D 3 N k Q o M r W j 8 g M B T N F Q e I u p M = " > A A A B 9 3 i c b V A 9 S w N B E J 2 L X z F + R S 1 t F o N g F e 5 E 0 D J o Y 5 m A + Y D k C H u b u W T J 7 t 2 x u 6 c c I b / A V m s 7 s f X n W P p P 3 C R X m M Q H A 4 / 3 Z p i Z F y S C a + O 6 3 0 5 h Y 3 N r e 6 e 4 W 9 r b P z g 8 K h + f t H S c K o Z N F o t Y d Q K q U f A I m 4 Y b g Z 1 E I Z W B w H Y w v p / 5 7 S d U m s f R o 8 k S 9 C U d R j z k j B o r N Z 7 7 5 Y p b d e c g 6 8 T L S Q V y 1 P v l n 9 4 g Z q n E y D B B t e 5 6 b m L 8 C V W G M 4 H T U i / V m F A 2 p k P s W h p R i d q f z A + d k g u r D E g Y K 1 u R I X P 1 7 8 S E S q 0 z G d h O S c 1 I r 3 o z 8 T + v m 5 r w 1 p / w K E k N R m y x K E w F M T G Z f U 0 G X C E z I r O E M s X t r Y S N q K L M 2 G y W t g R y a j P x V h N Y J 6 2 r q u d W v c Z 1 p X a X p 1 O E M z i H S / D g B m r w A H V o A g O E F 3 i F N y d z 3 p 0 P 5 3 P R W n D y m V N Y g v P 1 C 4 m 2 k 5 E = < / l a t e x i t > steps steps ?
t + 1 : t + w < l a t e x i t s h a 1 _ b a s e 6 4 = " r E l p / j C M z E R k 6 f x C L D R z g I m g a p M = " > A A A C D n i c d V B N S 8 N A E N 3 4 / W 1 V 8 O J l s Q h C I W z a Y q q n o h e P F a w V m l I 2 2 6 1 d u p u E 3 Y l S Y v 6 D v 8 G r n r 2 J V / + C R / + J S a 2 g o g 8 G H u / N M D P P j 6 Q w Q M i b N T U 9 M z s 3 v 7 C 4 t L y y u r Z e 2 N i 8 M G G s G W + y U I b 6 0 q e G S x H w J g i Q / D L S n C p f 8 p Y / P M n 9 1 j X X R o T B O Y w i 3 l H 0 K h B 9 w S h k U r e w 7 Q 0 o J J 6 v k l G a d h M o O U d Q u k m 7 h S K x 3 X K t e l j B x C Y H h 9 U q y U n F L b s 1 7 N h k j C K a o N E t v H u 9 k M W K B 8 A k N a b t k A g 6 C d U g m O T p k h c b H l E 2 p F e 8 n d G A K m 4 6 y f j + F O 9 l S g / 3 Q 5 1 V A H i s f p 9 I q D J m p P y s U 1 E Y m N 9 e L v 7 l t W P o 1 z q J C K I Y e M A + F / V j i S H E e R i 4 J z R n I E c Z o U y L 7 F b M B l R T B l l k P 7 b 4 K s / k 6 3 H 8 P 7 k o 2 w 6 x n b N q s X 4 8 S W c B 7 a B d t I 8 c 5 K I 6 O k U N 1 E Q M 3 a J 7 9 I A e r T v r y X q 2 X j 5 b p 6 z J z B b 6 A e v 1 A 8 j V n R Q = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " r E l p / j C M z E R k 6 f x C L D R z g I m g a p M = " > A A A C D n i c d V B N S 8 N A E N 3 4 / W 1 V 8 O J l s Q h C I W z a Y q q n o h e P F a w V m l I 2 2 6 1 d u p u E 3 Y l S Y v 6 D v 8 G r n r 2 J V / + C R / + J S a 2 g o g 8 G H u / N M D P P j 6 Q w Q M i b N T U 9 M z s 3 v 7 C 4 t L y y u r Z e 2 N i 8 M G G s G W + y U I b 6 0 q e G S x H w J g i Q / D L S n C p f 8 p Y / P M n 9 1 j X X R o T B O Y w i 3 l H 0 K h B 9 w S h k U r e w 7 Q 0 o J J 6 v k l G a d h M o O U d Q u k m 7 h S K x 3 X K t e l j B x C Y H h 9 U q y U n F L b s 1 7 N h k j C K a o N E t v H u 9 k M W K B 8 A k N a b t k A g 6 C d U g m O T p k h c b H l E 2 p F e 8 n d G A K m 4 6 y f j + F O 9 l S g / 3 Q 5 1 V A H i s f p 9 I q D J m p P y s U 1 E Y m N 9 e L v 7 l t W P o 1 z q J C K I Y e M A + F / V j i S H E e R i 4 J z R n I E c Z o U y L 7 F b M B l R T B l l k P 7 b 4 K s / k 6 3 H 8 P 7 k o 2 w 6 x n b N q s X 4 8 S W c B 7 a B d t I 8 c 5 K I 6 O k U N 1 E Q M 3 a J 7 9 I A e r T v r y X q 2 X j 5 b p 6 z J z B b 6 A e v 1 A 8 j V n R Q = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " r E l p / j C M z E R k 6 f x C L D R z g I m g a p M = " > A A A C D n i c d V B N S 8 N A E N 3 4 / W 1 V 8 O J l s Q h C I W z a Y q q n o h e P F a w V m l I 2 2 6 1 d u p u E 3 Y l S Y v 6 D v 8 G r n r 2 J V / + C R / + J S a 2 g o g 8 G H u / N M D P P j 6 Q w Q M i b N T U 9 M z s 3 v 7 C 4 t L y y u r Z e 2 N i 8 M G G s G W + y U I b 6 0 q e G S x H w J g i Q / D L S n C p f 8 p Y / P M n 9 1 j X X R o T B O Y w i 3 l H 0 K h B 9 w S h k U r e w 7 Q 0 o J J 6 v k l G a d h M o O U d Q u k m 7 h S K x 3 X K t e l j B x C Y H h 9 U q y U n F L b s 1 7 N h k j C K a o N E t v H u 9 k M W K B 8 A k N a b t k A g 6 C d U g m O T p k h c b H l E 2 p F e 8 n d G A K m 4 6 y f j + F O 9 l S g / 3 Q 5 1 V A H i s f p 9 I q D J m p P y s U 1 E Y m N 9 e L v 7 l t W P o 1 z q J C K I Y e M A + F / V j i S H E e R i 4 J z R n I E c Z o U y L 7 F b M B l R T B l l k P 7 b 4 K s / k 6 3 H 8 P 7 k o 2 w 6 x n b N q s X 4 8 S W c B 7 a B d t I 8 c 5 K I 6 O k U N 1 E Q M 3 a J 7 9 I A e r T v r y X q 2 X j 5 b p 6 z J z B b 6 A e v 1 A 8 j V n R Q = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " r E l p / j C M z E R k 6 f x C L D R z g I m g a p M = " > A A A C D n i c d V B N S 8 N A E N 3 4 / W 1 V 8 O J l s Q h C I W z a Y q q n o h e P F a w V m l I 2 2 6 1 d u p u E 3 Y l S Y v 6 D v 8 G r n r 2 J V / + C R / + J S a 2 g o g 8 G H u / N M D P P j 6 Q w Q M i b N T U 9 M z s 3 v 7 C 4 t L y y u r Z e 2 N i 8 M G G s G W + y U I b 6 0 q e G S x H w J g i Q / D L S n C p f 8 p Y / P M n 9 1 j X X R o T B O Y w i 3 l H 0 K h B 9 w S h k U r e w 7 Q 0 o J J 6 v k l G a d h M o O U d Q u k m 7 h S K x 3 X K t e l j B x C Y H h 9 U q y U n F L b s 1 7 N h k j C K a o N E t v H u 9 k M W K B 8 A k N a b t k A g 6 C d U g m O T p k h c b H l E 2 p F e 8 n d G A K m 4 6 y f j + F O 9 l S g / 3 Q 5 1 V A H i s f p 9 I q D J m p P y s U 1 E Y m N 9 e L v 7 l t W P o 1 z q J C K I Y e M A + F / V j i S H E e R i 4 J z R n I E c Z o U y L 7 F b M B l R T B l l k P 7 b 4 K s / k 6 3 H 8 P 7 k o 2 w 6 x n b N q s X 4 8 S W c B 7 a B d t I 8 c 5 K I 6 O k U N 1 E Q M 3 a J 7 9 I A e r T v r y X q 2 X j 5 b p 6 z J z B b 6 A e v 1 A 8 j V n R Q = < / l a t e x i t > ?t+ n :t + n + w 1 < l a t e x i t s h a 1 _ b a s e 6 4 = " O 4 2 A W T U / w g A W 8 9 v F J E 3 o q Q Q h 6 R o = " > A A A C E n i c d V B N S w M x E M 3 6 / W 3 V m 1 6 C R R D E J V u L r Z 5 E L x 4 V r A p t K d k 0 t a F J d k l m l b I s + C P 8 D V 7 1 7 E 2 8 + g c 8 + k / M 1 g o q + m D g 8 d 4 M M / P C W A o L h L x 5 I 6 N j 4 x O T U 9 M z s 3 P z C 4 u F p e V z G y W G 8 R q L Z G Q u Q 2 q 5 F J r X Q I D k l 7 H h V I W S X 4 S 9 o 9 y / u O b G i k i f Q T / m T U W v t O g I R s F J r c J q o 0 s h b Y Q q 7 W d Z K 4 U t v e 9 q 6 2 Y 7 y F q F I v E r p W p 5 b w c T n + z u l c s k J z u V U q W K A 5 8 M U E R D n L Q K 7 4 1 2 x B L F N T B J r a 0 H J I Z m S g 0 I J n k 2 0 0 g s j y n r 0 S t e d 1 R T x W 0 z H f y Q 4 Q 2 n t H E n M q 4 0 4 I H 6 f S K l y t q + C l 2 n o t C 1 v 7 1 c / M u r J 9 C p N l O h 4 w S 4 Z p + L O o n E E O E 8 E N w W h j O Q f U c o M 8 L d i l m X G s r A x f Z j S 6 j y T L 4 e x / + T 8 5 I f E D 8 4 L R c P D o f p T K E 1 t I 4 2 U Y A q 6 A A d o x N U Q w z d o n v 0 g B 6 9 O + / J e / Z e P l t H v O H M C v o B 7 / U D a A q e c A = = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " O 4 2 A W T U / w g A W 8 9 v F J E 3 o q Q Q h 6 R o = " > A A A C E n i c d V B N S w M x E M 3 6 / W 3 V m 1 6 C R R D E J V u L r Z 5 E L x 4 V r A p t K d k 0 t a F J d k l m l b I s + C P 8 D V 7 1 7 E 2 8 + g c 8 + k / M 1 g o q + m D g 8 d 4 M M / P C W A o L h L x 5 I 6 N j 4 x O T U 9 M z s 3 P z C 4 u F p e V z G y W G 8 R q L Z G Q u Q 2 q 5 F J r X Q I D k l 7 H h V I W S X 4 S 9 o 9 y / u O b G i k i f Q T / m T U W v t O g I R s F J r c J q o 0 s h b Y Q q 7 W d Z K 4 U t v e 9 q 6 2 Y 7 y F q F I v E r p W p 5 b w c T n + z u l c s k J z u V U q W K A 5 8 M U E R D n L Q K 7 4 1 2 x B L F N T B J r a 0 H J I Z m S g 0 I J n k 2 0 0 g s j y n r 0 S t e d 1 R T x W 0 z H f y Q 4 Q 2 n t H E n M q 4 0 4 I H 6 f S K l y t q + C l 2 n o t C 1 v 7 1 c / M u r J 9 C p N l O h 4 w S 4 Z p + L O o n E E O E 8 E N w W h j O Q f U c o M 8 L d i l m X G s r A x f Z j S 6 j y T L 4 e x / + T 8 5 I f E D 8 4 L R c P D o f p T K E 1 t I 4 2 U Y A q 6 A A d o x N U Q w z d o n v 0 g B 6 9 O + / J e / Z e P l t H v O H M C v o B 7 / U D a A q e c A = = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " O 4 2 A W T U / w g A W 8 9 v F J E 3 o q Q Q h 6 R o = " > A A A C E n i c d V B N S w M x E M 3 6 / W 3 V m 1 6 C R R D E J V u L r Z 5 E L x 4 V r A p t K d k 0 t a F J d k l m l b I s + C P 8 D V 7 1 7 E 2 8 + g c 8 + k / M 1 g o q + m D g 8 d 4 M M / P C W A o L h L x 5 I 6 N j 4 x O T U 9 M z s 3 P z C 4 u F p e V z G y W G 8 R q L Z G Q u Q 2 q 5 F J r X Q I D k l 7 H h V I W S X 4 S 9 o 9 y / u O b G i k i f Q T / m T U W v t O g I R s F J r c J q o 0 s h b Y Q q 7 W d Z K 4 U t v e 9 q 6 2 Y 7 y F q F I v E r p W p 5 b w c T n + z u l c s k J z u V U q W K A 5 8 M U E R D n L Q K 7 4 1 2 x B L F N T B J r a 0 H J I Z m S g 0 I J n k 2 0 0 g s j y n r 0 S t e d 1 R T x W 0 z H f y Q 4 Q 2 n t H E n M q 4 0 4 I H 6 f S K l y t q + C l 2 n o t C 1 v 7 1 c / M u r J 9 C p N l O h 4 w S 4 Z p + L O o n E E O E 8 E N w W h j O Q f U c o M 8 L d i l m X G s r A x f Z j S 6 j y T L 4 e x / + T 8 5 I f E D 8 4 L R c P D o f p T K E 1 t I 4 2 U Y A q 6 A A d o x N U Q w z d o n v 0 g B 6 9 O + / J e / Z e P l t H v O H M C v o B 7 / U D a A q e c A = = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " O 4 2 A W T U / w g A W 8 9 v F J E 3 o q Q Q h 6 R o = " > A A A C E n i c d V B N S w M x E M 3 6 / W 3 V m 1 6 C R R D E J V u L r Z 5 E L x 4 V r A p t K d k 0 t a F J d k l m l b I s + C P 8 D V 7 1 7 E 2 8 + g c 8 + k / M 1 g o q + m D g 8 d 4 M M / P C W A o L h L x 5 I 6 N j 4 x O T U 9 M z s 3 P z C 4 u F p e V z G y W G 8 R q L Z G Q u Q 2 q 5 F J r X Q I D k l 7 H h V I W S X 4 S 9 o 9 y / u O b G i k i f Q T / m T U W v t O g I R s F J r c J q o 0 s h b Y Q q 7 W d Z K 4 U t v e 9 q 6 2 Y 7 y F q F I v E r p W p 5 b w c T n + z u l c s k J z u V U q W K A 5 8 M U E R D n L Q K 7 4 1 2 x B L F N T B J r a 0 H J I Z m S g 0 I J n k 2 0 0 g s j y n r 0 S t e d 1 R T x W 0 z H f y Q 4 Q 2 n t H E n M q 4 0 4 I H 6 f S K l y t q + C l 2 n o t C 1 v 7 1 c / M u r J 9 C p N l O h 4 w S 4 Z p + L O o n E E O E 8 E N w W h j O Q f U c o M 8 L d i l m X G s r A x f Z j S X Q v A k C J L 9 M D K c q k v w i u j 4 q / I u / 3 F g R 6 z M Y J L y t 6 J U W P c E o O K l T X g n 7 F L I w U t k g z z s Z 4 H A f 7 x U f b O j N I O +
U K 8 Q n 1 a B R r 2 H i b 5 P a b m 3 L k Z 1 G g 2 x X c e C T I S p o h J N O + S X s x i x V X A O T 1 N p W Q B J o Z 9 S A Y J L n M 2 F q e U L Z N b 3 i L U c 1 V d y 2 s + E d O V 5 z S h f 3 Y u O e B j x U P 3 Z k V F k 7 U J G r V B T 6 9 q t X i N 9 5 r R R 6 9 X Y m d J I C 1 + x t U C + V G G J c h I K 7 w n A G c u A I Z U a 4 X T H r U 0 M Z u O g + T Y l U k c n 7 4 f h n c r 7 l B 8 Q P T q u V g 8 N R O i W 0 j F b R O g r Q L j p A x + g E N R F D / 9 A N u k V 3 3 n / v 3 n v w H t 9 K x 7 x R X Q v A k C J L 9 M D K c q k v w i u j 4 q / I u / 3 F g R 6 z M Y J L y t 6 J U W P c E o O K l T X g n 7 F L I w U t k g z z s Z 4 H A f 7 x U f b O j N I O + U K 8 Q n 1 a B R r 2 H i b 5 P a b m 3 L k Z 1 G g 2 x X c e C T I S p o h J N O + S X s x i x V X A O T 1 N p W Q B J o Z 9 S A Y J L n M 2 F q e U L Z N b 3 i L U c 1 V d y 2 s + E d O V 5 z S h f 3 Y u O e B j x U P 3 Z k V F k 7 U J G r V B T 6 9 q t X i N 9 5 r R R 6 9 X Y m d J I C 1 + x t U C + V G G J c h I K 7 w n A G c u A I Z U a 4 X T H r U 0 M Z u O g + T Y l U k c n 7 4 f h n c r 7 l B 8 Q P T q u V g 8 N R O i W 0 j F b R O g r Q L j p A x + g E N R F D / 9 A N u k V 3 3 n / v 3 n v w H t 9 K x 7 x R X Q v A k C J L 9 M D K c q k v w i u j 4 q / I u / 3 F g R 6 z M Y J L y t 6 J U W P c E o O K l T X g n 7 F L I w U t k g z z s Z 4 H A f 7 x U f b O j N I O + U K 8 Q n 1 a B R r 2 H i b 5 P a b m 3 L k Z 1 G g 2 x X c e C T I S p o h J N O + S X s x i x V X A O T 1 N p W Q B J o Z 9 S A Y J L n M 2 F q e U L Z N b 3 i L U c 1 V d y 2 s + E d O V 5 z S h f 3 Y u O e B j x U P 3 Z k V F k 7 U J G r V B T 6 9 q t X i N 9 5 r R R 6 9 X Y m d J I C 1 + x t U C + V G G J c h I K 7 w n A G c u A I Z U a 4 X T H r U 0 M Z u O g + T Y l U k c n 7 4 f h n c r 7 l B 8 Q P T q u V g 8 N R O i W 0 j F b R O g r Q L j p A x + g E N R F D / 9 A N u k V 3 3 n / v 3 n v w H t 9 K x 7 x R X Q v A k C J L 9 M D K c q k v w i u j 4 q / I u / 3 F g R 6 z M Y J L y t 6 J U W P c E o O K l T X g n 7 F L I w U t k g z z s Z 4 H A f 7 x U f b O j N I O + U K 8 Q n 1 a B R r 2 H i b 5 P a b m 3 L k Z 1 G g 2 x X c e C T I S p o h J N O + S X s x i x V X A O T 1 N p W Q B J o Z 9 S A Y J L n M 2 F q e U L Z N b 3 i L U c 1 V d y 2 s + E d O V 5 z S h f 3 Y u O e B j x U P 3 Z k V F k 7 U J G r V B T 6 9 q t X i N 9 5 r R R 6 9 X Y m d J I C 1 + x t U C + V G G J c h I K 7 w n A G c u A I Z U a 4 X T H r U 0 M Z u O g + T Y l U k c n 7 4 f h n c r 7 l B 8 Q P T q u V g 8 N R O i W 0 j F b R O g r Q L j p A x + g E N R F D / 9 A N u k V 3 3 n / v 3 n v w H t 9 K x 7 x R U l A T 1 a T E d 9 R 4 = " > A A A C G n i c d V B N b x M x E P W W A i E U m s K R i 5 U I q V L E y p t E J I F L R C 8 c U 6 n 5 k L J R 5 H W c x K r t X d m z R d F q 7 / w I f g N X O H N D v f b S I / + k 3 i R I B L V P s v X 0 3 o x m 5 k W J F B Y I u f U O H h 0 + f v K 0 9 K z U l A T 1 a T E d 9 R 4 = " > A A A C G n i c d V B N b x M x E P W W A i E U m s K R i 5 U I q V L E y p t E J I F L R C 8 c U 6 n 5 k L J R 5 H W c x K r t X d m z R d F q 7 / w I f g N X O H N D v f b S I / + k 3 i R I B L V P s v X 0 3 o x m 5 k W J F B Y I u f U O H h 0 + f v K 0 9 K z U l A T 1 a T E d 9 R 4 = " > A A A C G n i c d V B N b x M x E P W W A i E U m s K R i 5 U I q V L E y p t E J I F L R C 8 c U 6 n 5 k L J R 5 H W c x K r t X d m z R d F q 7 / w I f g N X O H N D v f b S I / + k 3 i R I B L V P s v X 0 3 o x m 5 k W J F B Y I u f U O H h 0 + f v K 0 9 K z v 3 V E g W h X c q j a k b 4 E n I f E a w 0 l L 7 Y V S u I N O p 1 u 1 G D S I T X T V s G + W k 5 l S d O r R M t E A F r N A a l T + H 4 4 g k A Q 0 V 4 V j K g Y V i 5 W Z Y K E Y 4 n Z e G i a Q x J j M 8 o Q N N Q x x Q 6 W a L Q + f w Q i t j 6 E d C V 6 j g Q v 0 5 k e F A y j T w d G e A 1 V T + 9 n L x L 2 + Q K L / u Z i y M E 0 V D s l z k J x y q C O Z f w z E T l C i e a o K J Y P p W S K Z Y Y K J 0 N m t b v G C u M / l + H P 5 P u l X T Q q b V t i v N 6 1 U 6 R X A G z s E l s I A D m u A W t E A H E E D B I 3 g C z 0 Z q v B i v x t u y t W C s Z k 7 B G o z 3 L w b n k + Q = < / v 3 V E g W h X c q j a k b 4 E n I f E a w 0 l L 7 Y V S u I N O p 1 u 1 G D S I T X T V s G + W k 5 l S d O r R M t E A F r N A a l T + H 4 4 g k A Q 0 V 4 V j K g Y V i 5 W Z Y K E Y 4 n Z e G i a Q x J j M 8 o Q N N Q x x Q 6 W a L Q + f w Q i t j 6 E d C V 6 j g Q v 0 5 k e F A y j T w d G e A 1 V T + 9 n L x L 2 + Q K L / u Z i y M E 0 V D s l z k J x y q C O Z f w z E T l C i e a o K J Y P p W S K Z Y Y K J 0 N m t b v G C u M / l + H P 5 P u l X T Q q b V t i v N 6 1 U 6 R X A G z s E l s I A D m u A W t E A H E E D B I 3 g C z 0 Z q v B i v x t u y t W C s Z k 7 B G o z 3 L w b n k + Q = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " o c O 9 K N m d P O U H A 5 9 n c G 4 u O Z R A B n I = " > A A A B 9 3 i c d V D L S s N A F J 3 U V 6 2 v q k s 3 g 0 V w F S Z t M O 2 u 6 M Z l C / Y B b S i T 6 a Q d O n k w M 1 F C 6 B e 4 1 b U 7 c e v n u P R P n L Q V r O i B C 4 d z 7 u X e e 7 y Y M 6 k Q + j A K G 5 t b 2 z v F 3 d L e / s H h U f n 4 p C u j R B D a I R G P R N / D k n I W 0 o 5 i i t N + L C g O P E 5 7 3 u w m 9 3 v 3 V E g W h X c q j a k b 4 E n I f E a w 0 l L 7 Y V S u I N O p 1 u 1 G D S I T X T V s G + W k 5 l S d O r R M t E A F r N A a l T + H 4 4 g k A Q 0 V 4 V j K g Y V i 5 W Z Y K E Y 4 n Z e G i a Q x J j M 8 o Q N N Q x x Q 6 W a L Q + f w Q i t j 6 E d C V 6 j g Q v 0 5 k e F A y j T w d G e A 1 V T + 9 n L x L 2 + Q K L / u Z i y M E 0 V D s l z k J x y q C O Z f w z E T l C i e a o K J Y P p W S K Z Y Y K J 0 N m t b v G C u M / l + H P 5 P u l X T Q q b V t i v N 6 1 U 6 R X A G z s E l s I A D m u A W t E A H E E D B I 3 g C z 0 Z q v B i v x t u y t W C s Z k 7 B G o z 3 L w b n k + Q = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " o c O 9 K N m d P O U H A 5 9 n c G 4 u O Z R A B n I = " > A A A B 9 3 i c d V D L S s N A F J 3 U V 6 2 v q k s 3 g 0 V w F S Z t M O 2 u 6 M Z l C / Y B b S i T 6 a Q d O n k w M 1 F C 6 B e 4 1 b U 7 c e v n u P R P n L Q V r O i B C 4 d z 7 u X e e 7 y Y M 6 k Q + j A K G 5 t b 2 z v F 3 d L e / s H h U f n 4 p C u j R B D a I R G P R N / D k n I W 0 o 5 i i t N + L C g O P E 5 7 3 u w m 9 3 v 3 V E g W h X c q j a k b 4 E n I f E a w 0 l L 7 Y V S u I N O p 1 u 1 G D S I T X T V s G + W k 5 l S d O r R M t E A F r N A a l T + H 4 4 g k A Q 0 V 4 V j K g Y V i 5 W Z Y K E Y 4 n Z e G i a Q x J j M 8 o Q N N Q x x Q 6 W a L Q + f w Q i t j 6 E d C V 6 j g Q v 0 5 k e F A y j T w d G e A 1 V T + 9 n L x L 2 + Q K L / u Z i y M E 0 V D s l z k J x y q C O Z f w z E T l C i e a o K J Y P p W S K Z Y Y K J 0 N m t b v G C u M / l + H P 5 P u l X T Q q b V t i v N 6 1 U 6 R X A G z s E l s I A D m u A W t E A H E E D B I 3 g C z 0 Z q v B i v x t u y t W C s Z k 7 B G o z 3 L w b n k + Q = < / l a t e x i t > w < l a t e x i t s h a 1 _ b a s e 6 4 = " o c O 9 K N m d P O U H A 5 9 n c G 4 u O Z R A B n I = " > A A A B 9 3 i c d V D L S s N A F J 3 U V 6 2 v q k s 3 g 0 V w F S Z t M O 2 u 6 M Z l C / Y B b S i T 6 a Q d O n k w M 1 F C 6 B e 4 1 b U 7 c e v n u P R P n L Q V r O i B C 4 d z 7 u X e e 7 y Y M 6 k Q + j A K G 5 t b 2 z v F 3 d L e / s H h U f n 4 p C u j R B D a I R G P R N / D k n I W 0 o 5 i i t N + L C g O P E 5 7 3 u w m 9 3 v 3 V E g W h X c q j a k b 4 E n I f E a w 0 l L 7 Y V S u I N O p 1 u 1 G D S I T X T V s G + W k 5 l S d O r R M t E A F r N A a l T + H 4 4 g k A Q 0 V 4 V j K g Y V i 5 W Z Y K E Y 4 n Z e G i a Q x J j M 8 o Q N N Q x x Q 6 W a L Q + f w Q i t j 6 E d C V 6 j g Q v 0 5 k e F A y j T w d G e A 1 V T + 9 n L x L 2 + Q K L / u Z i y M E 0 V D s l z k J x y q C O Z f w z E T l C i e a o K J Y P p W S K Z Y Y K J 0 N m t b v G C u M / l + H P 5 P u l X T Q q b V t i v N 6 1 U 6 R X A G z s E l s I A D m u A W t E A H E E D B I 3 g C z 0 Z q v B i v x t u y t W C s Z k 7 B G o z 3 L w b n k + Q = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " o c O 9 K N m d P O U H A 5 9 n c G 4 u O Z R A B n I = " > A A A B 9 3 i c d V D L S s N A F J 3 U V 6 2 v q k s 3 g 0 V w F S Z t M O 2 u 6 M Z l C / Y B b S i T 6 a Q d O n k w M 1 F C 6 B e 4 1 b U 7 c e v n u P R P n L Q V r O i B C 4 d z 7 u X e e 7 y Y M 6 k Q + j A K G 5 t b 2 z v F 3 d L e / s H h U f n 4 p C u j R B D a I R G P R N / D k n I W 0 o 5 i i t N + L C g O P E 5 7 3 u w m 9 3 v 3 V E g W h X c q j a k b 4 E n I f E a w 0 l L 7 Y V S u I N O p 1 u 1 G D S I T X T V s G + W k 5 l S d O r R M t E A F r N A a l T + H 4 4 g k A Q 0 V 4 V j K g Y V i 5 W Z Y K E Y 4 n Z e G i a Q x J j M 8 o Q N N Q x x Q 6 W a L Q + f w Q i t j 6 E d C V 6 j g Q v 0 5 k e F A y j T w d G e A 1 V T + 9 n L x L 2 + Q K L / u Z i y M E 0 V D s l z k J x y q C O Z f w z E T l C i e a o K J Y P p W S K Z Y Y K J 0 N m t b v G C u M / l + H P 5 P u l X T Q q b V t i v N 6 1 U 6 R X A G z s E l s I A D m u A W t E A H E E D B I 3 g C z 0 Z q v B i v x t u y t W C s Z k 7 B G o z 3 L w b n k + Q = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " o c O 9 K N m d P O U H A 5 9 n c G 4 u O Z R A B n I = " > A A A B 9 3 i c d V D L S s N A F J 3 U V 6 2 v q k s 3 g 0 V w F S Z t M O 2 u 6 M Z l C / Y B b S i T 6 a Q d O n k w M 1 F C 6 B e 4 1 b U 7 c e v n u P R P n L Q V r O i B C 4 d z 7 u X e e 7 y Y M 6 k Q + j A K G 5 t b 2 z v F 3 d L e / s H h U f n 4 p C u j R B D a I R G P R N / D k n I W 0 o 5 i i t N + L C g O P E 5 7 3 u w m 9 3 v 3 V E g W h X c q j a k b 4 E n I f E a w 0 l L 7 Y V S u I N O p 1 u 1 G D S I T X T V s G + W k 5 l S d O r R M t E A F r N A a l T + H 4 4 g k A Q 0 V 4 V j K g Y V i 5 W Z Y K E Y 4 n Z e G i a Q x J j M 8 o Q N N Q x x Q 6 W a L Q + f w Q i t j 6 E d C V 6 j g Q v 0 5 k e F A y j T w d G e A 1 V T + 9 n L x L 2 + Q K L / u Z i y M E 0 V D s l z k J x y q C O Z f w z E T l C i e a o K J Y P p W S K Z Y Y K J 0 N m t b v G C u M / l + H P 5 P u l X T Q q b V t i v N 6 1 U 6 R X A G z s E l s I A D m u A W t E A H E E D B I 3 g C z 0 Z q v B i v x t u y t W C s Z k 7 B G o z 3 L w b n k + Q = < / Q 0 V 4 V j K g Y V i 5 W Z Y K E Y 4 n Z e G i a Q x J j M 8 o Q N N Q x x Q 6 W a L Q + f w Q i t j 6 E d C V 6 j g Q v 0 5 k e F A y j T w d G e A 1 V T + 9 n L x L 2 + Q K L / u Z i y M E 0 V D s l z k J x y q C O Z f w z E T l C i e a o K J Y P p W S K Z Y Y K J 0 N m t b v G C u M / l + H P 5 P u l X T Q q b V t i v N 6 1 U 6 R X A G z s E l s I A D m u A W t E A H E E D B I 3 g C z 0 Z q v B i v
Single-Step SBS
The wait -k policy conducts translation concurrently with the source input , committing output words one by one while the source sentence is still growing .
In this case , conventional beam search is clearly inapplicable .
We propose to perform speculative beam search at each step by hallucinating w more steps into the future , and use the ranking after these w + 1 steps to make a more informed decision for the current step .
More formally , at step t , we generate y t based on already committed prefix y <t : ? , s t = top 1 next b 1 + w ( [ y <t , 1 ] ) ( 4 ) y ?t = y <t ? ?t ( 5 ) where ? = y <t ? ?t ? ?t+ 1:t+w has three parts , with the last one being a speculation of w steps ( see Fig. 2 ) .
We use next b 1 + w ( ? ) to speculate w steps .
The candidate ?t is selected based on the accumulative model score w steps later .
Then we commit ?t and move on to step t + 1 .
In the running example in Fig. 1 , we have w = 2 and b = 3 .
In the greedy mode , after the wait - 1 policy receives the first source word , " ? ? " ( world bank ) , the basic wait - 1 model commits " bank " which has the highest score .
In SBS , we perform a beam search for 1 + w = 3 steps with the two speculative steps marked in red .
After 3 steps , the path " world bank will " becomes the top candidate , thus we choose to commit " world " instead of " bank " and restart a new speculative beam search with " world " when we receive a new source word , " ? " ( plan to ) ; the speculative part from the previous step ( in red ) is removed .
Chunk- based SBS
The RL - based adaptive policy system ( Gu et al. , 2017 ) can commit a chunk of multiple words whenever there is a series of consecutive WRITEs , and conventional beam search can be applied on each chunk to improve the search quality within that chunk , which is already used in that work .
However , on top of the obvious per-chunk beam search , we can still apply SBS to further speculate w steps after the chunk .
For a chunk of length n starting at position t , we adapt SBS as : ? , s t = top 1 next b n+w ( [ y <t , 1 ] ) ( 6 ) y ?t+ n?1 = y <t ? ?t:t+n?1 ( 7 ) Here next b n+w ( ? ) does a beam search of n + w steps , with the last w steps speculated .
Similarly , ? = y <t ? ?t:t+n?1 ? ?t+n:t+n+w?1 has three parts , with the last being a speculation of w steps , and the middle one being the chunk of n steps returned and committed ( see Fig. 2 ) .
Experiments
Datasets and Latency Metrics
We evaluate our work on Chinese ?
English simultaneous translation tasks .
For the training data , we use the NIST corpus for Chinese ?
English ( 2 M sentence pairs ) .
We first apply BPE ( Sennrich et al. , 2015 ) on all texts in order to reduce the vocabulary sizes .
For Chinese ?
English evaluation , we use NIST 2006 and NIST 2008 as our dev and test sets with 4 English references .
For English ?
Chinese , we use the second among the four English references as the source text .
We re-implement wait -k model , test - time wait -k model ( Dalvi et al. , 2018 ) and adaptive policy ( Gu et al. , 2017 ) based on PyTorch - based OpenNMT ( Klein et al. , 2017 ) .
To reach state - of- the - art performance , we use Transformer based wait -k model and also use Transformer based pre-trained full sentence model for learning adaptive policy .
The architecture of Transformer is the same as the base model from the original paper ( Vaswani et al. , 2017 ) .
We use Average Lagging ( AL ) as the latency metrics .
AL measures the number of words delay for translating a given source sentence .
: conventional beam search in chunk of consecutive write ( Gu et al. , 2017 ) . : speculative beam search .
$ :full-sentence baseline ( greedy and beam-search ) .
Performance on Wait-k Policy
We perform experiments on validation set using speculative beam search ( SBS ) with beam sizes b ? { 3 , 5 , 7 , 10 } and speculative window sizes w ? { 1 , 2 , 3 , 4 , 5 } .
Table 2 shows the BLEU score of different b and w over wait - 1 model .
Compared with greedy decoding , SBS improves at least 1.0 BLEU score in all cases and achieves best performance by b = 10 , w = 2 .
We search the best b and w for each model on dev-set and apply them on test-set in the following experiments .
Fig. 3 shows the performance of conventional greedy decoding , trivial tail beam search ( only after source sentence is finished ) and SBS on test set on Chinese ?
English tasks .
SBS largely boost test-time wait -k models with slightly worse latency ( especially in English ?
Chinese because they tend to generate longer sentences ) .
Wait -k models also benefit from speculation ( especially in Chinese ?
English ) .
Fig. 5 shows a running example of greedy and SBS output of both wait -k and test -time waitk models .
SBS on test-time wait -k generates much better outputs than the greedy search , which misses some essential information .
Wait -k models with speculation correctly translates " ? " into " intends to " instead of " to " in greedy output .
Performance on Adaptive Policy Fig. 4 shows the performance of proposed SBS on adaptive policies .
We train adaptive policies using the combination of Consecutive Wait ( CW ? { 2 , 5 , 8 } ( Gu et al. , 2017 ) ) and partial - BLEU as reward in reinforcement learning .
We vary beam size b ? { 5 , 10 } in both chunk - based beam search ( Gu et al. , 2017 ) and our SBS with speculative window size w ? { 2 , 4 } . Our proposed beam search achieves better results in most cases .
Running Time Analysis Fig. 6 shows the average time for generating words with different target word indices on a GeForce GTX TITAN -X GPU and an Intel Core i7 2.8 GHz CPU .
According to , wait -k models use bi-directional Transformer as the encoder , thus the time complexity of incrementally encoding one more source word is O ( m 2 ) where m is the source sentence length .
This is the reason why it takes more time to encode words with larger index especially using CPU .
It is generally accepted that Mandarin speech is about 120 - 150 syllables per minute , and in our corpus each token ( after BPE ) has on average 1.5 Chinese syllables ( which is 1.5 characters since each Chinese character is monosyllabic ) , thus in the simultaneous Chineseto - English speech - to - text translation scenario , the decoder receives a source token every 0.6-0.75 seconds which is much slower than our decoding speed ( less than 0.25 seconds per token ) even on a laptop CPU .
Based on these statistics , our proposed speculative beam search algorithm can be used in real simultaneous translation .
Performance on Full Sentence MT
We analyze the performance of speculative beam search on full-sentence translation ( see Fig. 7 ) .
By only performing beam search on a sliding speculative window , the proposed algorithm achieves much better BLEU scores compared with greedy decoding ( w = 0 ) and even outperforms conventional beam search when w = 9 , b = 3 .
Please note that the space complexity of this algorithm is O ( ( m + n + wb ) d ) .
1
This is better than conventional beam search whose space complexity is O ( ( m + nb ) d ) when w n.
Conclusions and Future Work
We have proposed speculative beam search for simultaneous translation .
Experiments on three approaches to simultaneous translation demonstrate effectiveness of our method .
This algorithm has the potential in other incremental tasks such as streaming ASR and incremental TTS .
A Supplemental Material
We also evaluate our work using Consecutive Wait ( CW ) as latency metric , which measures the average lengths of consecutive wait segments , and perform experiments on German ?
English corpora available from WMT15 3 .
We use newstest - 2013 as dev-set and newstest - 2015 as test-set .
4 Fig. 8 show the translation quality on German ?
English against AL of different decoding methods .
Consistent to the results of Chinese ?
English , our proposed speculative beam search gain large performance boost especially on test- time wait -k. : conventional beam search only on target tail .
: speculative beam search .
$ :full-sentence ( greedy and beam-search ) .
3 http://www.statmt.org/wmt15/translation-task.html
4
The German ?
English results are slightly different from those in because of different decoding settings .
We do not allow that the decoder stops earlier than the finish of source sentence while it is allowed in German ?
English experiments of .
This makes our generated sentences longer and further results in worse AL compared with the results in . next b 1 ( B ) = top b { y? v , s?p( v|x , y ) | y , s ?
B} where top b ( ? ) returns the top-scoring b pairs , and ? is the string concatenation operator .
Now B t = next b
e 1 7 b m y C D C l D M S N 5 b Z B oE i M 8 R W P i W y o Q J z r I Z i f n 8 M w q I x h J Z U s Y O F P / T m S I a 5 3 y 0 H Z y Z C Z 6 2 S v E / z w / M d F 1 k F E R J 4 Y I P F 8 U J Q w a C Y v / 4 Y g q g g 1 L L U F Y U X s r x B O k E D Y 2 p Y U t I S 8 y 8 Z Y T W C X d i 6 b n N r 2 H y 0 b r t k y n C k 7 A K T g H H r g C L X A P 2 q A D M J D g B b y C N + f Z e X c+ n M 9 5 a 8 U p Z 4 7 B A p y v X 6 Q 5 m C E = < / l a t e x i t >
6 j y T L 4 e x / + T 8 5I f E D 8 4 L R c P D o f p T K E 1 t I 4 2 U Y A q 6 A A d o x N U Q w z d o n v 0 g B 6 9 O + / J e / Z e P l t H v O H M C v o B 7 / U D a A q e c A = = < / l a t e x i t > ?t : t+n 1 < l a t e x i t s h a 1 _ b a s e 6 4 = " k R r S T 2 g f x X 3 p F j X O G 0 a E q q c P C d I = " > A A A C F n i c d V B N S y s x F M 3 4 8 a x f z z 5 d C h I s g i A O G W 2 1 1 Y 3 o x q W C V a F T S i Z N b T D J D M m d B 2 W Y 3 f s R 7 ze 4 1 b U 7 c e v W p f / E T K 2 g o g c S D u f c y 7 3 3 R I k U F g h 5 9 s b G J y Z / T Z W m Z 2 b n 5 n 8 v l P 8 s n t s 4 N Y w 3 W S x j c x l R y 6
z x L 6 B O / p F c 7 8 n w g = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " k R r S T 2 g f x X 3 p F j X O G 0 a E q q c P Cd I = " > A A A C F n i c d V B N S y s x F M 3 4 8 a x f z z 5 d C h I s g i A O G W 2 1 1 Y 3 o x q W C V a F T S i Z N b T D J D M m d B 2 W Y 3 f s R 7 ze 4 1 b U 7 c e v W p f / E T K 2 g o g c S D u f c y 7 3 3 R I k U F g h 5 9 s b G J y Z / T Z W m Z 2 b n 5 n 8 v l P 8 s n t s 4 N Y w 3 W S x j c x l R y 6
z x L 6 B O / p F c 7 8 n w g = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " k R r S T 2 g f x X 3 p F j X O G 0 a E q q c P Cd I = " > A A A C F n i c d V B N S y s x F M 3 4 8 a x f z z 5 d C h I s g i A O G W 2 1 1 Y 3 o x q W C V a F T S i Z N b T D J D M m d B 2 W Y 3 f s R 7 ze 4 1 b U 7 c e v W p f / E T K 2 g o g c S D u f c y 7 3 3 R I k U F g h 5 9 s b G J y Z / T Z W m Z 2 b n 5 n 8 v l P 8 s n t s 4 N Y w 3 W S x j c x l R y 6
z x L 6 B O / p F c 7 8 n w g = < / l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " k R r S T 2 g f x X 3 p F j X O G 0 a E q q c P Cd I = " > A A A C F n i c d V B N S y s x F M 3 4 8 a x f z z 5 d C h I s g i A O G W 2 1 1 Y 3 o x q W C V a F T S i Z N b T D J D M m d B 2 W Y 3 f s R 7 ze 4 1 b U 7 c e v W p f / E T K 2 g o g c S D u f c y 7 3 3 R I k U F g h 5 9 s b G J y Z / T Z W m Z 2 b n 5 n 8 v l P 8 s n t s 4 N Y w 3 W S x j c x l R y 6
z x L 6 B O / p F c 7 8 n w g = < / l a t e x i t > ?t+ n : t+ n + w 1 < l a t e x i t s h a 1 _ b a s e 6 4 = " s 2S 1 x F t p l M g M m o + U l A T 1 a T E d 9 R 4 = " > A A A C G n i c d V B N b x M x E P W W A i E U m s K R i 5 U I q V L E y p t E J I F L R C 8 c U 6 n 5 k L J R 5 H W c x K r t X d m z R d F q 7 / w I f g N X O H N D v f b S I / + k 3 i R I B L V P s v X 0 3 o x m 5 k W J F B Y I u f U O H h 0 + f v K 0 9 K z 8 / O j F y + P K y a u h j V P D + I D F M j b j i F o u h e Y D E C D 5 O D G c q k j y U X R 5 V v i j K 2 6 s i P U F r B M + V X S p x U I w C k 6 a V a r h i k I W R ip b 5 / k s g 7 r G 4 U f 8 o f g c r 3 9 5 F + S z S o 3 4 7 U a n 1 W 1 i 4 p P 3 3 V a L F K T Z b r Q 7 O P D J B j W 0 Q 3 9 W + R P O Y 5 Y q r o F J a u 0 k I A l M M 2 p A M M n z c p h a n l B 2 S Z d 8 4
8 / O j F y + P K y a u h j V P D + I D F M j b j i F o u h e Y D E C D 5 O D G c q k j y U X R 5 V v i j K 2 6 s i P U F r B M + V X S p x U I w C k 6 a V a r h i k I W R i p b 5 / k s g 7 r G 4 U f 8 o f g c r 3 9 5 F + S z S o 3 4 7 U a n 1 W 1 i 4 p P 3 3 V a L F K T Z b r Q 7 O P D J B j W 0 Q 3 9 W + R P O Y 5 Y q r o F J a u 0 k I A l M M 2 p A M M n z c p h a n l B 2 S Z d 8 4
8 / O j F y + P K y a u h j V P D + I D F M j b j i F o u h e Y D E C D 5 O D G c q k j y U X R 5 V v i j K 2 6 s i P U F r B M + V X S p x U I w C k 6 a V a r h i k I W R i p b 5 / k s g 7 r G 4 U f 8 o f g c r 3 9 5 F + S z S o 3 4 7 U a n 1 W 1 i 4 p P 3 3 V a L F K T Z b r Q 7 O P D J B j W 0 Q 3 9 W + R P O Y 5 Y q r o F J a u 0 k I A l M M 2 p A M M n z c p h a n l B 2 S Z d 8 4
8 / O j F y + P K y a u h j V P D + I D F M j b j i F o u h e Y D E C D 5 O D G c q k j y U X R 5 V v i j K 2 6 s i P U F r B M + V X S p x U I w C k 6 a V a r h i k I W R i p b 5 / k s g 7 r G 4 U f 8 o f g c r 3 9 5 F + S z S o 3 4 7 U a n 1 W 1 i 4 p P 3 3 V a L F K T Z b r Q 7 O P D J B j W 0 Q 3 9 W + R P O Y 5 Y q r o F J a u 0 k I A l M M 2 p A M M n z c p h a n l B 2 S Z d 8 4 q i m i t t p t r k l x 2 + d M s e L 2 L i n A W / U f z s y q q x d q 8 h V K g o r + 7 9 X i P d 5 k x Q W n W k m d J I C 1 2 w 7 a J F K D D E u g s F z Y T g D u X a E M i P c r p i t q K E M X H x 7 U y J V Z P L 3 c P w w G T b 8 g P j B e a v W + 7 R L p 4 T e o C o 6 R Q F q o x 7 6 j P p o g B j 6 i r 6 j H + i n 9 8 3 7 5 f 3 2 r r e l B 9 6 u 5 z X a g 3 d z B 4 V Z o G 4 = < / l a t e x i t >w < l a t e x i t s h a 1 _ b a s e 6 4 = " o c O 9 K N m d P O U H A 5 9 n c G 4 u O Z R A B n I = " > A A A B 9 3 i c d V D L S s N A F J 3 U V 6 2 v q k s 3 g 0 V w F S Z t M O 2 u 6 M Z l C / Y B b S i T 6 a Q d O n k w M 1 F C 6 B e 4 1 b U 7 c e v n u P R P n L Q V r O i B C 4 d z 7 u X e e 7 y Y M 6 k Q + j A K G 5 t b 2 z v F 3 d L e / s H h U f n 4 p C u j R B D a I R G P R N / D k n I W 0 o 5 i i t N + L C g O P E 5 7 3 u w m 9 3
l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " o c O 9 K N m d P O U H A 5 9 n c G 4 u O Z R A B n I = " > A A A B 9 3 i c d V D L S s N A F J 3 U V 6 2 v q k s 3 g 0 V w F S Z t M O 2 u 6 M Z l C / Y B b S i T 6 a Q d O n k w M 1 F C 6 Be 4 1 b U 7 c e v n u P R P n L Q V r O i B C 4 d z 7 u X e e 7 y Y M 6 k Q + j A K G 5 t b 2 z v F 3 d L e / s H h U f n 4 p C u j R B D a I R G P R N / D k n I W 0 o 5 i i t N + L C g O P E 5 7 3 u w m 9 3
l a t e x i t > < l a t e x i t s h a 1 _ b a s e 6 4 = " o c O 9 K N m d P O U H A 5 9 n c G 4 u O Z R A B n I = " > A A A B 9 3 i c d V D L S s N A F J 3 U V 6 2 v q k s 3 g 0 V w F S Z t M O 2 u 6 M Z l C / Y B b S i T 6 a Q d O n k w M 1 F C 6 Be 4 1 b U 7 c e v n u P R P n L Q V r O i B C 4 d z 7 u X e e 7 y Y M 6 k Q + j A K G 5 t b 2 z v F 3 d L e / s H h U f n 4 p C u j R B D a I R G P R N / D k n I W 0 o 5 i i t N + L C g O P E 5 7 3 u w m 9 3 v 3 V E g W h X c q j a k b 4 E n I f E a w 0 l L 7 Y V S u I N O p 1 u 1 G D S I T X T V s G + W k 5 l S d O r R M t E A F r N A a l T + H 4 4 g k A
Figure 2 : 2 Figure 2 : Illustration of SBS : ( a ) wait -k policy ( Eqs. 4- 5 ) ; ( b ) adaptive policy ( Eqs. 6 - 7 ) .
Speculations in red .
Figure 3 : 3 Figure 3 : BLEU against AL using wait -k model. : conventional beam search only in target tail ( when source finishes ) . : speculative beam search .
$ :full-sentence baseline ( greedy and beam-search ) .
Figure 4 : 4 Figure 4 : BLEU against AL using adaptive policy ( compared with wait -k models ) with different beam search methods . : conventional beam search in chunk of consecutive write ( Gu et al. , 2017 ) . : speculative beam search .
$ :full-sentence baseline ( greedy and beam-search ) .
Figure 5 : 5 Figure 5 : Chinese-to- English example on dev set . ? : test- time wait -k ; ? : wait -k. * : full-sentence beam search .
Figure 6 : 6 Figure 6 : Average time of words with different indices ( ? 50 ) on zh?en wait - 3 model .
Results in left figure are measured on GPU while results in right figure results are measured on CPU .
The SBS results adopt w = 2 , b = 5 .
Figure 7 : 7 Figure 7 : BLEU of SBS over full sentence translation with different window sizes w and beam sizes b. Window size w = 0 stands for greedy decoding .
The top line stands for results using normal beam search .
Fig. 9 and Fig. 10 use CW as latency metrics .
Since both the wait -k and test -time wait -k models use the same fixed policy , the CW latencies of the same k are identical .
Figure 8 : 8 Figure 8 :Translation quality against AL on English ?
German simultaneous translation using waitk model. : conventional beam search only on target tail . : speculative beam search .
$ :full-sentence ( greedy and beam-search ) .
Figure 10 : 10 Figure 9 :Translation quality against CW on Chinese ?
English simultaneous translation using waitk model .
Here n is the length of target sentence and d is the representation dimension .
2 https://github.com/SimulTrans-demo/STACL
