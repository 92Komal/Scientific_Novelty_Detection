title
Semi-Supervised Learning for Neural Machine Translation
abstract
While end-to - end neural machine translation ( NMT ) has made remarkable progress recently , NMT systems only rely on parallel corpora for parameter estimation .
Since parallel corpora are usually limited in quantity , quality , and coverage , especially for low-resource languages , it is appealing to exploit monolingual corpora to improve NMT .
We propose a semisupervised approach for training NMT models on the concatenation of labeled ( parallel corpora ) and unlabeled ( monolingual corpora ) data .
The central idea is to reconstruct the monolingual corpora using an autoencoder , in which the sourceto-target and target - to -source translation models serve as the encoder and decoder , respectively .
Our approach can not only exploit the monolingual corpora of the target language , but also of the source language .
Experiments on the Chinese- English dataset show that our approach achieves significant improvements over state - of- the - art SMT and NMT systems .
Introduction End-to- end neural machine translation ( NMT ) , which leverages a single , large neural network to directly transform a source - language sentence into a target - language sentence , has attracted increasing attention in recent several years ( Kalchbrenner and Blunsom , 2013 ; Sutskever et al. , 2014 ; Bahdanau et al. , 2015 ) .
Free of latent structure design and feature engineering that are critical in conventional statistical machine translation ( SMT ) ( Brown et al. , 1993 ; Koehn et al. , 2003 ; Chiang , 2005 ) , NMT has proven to excel in model - * Yang Liu is the corresponding author .
ing long-distance dependencies by enhancing recurrent neural networks ( RNNs ) with the gating ( Hochreiter and Schmidhuber , 1993 ; Cho et al. , 2014 ; Sutskever et al. , 2014 ) and attention mechanisms ( Bahdanau et al. , 2015 ) .
However , most existing NMT approaches suffer from a major drawback : they heavily rely on parallel corpora for training translation models .
This is because NMT directly models the probability of a target - language sentence given a source - language sentence and does not have a separate language model like SMT ( Kalchbrenner and Blunsom , 2013 ; Sutskever et al. , 2014 ; Bahdanau et al. , 2015 ) .
Unfortunately , parallel corpora are usually only available for a handful of researchrich languages and restricted to limited domains such as government documents and news reports .
In contrast , SMT is capable of exploiting abundant target -side monolingual corpora to boost fluency of translations .
Therefore , the unavailability of large-scale , high-quality , and wide - coverage parallel corpora hinders the applicability of NMT .
As a result , several authors have tried to use abundant monolingual corpora to improve NMT .
Gulccehre et al. ( 2015 ) propose two methods , which are referred to as shallow fusion and deep fusion , to integrate a language model into NMT .
The basic idea is to use the language model to score the candidate words proposed by the translation model at each time step or concatenating the hidden states of the language model and the decoder .
Although their approach leads to significant improvements , one possible downside is that the network architecture has to be modified to integrate the language model .
Alternatively , Sennrich et al. ( 2015 ) propose two approaches to exploiting monolingual corpora that is transparent to network architectures .
The first approach pairs monolingual sentences with dummy input .
Then , the parameters of encoder ? ? ? ) reconstructs a copy of the observed source sentence x from the latent target sentence .
As a result , monolingual corpora can be combined with parallel corpora to train bidirectional NMT models in a semi-supervised setting .
and attention model are fixed when training on these pseudo parallel sentence pairs .
In the second approach , they first train a nerual translation model on the parallel corpus and then use the learned model to translate a monolingual corpus .
The monolingual corpus and its translations constitute an additional pseudo parallel corpus .
Similar ideas have also been suggested in conventional SMT ( Ueffing et al. , 2007 ; Bertoldi and Federico , 2009 ) .
Sennrich et al. ( 2015 ) report that their approach significantly improves translation quality across a variety of language pairs .
In this paper , we propose semi-supervised learning for neural machine translation .
Given labeled ( i.e. , parallel corpora ) and unlabeled ( i.e. , monolingual corpora ) data , our approach jointly trains source - to- target and target - to -source translation models .
The key idea is to append a reconstruction term to the training objective , which aims to reconstruct the observed monolingual corpora using an autoencoder .
In the autoencoder , the source- to- target and target - to - source models serve as the encoder and decoder , respectively .
As the inference is intractable , we propose to sample the full search space to improve the efficiency .
Specifically , our approach has the following advantages :
1 . Transparent to network architectures : our approach does not depend on specific architectures and can be easily applied to arbitrary end-to - end NMT systems .
2 . Both the source and target monolingual corpora can be used : our approach can benefit NMT not only using target monolingual corpora in a conventional way , but also the monolingual corpora of the source language .
Experiments on Chinese-English NIST datasets show that our approach results in significant improvements in both directions over state - of- the - art SMT and NMT systems .
2 Semi-Supervised Learning for Neural Machine Translation
Supervised Learning Given a parallel corpus D = { x ( n ) , y ( n ) } N n=1 , the standard training objective in NMT is to maximize the likelihood of the training data : L ( ? ) = N n=1 log P ( y ( n ) | x ( n ) ; ? ) , ( 1 ) where P ( y|x ; ? ) is a neural translation model and ? is a set of model parameters .
D can be seen as labeled data for the task of predicting a target sentence y given a source sentence x .
As P ( y|x ; ? ) is modeled by a single , large neural network , there does not exist a separate target language model P ( y ; ? ) in NMT .
Therefore , parallel corpora have been the only resource for parameter estimation in most existing NMT systems .
Unfortunately , even for a handful of resource- rich languages , the available domains are unbalanced and restricted to government documents and news reports .
Therefore , the availability of large-scale , high- quality , and wide - coverage parallel corpora becomes a major obstacle for NMT .
Autoencoders on Monolingual Corpora
It is appealing to explore the more readily available , abundant monolingual corpora to improve NMT .
Let us first consider an unsupervised setting : how to train NMT models on a monolingual corpus T = {y ( t ) } T t=1 ?
Our idea is to leverage autoencoders ( Vincent et al. , 2010 ; Socher et al. , 2011 ) : ( 1 ) encoding an observed target sentence into a latent source sentence using a target - to -source translation model and ( 2 ) decoding the source sentence to reconstruct the observed target sentence using a source - to- target model .
For example , as shown in Figure 1 ( b ) , given an observed English sentence " Bush held a talk with Sharon " , a target - to -source translation model ( i.e. , encoder ) transforms it into a Chinese translation " bushi yu shalong juxing le huitan " that is unobserved on the training data ( highlighted in grey ) .
Then , a source- to- target translation model ( i.e. , decoder ) reconstructs the observed English sentence from the Chinese translation .
More formally , let P ( y|x ; ? ? ? ) and P ( x|y ; ? ? ? ) be source- to- target and target - to -source translation models respectively , where ? ? ? and ? ? ? are corresponding model parameters .
An autoencoder aims to reconstruct the observed target sentence via a latent source sentence : P ( y |y ; ? ? ? , ? ? ? ) = x P (y , x|y ; ? ? ? , ? ? ? ) = x P ( x|y ; ? ? ? ) encoder P ( y |x ; ? ? ? ) decoder , ( 2 ) where y is an observed target sentence , y is a copy of y to be reconstructed , and x is a latent source sentence .
We refer to Eq. ( 2 ) as a target autoencoder .
1 Likewise , given a monolingual corpus of source language S = { x ( s ) } S s=1 , it is natural to introduce a source autoencoder that aims at reconstructing 1 Our definition of auotoencoders is inspired by Ammar et al . ( 2014 ) .
Note that our autoencoders inherit the same spirit from conventional autoencoders ( Vincent et al. , 2010 ; Socher et al. , 2011 ) except that the hidden layer is denoted by a latent sentence instead of real-valued vectors .
the observed source sentence via a latent target sentence : P ( x |x ; ? ? ? , ? ? ? ) = y P ( x , y|x ; ? ? ? ) = y P ( y|x ; ? ? ? ) encoder P ( x |y ; ? ? ? ) decoder .
( 3 ) Please see Figure 1 ( a ) for illustration .
Semi-Supervised Learning
As the autoencoders involve both source- to- target and target - to - source models , it is natural to combine parallel corpora and monolingual corpora to learn birectional NMT translation models in a semi-supervised setting .
Formally , given a parallel corpus D = { x ( n ) , y ( n ) } N n=1 , a monolingual corpus of target language T = {y ( t ) } T t=1 , and a monolingual corpus of source language S = { x ( s ) } S s=1 , we introduce our new semi-supervised training objective as follows : J ( ? ? ? , ? ? ? ) = N n=1 log P ( y ( n ) |x ( n ) ; ? ? ? ) source- to- target likelihood + N n=1 log P ( x ( n ) |y ( n ) ; ? ? ? ) target- to-source likelihood +?
1 T t=1 log P ( y |y ( t ) ; ? ? ? , ? ? ? ) target autoencoder +?
2 S s=1 log P ( x |x ( s ) ; ? ? ? , ? ? ? ) source autoencoder , ( 4 ) where ?
1 and ?
2 are hyper-parameters for balancing the preference between likelihood and autoencoders .
Note that the objective consists of four parts : source - to- target likelihood , target - to - source likelihood , target autoencoder , and source autoencoder .
In this way , our approach is capable of exploiting abundant monolingual corpora of both source and target languages .
The optimal model parameters are given by ? ? ? * = argmax N n=1 log P ( y ( n ) |x ( n ) ; ? ? ? ) + ?
1 T t=1 log P ( y |y ( t ) ; ? ? ? , ? ? ? ) + ?
2 S s=1 log P ( x |x ( s ) ; ? ? ? , ? ? ? ) ( 5 ) ? ? ? * = argmax N n=1 log P ( x ( n ) |y ( n ) ; ? ? ? ) + ?
1 T t=1 log P ( y |y ( t ) ; ? ? ? , ? ? ? ) + ?
2 S s=1 log P ( x |x ( s ) ; ? ? ? , ? ? ? ) ( 6 ) It is clear that the source - to- target and target - tosource models are connected via the autoencoder and can hopefully benefit each other in joint training .
Training
We use mini-batch stochastic gradient descent to train our joint model .
For each iteration , besides the mini-batch from the parallel corpus , we also construct two additional mini-batches by randomly selecting sentences from the source and target monolingual corpora .
Then , gradients are collected from these mini-batches to update model parameters .
The partial derivative of J ( ? ? ? , ? ? ? ) with respect to the source- to- target model ? ? ? is given by ?J ( ? ? ? , ? ? ? ) ? ? ? ? = N n=1 ? log P ( y ( n ) |x ( n ) ; ? ? ? ) ? ? ? ? +?
1 T t=1 ? log P ( y |y ( t ) ; ? ? ? , ? ? ? ) ? ? ? ? +?
2 S s=1 ? log P ( x |x ( s ) ; ? ? ? , ? ? ? ) ? ? ? ? . ( 7 ) The partial derivative with respect to ? ? ? can be calculated similarly .
Unfortunately , the second and third terms in Eq. ( 7 ) are intractable to calculate due to the exponential search space .
For example , the derivative in the third term in Eq. ( 7 ) is given by x?X ( y ) P ( x|y ; ? ? ? ) P ( y |x ; ? ? ? ) ? log P ( y |x ; ? ? ? ) ? ? ? ? x?X ( y ) P ( x|y ; ? ? ? ) P ( y |x ; ? ? ? ) . ( 8 ) It is prohibitively expensive to compute the sums due to the exponential search space of X ( y ) .
Alternatively , we propose to use a subset of the full space X ( y ) ? X ( y ) to approximate Eq. ( 8 ) : x? X ( y ) P ( x|y ; ? ? ? ) P ( y |x ; ? ? ? ) ? log P ( y |x ; ? ? ? ) ? ? ? ? x? X ( y ) P ( x|y ; ? ? ? ) P ( y |x ; ? ? ? ) . ( 9 ) In practice , we use the top-k list of candidate translations of y as X ( y ) .
As | X ( y ) | X |( y ) | , it is possible to calculate Eq. ( 9 ) efficiently by enumerating all candidates in X ( y ) .
In practice , we find this approximation results in significant improvements and k = 10 seems to suffice to keep the balance between efficiency and translation quality .
Experiments
Setup
We evaluated our approach on the Chinese-English dataset .
As shown in Table 1 , we use both a parallel corpus and two monolingual corpora as the training set .
The parallel corpus from LDC consists of 2.56 M sentence pairs with 67.53 M
Chinese words and 74.81 M English words .
The vocabulary sizes of Chinese and English are 0.21 M and 0.16 M , respectively .
We use the Chinese and English parts of the Xinhua portion of the GIGAWORD corpus as the monolingual corpora .
The Chinese monolingual corpus contains 18.75 M sentences with 451.94 M words .
The English corpus contains 22.32 M sentences with 399.83 M words .
The vocabulary sizes of Chinese and English are 0.97 M and 1.34 M , respectively .
For Chinese- to- English translation , we use the NIST 2006 Chinese - English dataset as the validation set for hyper-parameter optimization and model selection .
The NIST 2002 , 2003 , 2004 , and 2005 datasets serve as test sets .
Each Chinese sentence has four reference translations .
For English - to - Chinese translation , we use the NIST datasets in a reverse direction : treating the first English sentence in the four reference translations as a source sentence and the original input Chinese sentence as the single reference translation .
The evaluation metric is case-insensitive BLEU ( Papineni et al. , 2002 ) as calculated by the multi-bleu. perl script .
We compared our approach with two state- ofthe - art SMT and NMT systems : 1 . MOSES ( Koehn et al. , 2007 ) : a phrase - based SMT system ; 2 . RNNSEARCH ( Bahdanau et al. , 2015 ) : an attention - based NMT system .
For MOSES , we use the default setting to train the phrase - based translation on the parallel corpus and optimize the parameters of log-linear models using the minimum error rate training algorithm ( Och , 2003 ) .
We use the SRILM toolkit ( Stolcke , 2002 ) to train 4 - gram language models .
For RNNSEARCH , we use the parallel corpus to train the attention - based neural translation models .
We set the vocabulary size of word embeddings to 30 K for both Chinese and English .
We follow Luong et al . ( 2015 ) to address rare words .
On top of RNNSEARCH , our approach is capable of training bidirectional attention - based neural translation models on the concatenation of parallel and monolingual corpora .
The sample size k is set to 10 .
We set the hyper-parameter ?
1 = 0.1 and ?
2 = 0 when we add the target monolingual corpus , and ?
1 = 0 and ?
2 = 0.1 for source monolingual corpus incorporation .
The threshold of gradient clipping is set to 0.05 .
The parameters of our model are initialized by the model trained on parallel corpus .
Effect of Sample Size k
As the inference of our approach is intractable , we propose to approximate the full search space with the top-k list of candidate translations to improve efficiency ( see Eq. ( 9 ) ) .
Figure 2 shows the BLEU scores of various settings of k over time .
Only the English monolingual corpus is appended to the training data .
We observe that increasing the size of the approximate search space generally leads to improved BLEU scores .
There are significant gaps between k = 1 and k = 5 .
However , keeping increasing k does not result in significant improvements and decreases the training efficiency .
We find that k = 10 achieves a balance between training efficiency and translation quality .
As shown in Figure 3 , similar findings are also observed on the English - to - Chinese validation set .
Therefore , we set k = 10 in the following experiments .
Effect of OOV Ratio Given a parallel corpus , what kind of monolingual corpus is most beneficial for improving translation quality ?
To answer this question , we investigate the effect of OOV ratio on translation quality , which is defined as ratio = y?y y / ? V Dt |y | , ( 10 ) where y is a target - language sentence in the monolingual corpus T , y is a target - language word in y , V Dt is the vocabulary of the target side of the parallel corpus D. Intuitively , the OOV ratio indicates how a sentence in the monolingual resembles the parallel corpus .
If the ratio is 0 , all words in the monolingual sentence also occur in the parallel corpus .
Figure 4 shows the effect of OOV ratio on the Chinese-to - English validation set .
Only English monolingual corpus is appended to the parallel corpus during training .
We constructed four monolingual corpora of the same size in terms of sentence pairs .
" 0 % OOV " means the OOV ratio is 0 % for all sentences in the monolingual corpus .
" 10 % OOV " suggests that the OOV ratio is no greater 10 % for each sentence in the monolingual corpus .
We find that using a monolingual corpus with a lower OOV ratio generally leads to higher BLEU scores .
One possible reason is that low -OOV monolingual corpus is relatively easier to reconstruct than its high - OOV counterpart and results in better estimation of model parameters .
Figure 5 shows the effect of OOV ratio on the English - to - Chinese validation set .
Only English monolingual corpus is appended to the parallel corpus during training .
We find that " 0 % OOV " still achieves the highest BLEU scores .
Comparison with SMT
Table 2 shows the comparison between MOSES and our work .
MOSES used the monolingual corpora as shown in Table 1 : 18.75 M
Chinese sentences and 22.32 M English sentences .
We find that exploiting monolingual corpora dramatically improves translation performance in both Chinese-to-English and English - to - Chinese directions .
Relying only on parallel corpus , RNNSEARCH outperforms MOSES trained also only on parallel corpus .
But the capability of making use of abundant monolingual corpora enables MOSES to achieve much higher BLEU scores than RNNSEARCH only using parallel corpus .
Instead of using all sentences in the monolingual corpora , we constructed smaller monolingual corpora with zero OOV ratio : 2.56 M
Chinese sentences with 47.51 M words and 2.56 M English English sentences with 37.47 M words .
In other words , the monolingual corpora we used in the experiments are much smaller than those used by MOSES .
By adding English monolingual corpus , our approach achieves substantial improvements over RNNSEARCH using only parallel corpus ( up to + 4.7 BLEU points ) .
In addition , significant improvements are also obtained over MOSES using both parallel and monolingual corpora ( up to + 3.5 BLEU points ) .
An interesting finding is that adding English monolingual corpora helps to improve English - to - Chinese translation over RNNSEARCH using only parallel corpus ( up to + 3.2 BLEU points ) , suggesting that our approach is capable of improving NMT using source -side monolingual corpora .
In the English- to - Chinese direction , we obtain similar findings .
In particular , adding Chi- ( Koehn et al. , 2007 ) . RNNSEARCH is an attention - based neural machine translation system ( Bahdanau et al. , 2015 ) . " CE " donates Chinese - English parallel corpus , " C " donates Chinese monolingual corpus , and " E " donates English monolingual corpus .
" ? " means the corpus is included in the training data and ? means not included .
" NIST06 " is the validation set and " NIST02 - 05 " are test sets .
The BLEU scores are case-insensitive . " * " : significantly better than MOSES ( p < 0.05 ) ; " * * " : significantly better than MOSES ( p < 0.01 ) ; " + " : significantly better than RNNSEARCH ( p < 0.05 ) ; " + + " : significantly better than RNNSEARCH ( p < 0.01 ) .
nese monolingual corpus leads to more benefits to English - to - Chinese translation than adding English monolingual corpus .
We also tried to use both Chinese and English monolingual corpora through simply setting all the ? to 0.1 but failed to obtain further significant improvements .
Therefore , our findings can be summarized as follows :
1 . Adding target monolingual corpus improves over using only parallel corpus for source-totarget translation ; 2 . Adding source monolingual corpus also improves over using only parallel corpus for source - to - target translation , but the improvements are smaller than adding target monolingual corpus ;
3 . Adding both source and target monolingual corpora does not lead to further significant improvements .
Comparison with Previous Work We re-implemented Sennrich et al. ( 2015 ) 's method on top of RNNSEARCH as follows : 1 . Train the target- to- source neural translation model P ( x|y ; ? ? ? ) on the parallel corpus D = { x ( n ) , y ( n ) } N n=1 . 2 .
The trained target- to- source model ? ? ? * is used to translate a target monolingual corpus T = {y ( t ) } T t=1 into a source monolingual corpus S = { x ( t ) } T t=1 . 3 . The target monolingual corpus is paired with its translations to form a pseudo parallel corpus , which is then appended to the original parallel corpus to obtain a larger parallel corpus : D = D ? S , T .
We find our approach is capable of generating better translations of the monolingual corpus over time .
Table 3 shows the comparison results .
Both the two approaches use the same parallel and monolingual corpora .
Our approach achieves significant improvements over Sennrich et al . ( 2015 ) in both Chinese-to-English and English - to - Chinese directions ( up to + 1.8 and + 1.0 BLEU points ) .
One possible reason is that Sennrich et al . ( 2015 ) only use the pesudo parallel corpus for parameter estimation for once ( see Step 4 above ) while our approach enables source - to-target and targetto-source models to interact with each other iteratively on both parallel and monolingual corpora .
To some extent , our approach can be seen as an iterative extension of Sennrich et al . ( 2015 ) 's approach : after estimating model parameters on the pseudo parallel corpus , the learned model parameters are used to produce a better pseudo parallel corpus .
Table 4 shows example Viterbi translations on the Chinese monolingual corpus over iterations : x * = argmax x P ( y |x ; ? ? ? ) P ( x|y ; ? ? ? ) . ( 11 ) We observe that the quality of Viterbi translations generally improves over time .
Related Work
Our work is inspired by two lines of research : ( 1 ) exploiting monolingual corpora for machine translation and ( 2 ) autoencoders in unsupervised and semi-supervised learning .
Exploiting Monolingual Corpora for Machine Translation Exploiting monolingual corpora for conventional SMT has attracted intensive attention in recent years .
Several authors have introduced transductive learning to make full use of monolingual corpora ( Ueffing et al. , 2007 ; Bertoldi and Federico , 2009 ) .
They use an existing translation model to translate unseen source text , which can be paired with its translations to form a pseudo parallel corpus .
This process iterates until convergence .
While Klementiev et al. ( 2012 ) propose an approach to estimating phrase translation probabilities from monolingual corpora , Zhang and Zong ( 2013 ) directly extract parallel phrases from monolingual corpora using retrieval techniques .
Another important line of research is to treat translation on monolingual corpora as a decipherment problem ( Ravi and Knight , 2011 ; Dou et al. , 2014 ) . Closely related to Gulccehre et al . ( 2015 ) and Sennrich et al . ( 2015 ) , our approach focuses on learning birectional NMT models via autoencoders on monolingual corpora .
The major advantages of our approach are the transparency to network architectures and the capability to exploit both source and target monolingual corpora .
Autoencoders in Unsupervised and Semi-Supervised Learning Autoencoders and their variants have been widely used in unsupervised deep learning ( ( Vincent et al. , 2010 ; Socher et al. , 2011 ; Ammar et al. , 2014 ) , just to name a few ) .
Among them , Socher et al . ( 2011 ) 's approach bears close resemblance to our approach as they introduce semi-supervised recursive autoencoders for sentiment analysis .
The difference is that we are interested in making a better use of parallel and monolingual corpora while they concentrate on injecting partial supervision to conventional unsupervised autoencoders .
Dai and Le ( 2015 ) introduce a sequence autoencoder to reconstruct an observed sequence via RNNs .
Our approach differs from sequence autoencoders in that we use bidirectional translation models as encoders and decoders to enable them to interact within the autoencoders .
Conclusion
We have presented a semi-supervised approach to training bidirectional neural machine translation models .
The central idea is to introduce autoencoders on the monolingual corpora with source-totarget and target - to -source translation models as encoders and decoders .
Experiments on Chinese-English NIST datasets show that our approach leads to significant improvements .
As our method is sensitive to the OOVs present in monolingual corpora , we plan to integrate Jean et al . ( 2015 ) 's technique on using very large vocabulary into our approach .
It is also necessary to further validate the effectiveness of our approach on more language pairs and NMT architectures .
Another interesting direction is to enhance the connection between source - to- target and target - tosource models ( e.g. , letting the two models share the same word embeddings ) to help them benefit more from interacting with each other .
Figure 1 : 1 Figure 1 : Examples of ( a ) source autoencoder and ( b ) target autoencoder on monolingual corpora .
Our idea is to leverage autoencoders to exploit monolingual corpora for NMT .
In a source autoencoder , the source- to- target model P ( y|x ; ? ? ? ) serves as an encoder to transform the observed source sentence x into a latent target sentence y ( highlighted in grey ) , from which the target- to- source model P ( x |y ; ? ? ? ) reconstructs a copy of the observed source sentence x from the latent target sentence .
As a result , monolingual corpora can be combined with parallel corpora to train bidirectional NMT models in a semi-supervised setting .
