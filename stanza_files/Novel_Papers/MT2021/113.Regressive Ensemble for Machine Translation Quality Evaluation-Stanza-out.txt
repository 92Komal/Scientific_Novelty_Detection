title
Regressive Ensemble for Machine Translation Quality Evaluation
abstract
This work introduces a simple regressive ensemble for evaluating machine translation quality based on a set of novel and established metrics .
We evaluate the ensemble using a correlation to expert-based MQM scores of the WMT 2021 Metrics workshop .
In both monolingual and zero-shot cross-lingual settings , we show a significant performance improvement over single metrics .
In the crosslingual settings , we also demonstrate that an ensemble approach is well - applicable to unseen languages .
Furthermore , we identify a strong reference - free baseline that consistently outperforms the commonly - used BLEU and ME-TEOR measures and significantly improves our ensemble 's performance .
Introduction Automated evaluation of text generation is challenging due to many orthogonal qualitative aspects that the user expects from a text generation system .
In machine translation , we can observe errors of the so-called critical category ( Wulczyn et al. , 2017 ) such as hallucinating ( Lee et al. , 2019 ) , omitting parts of the input from translation , or the negation of meaning ( Matusov , 2019 ) .
Consider an example of the last category : ?
Reference : " I never wrote this article , I just edited it . " ?
Hypothesis
1 : " It is not my article , I just edited it . " ?
Hypothesis 2 : " I never wrote this article , I never edited it . "
In this example , all BERTScore ( Zhang et al. , 2019 ) , BLEUrt ( Sellam et al. , 2020 ) , and Prism ( Thompson and Post , 2020 b ) metrics rank Hypothesis 2 higher than Hypothesis 1 .
In BLEUrt and Prism , this can be due to a known vulnerability of Transformers , which rely on a lexical intersection ( Mc - Coy et al. , 2019 ) if such a heuristic fits the prob-lem sufficiently well .
Trivially , just counting the negations can easily remedy this specific problem .
However , such a heuristic would fail in many other cases , such as when we adjust Hypothesis 1 to " It is an article of somebody else , I just edited it . " .
Such cases motivate our ensemble approach that aims to expose both surface and deeper semantic properties of texts and subsequently learn to utilize these for the specific task of translation evaluation .
Even though the objective might constrain the particular metrics , data set , or systematically fail in some cases , another metric or their combination in the ensemble allows the flaw to be corrected .
Metrics for machine translation evaluation
This section reviews the related work , focusing on the metrics we used in our ensemble .
The standard and still widely - used surface - level metrics for the evaluation of machine translation quality are BLEU ( Papineni et al. , 2002 ) , ROUGE ( Lin , 2004 ) , and TER ( Snover et al. , 2006 ) .
Surfacelevel metrics are not able to capture the proximity of meaning in cases where one text paraphrases the other , which is an ability commonly observed in deep neural language models ( Lewis et al. , 2020 ) .
One metric that addresses this flaw is METEOR ( Banerjee and Lavie , 2005 ) , which utilizes WordNet to account for synonymy , word inflection , or tokenlevel paraphrasing .
Evaluation of semantic text equivalence is closely related to a problem of accurate textual representations ( embeddings ) .
The traditional method that we identify as relevant for the evaluation of segment-sized texts is FastText ( Bojanowski et al. , 2017 ) .
FastText learns representations of character n-grams from which it creates a unified representation of tokens by averaging .
Additionally , a distance of a pair of texts can be computed directly from the token - level embeddings using methods such as the soft vector space model ( the soft co-sine measure , SCM ) ( Novotn ? , 2018 ) , or by solving a minimum-cost flow problem ( the word mover 's distance , WMD ) ( Kusner et al. , 2015 ) .
Similar matching is performed by BERTScore ( Zhang et al. , 2019 ) , which uses internal token embeddings of a selected BERT layer optimal for the task .
Although the token representations are multilingual in some models ( Devlin et al. , 2018 ) , which makes BERTScore usable without references , we are not aware of prior work evaluating it as such .
A possible drawback of cross-lingual alignment using a max-reference matching scheme of BERTScore lies in a possibility of a significant mismatch of sub-word tokens in source and target text .
In contrast , the metric that we refer to as WMD - contextual uses the same embeddings as BERTScore but uses the network - flow optimization matching scheme of WMD .
Task - agnostic methods have recently been outperformed by methods that fine - tune a pre-trained model for a related objective : BLEUrt ( Sellam et al. , 2020 ) fine -tunes a BERT ( Devlin et al. , 2018 ) model directly on Direct Assessments of submissions to WMT to predict the judgements using a linear head over contextual embeddings of a classification [ CLS ] token .
Comet ( Rei et al. , 2020 ) learns to predict Direct Assessments from tuples of source , reference , and translation texts with the triplet objective or the standard MSE objective .
Some of the most recent work incorporates latent objectives and / or data sets .
For instance , Prism ( Thompson and Post , 2020 b , a ) learns a languageagnostic representation from multilingual paraphrasing in 39 languages , thus being one of the few well - performing reference -free metrics .
The orthogonality of its training objective might lower its correlation to other methods that use contextual embeddings .
Methodology
Our methodology aims to answer the following major question with additional supporting questions :
1 . Can an ensemble of surface , syntactic , and semantic -level metrics significantly improve the performance of single metrics ?
2 . Can such an approach be applied crosslingually , i.e. , on languages that it has not been trained on ?
3 . Can surface - level metrics in reference -free configuration achieve results comparable to the reference - based ones ?
4 . Are contextual token representations important for evaluating semantic equivalence , or can these be replaced with pre-inferred token representations ?
Experimental setup
We perform our primary evaluation on Multidimensional Quality Metrics ( MQM ) data set ( Freitag et al. , 2021 ) , where we use averaged judgement scores as our gold standard .
Where multiple judgements are available for the given pair of a source and a hypothesis , we average the scores over the judgements and consider this average as our gold standard .
We split the samples into train ( 80 % ) and test ( 20 % ) subsets based on unique source texts .
In our experimental framework , which we release as an open-source Python library and Docker image for ease of reproduction 12 , we implement a selected set of the metrics based on their guidelines , together with a bunch of novel metrics , introduced in Section 3.2 aiming to provide additional , orthogonal insight of textual equivalence .
Subsequently , we train a regressive ensemble on the standardized metric features of the whole train set , intending to predict the averaged MQM expert judgements .
We evaluate the ensemble , together with all other selected metrics using pairwise Spearman 's rank correlation ( Spearman 's ? ) with the MQM judgements on the held - out 20 % test split .
In addition to our primary evaluation on the MQM data set , we perform our experiments on the Direct Assessments ( DA ) from WMT 2015 and 2016 , and a dev set of Catastrophic errors from the Post-editing Dataset ( Fomicheva et al. , 2020a ) of the Multilingual Quality Estimation Dataset ( MLQE - PE ) ( Fomicheva et al. , 2020 b ) used for evaluation at the Quality Estimation workshop of WMT 2021 .
Refer to Section 3.6 for a detailed description of our experiments on DA and MLQE - PE .
We performed all our evaluations on segmentlevel judgements .
To minimize the impact of calibration for each of the specific metrics to evaluation , we report Spearman 's rank correlation coefficient , reflecting the mutual qualitative ordering rather than particular values of the judgements .
Novel metrics
In addition to a selected set of metrics based on a literature review , we implement a set of novel metrics that allows our ensemble to reflect a wider variance of properties of the evaluated texts .
Soft Cosine Measure
The soft cosine measure ( SCM ) ( Novotn ? , 2018 ) is the cosine similarity of texts in the soft vector space model , where the axes of terms are at an angle corresponding to their cosine similarity S in a token embedding space : SCM ( x , y ) = x T ? S ? y ? x T ? S ? x ? y T ? S ? y ( 1 ) where x is a weighted bag-of-words ( BoW ) vector of a reference ( or a source in a reference - free setting ) , and y is a weighted BoW vector of a hypothesis .
We use SCM with two token representations : 1 . We use the static token representations of Fast- Text ( Grave et al. , 2018 ) .
We refer to the resulting metric as SCM .
2 . We use the contextual token representations of BERT ( Devlin et al. , 2018 ) using the methodology of BERTScore ( Zhang et al. , 2019 ) .
We collect representations of all tokens segmented by the WordPiece ( Wu et al. , 2016 ) tokenizer , and we treat each unique ( token , context ) pair as a single term in our vocabulary .
Subsequently , we decontextualize these representations as follows :
For each WordPiece token , we average the representations of all ( token , context ) pairs in the training corpus .
We refer to the resulting metric as SCMdecontextualized .
Due to the multilingual character of the learned BERT token representations , this metric is applicable both in reference - based and source - based approaches .
In addition to two token representations , we also use two different SMART weighting schemes of Salton and Buckley ( 1988 ) for the BoW vectors x , y and the construction of the term similarity matrix S : 1 .
We use raw term frequencies as weights in the BoW vectors , the nnx SMART weighting scheme , and we construct the term similarity matrix in the vocabulary order .
We refer to the resulting metrics as SCM and SCMdecontextualized .
2 . We use term frequencies discounted by inverse document frequencies as weights in the BoW vectors , the nfx SMART weighting scheme , and we construct the term similarity matrix in the decreasing order of inverse document frequencies ( Novotn ? , 2018 , Section 3 ) .
We refer to the resulting metrics as SCM - tfidf and SCM - decontextualized - tfidf .
Word Mover 's Distance
The Word Mover 's Distance ( WMD ) ( Kusner et al. , 2015 ) finds the minimum-cost flow F between vector space representations of two texts : WMD ( x , y ) = minimum cumulative cost F T ?S subject to j F ij = x i , i F ij = y j , ( 2 ) where x is an 1 - normalized weighted BoW vector of a reference ( or a source in reference - free setting ) , y is an 1 - normalized weighted BoW vector of a hypothesis , and S is a term similarity matrix .
Similar to SCM described in the previous section , we experiment with two token representations : FastText embeddings of whole tokens ( WMD ) and decontextualized embeddings of WordPiece tokens ( WMD - decontextualized ) .
Additionally , we also use the contextual embeddings of WordPiece tokens ( WMD - contextual ) to show the impact of decontextualization on the metric performance :
If the impact is negligible , future work could avoid the costly on - the-fly inference of BERT representation and significantly reduce the vocabulary size .
Similarly to SCM , we also use two different weighting schemes : raw term frequencies ( WMD - * ) and term frequencies discounted by inverse document frequencies ( WMD -*- tfidf ) .
Compositionality
Our custom metric that we refer to as Compositionality constructs a transition graph of an arbitrary text G t based on directed , pairwise transitions of the tokens ' part-of-speech ( PoS ) categories .
As the models for PoS tagging are language - dependent , we use the compliantthough not always systematically aligned - schemes of tagging used for training the taggers in English ( Weischedel et al. , 2013 ) , German ( Brants et al. , 2002 ) , Chinese ( Weischedel et al. , 2013 ) , and Norwegian ( Unhammer and Trosterud , 2009 ) .
Subsequently , we row-normalise the values of matrix G t and we define a distance metric of Compositionality C for x = G t 1 and y = G t 2 : C( x , y ) = 1 - norm ( x ii ? y ii ) , ( 3 ) where the PoS tags i ?
x and i ? y .
In our submission , we apply this metric only if the language belongs to a set of the languages for which we have a tagger : English , German , Chinese , or Norwegian .
In reference - based evaluations , this constraint applies to the target language ; in the case of reference - free evaluations , it applies to both source and target languages .
Ensemble
We ensemble the aforementioned metrics as predictors in a regression model , minimizing the residual between the average segment - level MQM scores and predicted targets .
We experiment with a wide range of simple regressors and observe a superior performance of simple approaches of fully connected , two - layer perceptron with 100 - dimensional hidden layer and ReLu activation and linear regression with squared residuals .
We report the results for RegEMT as the best- performing one of these classifiers picked on a 20 % held - out validation subset of the train data set .
In addition to the ensemble of all available metrics , we evaluate a baseline regressive ensemble Reg-base using solemnly two surface - level features : character - level source and target length according to WordPiece ( Wu et al. , 2016 ) tokens .
Cross-lingual experiments
As expert judgments are incredibly costly to obtain , it is unrealistic to expect that the training data for the trained systems will be available in the future for a vast majority of language pairs containing underresourced languages .
To estimate the performance of all metrics on uncovered language pairs , we perform a cross-lingual evaluation on average MQM judgements of two available language pairs : zh-en and en-de .
Where applicable , we fit the metric parameters on the train split of the non-reported language pair .
Subsequently , we evaluate and report the results on a test split of the reported pair to MQM judgements .
Ablation study
To understand the impact of individual metrics in their roles as predictors for our ensemble , we use their pairwise correlations for systematic feature elimination .
In our ablation study , we iteratively select the metric with the highest Spearman 's ? to any other metric .
We eliminate the selected metric from our ensemble by fitting a new regression model on the remaining features .
We continue until all metrics are eliminated and evaluate the ensemble at each step of the process .
Additional evaluations
To allow for additional insight into the consistency of the results to other relevant evaluation sources , together with an evaluation of the metrics in the novel application of critical error recognition , we perform the experiments analogically on a DA data set of the WMT submissions from years 2015 and 2016 , as well as to the Critical Errors dev set of MLQE - PE data set for reference -free metrics .
In the case of DA judgements , we use the assessments from the year 2015 as a training split and assessments from the year 2016 as a test split .
In the case of MLQE - PE , we split the data analogically to MQM by splitting the unique source texts in an 80:20 ratio .
In this case , we consider as gold judgements the mean severity of error assigned by three annotators to each of the translations .
Results Correlations to MQM judgements .
Table 1 lists correlations to MQM for source - based , i.e. , reference -free metrics ( upper ) and reference - based metrics ( middle ) .
Results reported for RegEMT fit a selected regression model on the estimates of all the other metrics available for a given evaluation scheme .
As described in Section 3.3 , we pick the evaluated regression model based on its performance on a held - out portion of the train set : a two -layer perceptron for the source - based zh-en pair and a simple linear regression in all other cases , with negligible mutual differences between regression models in performance on the validation set ( below 2 % ) .
In the reports suffixed with X , we fit the regression model on the other language pair than the one used for the evaluation .
The results suggest that a simple regressive ensemble can benefit from the variance of the predictors in a majority of the evaluated configurations , including the cross-lingual settings and other evaluated datasets .
We observe the highest margins in correlations in the case of MQM judgements .
.59 .36 .44 .44 .29 .17 .19 .13 .13 .34 MQM -src zh-en -X . .28 MQM -src en-de-X . 31 .09 .14 .06 .04 .07 .04 .02 .23 .28 MQM - ref zh-en .62 .45 .45 .43 .27 .21 .10 .26 .01 .35 .51 .19 .35 .29 .27 .48 .25 .28 MQM -ref zh-en -X .62 .45 .45 .43 .27 .21 .09 .25 .01 .31 .51 .19 .35 .29 .27 .48 .25 .28 MQM - ref en-de .60 .32 .22 .25 .32 .28 .33 .18 .12 .27 .48 .06 .14 .13 .07 .10 .13 .20 MQM - ref en-de-X .38 .32 .22 .25 .32 .28 .34 .17 .12 .29 .48 .06 .14 .13 .07 .10 .13 .20 DA 2016 - src .84 .72 .74 .73 .57 .51 .37 .51 .29 .18 .82 .39 .45 .44 .42 .81 .42 .50 DA 2016 .09
Baseline ensemble .
Table 1 shows that Reg-base , using only the counts of reference and hypothesis Word-pieces , demonstrates its consistent superiority over the standard surface - level metrics of BLEU and METEOR , even in the cross-lingual vs. monolingual comparison .
With respect to the MQM judgements , the correlations of Reg-base are reasonably consistent ; hence , in the reference - free cases of en-de language pair , the correlation of Reg-base is very close to the correlations of RegEMT .
R e g E M T P r i s m B E R T S c r W M D -c o n t W M D -d e c W M D -d e c -t f S C M -d e c S C M -d e c -t f C o m p o s R e g - b a s e C o m e t S C M S C M -t f W M D W M D -t f B L E U r t B L E U M E T E O R MQM - src zh-en
Importance of contextualization .
The results in Table 1 are inconsistent concerning the importance of contextualization in token - level metrics ( WMD - cont * vs. WMD - dec* and SCM - cont* vs. SCM - dec* ) .
We observe a significant ( 15 - 16 % ) decrease of correlation between a contextualized and decontextualized versions of WMD in all cases of zh-en language pair .
The situation differs in en-de pair , where for the reference - based case , the correlation of decontextualized version of WMD is superior by 7 % .
Metrics correlations .
Table 2 demonstrates mutual correlations of the evaluated metrics .
We see the strong pairwise correlations among the metrics based on contextualized representations , such as between Comet , Prism , BERTScore and BLEUrt ; all of these are higher than 0.79 .
The situation is similar among the metrics based on static token representations of SCM and WMD , both with and without TF - IDF .
In contrast , we observe a low correlation of BLEU and METEOR to Reg- base forming a cluster of surface - level metrics .
Ablation study .
Figure 1 displays performance development in Spearman 's ? of the regressive ensemble when we incrementally eliminate the metrics from the set of ensembled predictors .
Following the methodology described in Section 3.5 , the exact ordering of the metrics in ablation for zh-en pair is shown in Table 2 , and we observe it to be similar also for the other language pair of MQM .
In ensembles of reference - based metrics ( left ) , we observe a high consistency throughout the removal of most of the metrics .
A longer consistency in zh-en case is attributed to a consistent performance in ensembling BLEUrt ( removed in step 14 ) and METEOR ( removed in step 15 ) .
These metrics only reach the correlation of 0.48 and 0.28 , respectively , when evaluated independently .
In en-de case , the most significant drops can be attributed to a removal of the best-performing Comet ( step 9 ) and Prism ( step 11 ) .
Ensemble of source- based metrics ( right ) shows significant drops in zh-en pair after removing Prism ( step 3 ) and WMD - contextual ( step 4 ) .
In en-de language pair , the correlation is relatively low throughout the whole ablation process .
The least corre - 0 ) 1 ) 2 ) 3 ) 4 ) 5 ) 6 ) 7 ) 8 ) 9 ) 10 ) 11 ) 12 ) 13 ) 14 ) 15 ) 16 ) 17 ) 18 ) 0 ) MQM avg scr 1 . . 62 .51 .45 .45 .43 .27 .21 .1 .26 .19 .35 .29 .27 .48 .25 .28 .01 .35
1 ) RegEMT .59 1 . . 56 .5 .44 .42 .25 .23 .4 .28 .15 .36 .3 .3 .55 .26 .32 .11 .51 2 ) Comet 1 . . 79 .82 .82 .71 .61 .54 .62 .57 .64 .64 .6 .83 .64 .63 .44 .4 3 ) Prism .36 .5 1 . .9 .9 .85 .77 .63 .71 .71 .77 .79 .77 .8 .81 .77 .54 .19 4 ) BERTScr .44 .48 .13 1 . .13 .06 .01 .11 .1 .13 .04 .76 .73 .82 .77 .74 .56 .18 5 ) .18 6 ) .66 .37 7 ) .32 8 ) .58 9 ) lated and hence the last ones eliminated are WMDdecontextualized - tfidf ( step 6 ) and Prism ( step 7 ) .
Discussion Regressive ensemble .
Following the objectives that we set in Section 3 , we empirically confirm that an ensemble can push the quality of modeling the expert judgements in most of the configurations while performing close - to - the - best metrics on the others .
Additionally , we demonstrate that such ensemble is transferable to new language pairs and that its use is motivated by qualitative gains even in cross-lingual settings .
At the same time , one must acknowledge the limitations that an ensemble system exposes compared to single and unsupervised metrics .
An ensemble might inherit the systematic biases of each of its metrics .
This problem is observable in the results of the source - based en-de pair of MQM in Table 1 , where the ensemble follows the low correlations of its ensembled metrics .
Further , relying entirely on the metrics ' consistency , the ensemble will inevitably expose errors in domains where some metrics behave markedly out of their usual range .
On the other hand , we argue that this might rarely be the case with the surface - level metrics that are mainly unsupervised .
We suspect it to be unlikely with learnable metrics , too , having their output space constrained by the range of their imitated metrics .
2 and partially also the threshold metrics in Figure 1 suggest that our ensemble relies primarily on trained contextualized metrics with regards to their correlation with the target as summarized in Table 1 .
We suspect that oversampling of under-represented categories of errors would increase the significance of other types of metrics , as the under-represented error categories would be the ones where the fine-tuned metrics perform worse .
Values of correlations in Table Baseline ensemble .
Surprisingly , our baseline ensemble Reg-base consistently outperforms other standard surface - based metrics such as BLEU ( Papineni et al. , 2002 ) .
This suggests possible applicability of surface - level metrics also in reference -free evaluation .
We suspect that the baseline features of length based on a multilingual WordPiece tokenizer ( Wu et al. , 2016 ) might reflect on the missing or inappropriately added segments more strictly than other surface - level metrics .
At the same time , these errors are usually highly weighted in the overall score .
of the other weak surface metrics into the baseline ensemble to alleviate some of its apparent flaws .
Impact of contextualization .
Based on the results of WMD -* described in Section 3.2.2 , one can not draw a consistent conclusion regarding the impact of contextualization .
On average , decontextualization has decreased the performance of WMD by 8 % , but the original motivation of a significant improvement in the usability of estimators might compensate .
On the other hand , WMD - decontextualized and WMD - decontextualized - tfidf reached a considerable improvement of 16 - 18 % as compared to WMD and WMD - tfidf using FastText embeddings , while losing none of their flexibility .
" It is the harmony of the diverse parts , their symmetry , their happy balance ; in a word it is all that introduces order , all that gives unity , that permits us to see clearly and to comprehend at once both the ensemble and the details . "
Henri Poincar ?
Conclusion
This work evaluates the potential of ensembling multiple diverse metrics ( RegEMT ) for an evaluation of machine translation quality and offers a new simple baseline metric Reg-base that achieves better results than BLEU and METEOR by using just the source and reference lengths .
We measure significant gains in Spearman 's correlation to MQM with RegEMT compared to standalone metrics and we demonstrate that even simple linear estimators can benefit from the expressivity that the methods of all levels of representation provide .
Additionally , as we demonstrate , the ensemble based on metrics supporting multilingualism can push the quality further even on unseen language pairs .
We recognize the inherent limitations of the regressive ensemble , which is inevitably slower , resource -heavier , and prone to inherit latent inductive biases of underlying metrics or their combinations .
However , RegEMT shows the agility of the simple ensemble approach , which is in contrast to attempts to learn the full complexity of quality estimation through a single objective and allows the quality estimator to avoid the blind spots of particular metrics .
We hope that our results will motivate future work in the ensemble evaluation .
Figure 1 : 1 Figure 1 : Ablation study : correlation of ensemble estimator to averaged MQM judgements during incremental elimination of the most-correlated metric from the ensembled predictors .
Left : ablation of reference - based metrics , right : ablation of source - based metrics .
