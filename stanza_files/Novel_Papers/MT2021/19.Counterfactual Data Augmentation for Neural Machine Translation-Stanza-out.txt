title
Counterfactual Data Augmentation for Neural Machine Translation
abstract
We propose a data augmentation method for neural machine translation .
It works by interpreting language models and phrasal alignment causally .
Specifically , it creates augmented parallel translation corpora by generating ( path-specific ) counterfactual aligned phrases .
We generate these by sampling new source phrases from a masked language model , then sampling an aligned counterfactual target phrase by noting that a translation language model can be interpreted as a Gumbel - Max Structural Causal Model ( Oberst and Sontag , 2019 ) .
Compared to previous work , our method takes both context and alignment into account to maintain the symmetry between source and target sequences .
Experiments on IWSLT '15 English ?
Vietnamese , WMT '17 English ? German , WMT '18 English ?
Turkish , and WMT '19 robust English ?
French show that the method can improve the performance of translation , backtranslation and translation robustness .
Introduction Neural machine translation ( NMT ) models ( Kalchbrenner and Blunsom , 2013 ; Bahdanau et al. , 2014 ; Vaswani et al. , 2017 ) have reached state - of - the - art performance on various benchmarks .
However , these models frequently rely on large-scale parallel corpora for training , exhibiting degraded performance on low-resource languages ( Zoph et al. , 2016 ) .
Further , modern NMT systems are often brittle , as noises ( e.g. grammatical errors ) can cause significant mistranslations ( Sakaguchi et al. , 2017 ; Michel and Neubig , 2018 ) .
Data augmentation is a promising direction to overcome these issues .
It works by enlarging the number of data points for training without manually collecting new data .
It is widely used to improve diversity and robustness and to avoid overfitting on small datasets .
Even though data augmentation ( e.g. image flipping , cropping and blurring ) has G X 1 < l a t e x i t s h a 1 _ b a s e 6 4 = " k 9 W k u K G g i a i q C U B 1 E D 1 V E k o l l N s = " > A A A C G H i c b V D L S s N A F J 3 U V 6 2 v q D v d B I v g q i R V 0 G X B h S 4 r 2 A e 0 s U y m N + 3 Q y S T M T I Q S A n 6 H H + B W P 8 G d u H X n F / g b T t I s b O u B g X P P u Z d 7 5 3 g R o 1 L Z 9 r d R W l l d W 9 8 o b 1 a 2 t n d 2 9 8 z 9 g 7 Y M Y 0 G g R U I W i q 6 H J T D K o a W o Y t C N B O D A Y 9 D x J t e Z 3 3 k E I W n I 7 9 U 0 A j f A I 0 5 9 S r D S 0 s A 8 6 g d Y j T 0 / u U k H i Z M + 5 C X B L O m m A 7 N q 1 + w c 1 j J x C l J F B Z o D 8 6 c / D E k c A F e E Y S l 7 j h 0 p N 8 F C U c I g r f R j C R E m E z y C n q Y c B y D d J P 9 D a p 1 q Z W j 5 o d C P K y t X / 0 4 k O J B y G n i 6 M z t R L n q Z + J / X i 5 V / 5 S a U R 7 E C T m a L / J h Z K r S y Q K w h F U A U m 2 q C i a D 6 V o u M s c B E 6 d j m t k i d C w h g W T L O Y g 7 L p F 2 v O e e 1 + t 1 F t W E X G Z X R M T p B Z 8 h B l 6 i B b l E T t R B B T + g F v a I 3 4 9 l 4 N z 6 M z 1 l r y S h m D t E c j K 9 f e y 2 h U A = = < / l a t e x i t > G X 2 < l a t e x i t s h a 1 _ b a s e 6 4 = " r h C G U P 7 y l x c M U t A W V v 7 8 y 5 I y K 2 8 = " > A A A C G H i c b V D L S s N A F J 3 U V 6 2 v q D v d B I v g q i R V 0 G X B h S 4 E u C W d J N B 2 b V r t k 5 r G X i F K S K C j Q H 5 k 9 / G J I 4 A K 4 I w 1 L 2 H D t S b o K F o o R B W u n H E i J M J n g E P U 0 5 D k C 6 S f 6 H 1 D r V y t D y Q 6 E f V 1 a u / p 1 I c C D l N P B 0 Z 3 a i X P Q y 8 T + v F y v / y k 0 o j 2 I F n M w W + T G z V G h l g V h D K o A o N t U E E 0 H 1 r R Y Z Y 4 G J 0 r H N b Z E 6 F x D A s m S c x R y W S b t e c 8 5 r 9 b u L a s M u M i q j Y 3 S C z p C D L l E D 3 a I m a i G C n t A L e k V v x r P x b n w Y n 7 P W k l H M H K I 5 G F + / f N O h U Q = = < / l a t e x i t > G X 3 < l a t e x i t s h a 1 _ b a s e 6 4 = " G G m n j J W g B u b b J g j X J t t n N Z c x V 6 g = " > A A A C G H i c b V D L S s N A F J 3 4 r P U V d a e b Y B F c l a Q V d F l w o c s K 9 g F t L J P p T T t 0 M g k z E 6 G E g N / h B 7 j V T 3 A n b t 3 5 B f 6 G k z Q L 2 3 p g 4 N x z 7 u X e O V 7 E q F S 2 / W 2 s r K 6 t b 2 y W t s r b O 7 t 7 + + b B Y V u G s S D Q I i E L R d f D E h j l 0 F J U M e h G A n D g M e h 4 k + v M 7 z y C k D T k 9 2 o a g R v g E a c + J V h p a W A e 9 w O s x p 6 f 3 K S D p J 4 + 5 C X B L O m m A 7 N i V + 0 c 1 j J x C l J B B Z o D 8 6 c / D E k c A F e E Y S l 7 j h 0 p N 8 F C U c I g L f d j C R E m E z y C n q Y c B y D d J P 9 D a p 1 p Z W j 5 o d C P K y t X / 0 4 k O J B y G n i 6 M z t R L n q Z + J / X i 5 V / 5 S a U R 7 E C T m a L / J h Z K r S y Q K w h F U A U m 2 q C i a D 6 V o u M s c B E 6 d j m t k i d C w h g W T L O Y g 7 L p F 2 r O v V q 7 e 6 i 0 r C L j E r o B J 2 i c + S g S 9 R A t 6 i J W o i g J / S C X t G b 8 W y 8 G x / G 5 6 x 1 x S h m j t A c j K 9 f f n m h U g = = < / l a t e x i t > G X 4 < l a t e x i t s h a 1 _ b a s e 6 4 = " R Q R W p R 4 w E M / z C K 6 M y W q y d o g i Q + w = " > A A A C G H i c b V D L S s N A F J 3 4 r P U V d a e b Y B F c l a Q W d F l w o c s K 9 g F t L J P p T T t 0 M g k z E 6 G E g N / h B 7 j V T 3 A n b t 3 5 B f 6 G k z Q L 2 3 p g 4 N x z 7 u X e O V 7 E q F S 2 / W 2 s r K 6 t b 2 y W t s r b O 7 t 7 + + b B Y V u G s S D Q I i E L R d f D E h j l 0 F J U M e h G A n D g M e h 4 k + v M 7 z y C k D T k 9 2 o a g R v g E a c + J V h p a W A e 9 w O s x p 6 f 3 K S D p J 4 + 5 C X B L O m m A 7 N i V + 0 c 1 j J x C l J B B Z o D 8 6 c / D E k c A F e E Y S l 7 j h 0 p N 8 F C U c I g L f d j C R E m E z y C n q Y c B y D d J P 9 D a p 1 p Z W j 5 o d C P K y t X / 0 4 k O J B y G n i 6 M z t R L n q Z + J / X i 5 V / 5 S a U R 7 E C T m a L / J h Z K r S y Q K w h F U A U m 2 q C i a D 6 V o u M s c B E 6 d j m t k i d C w h g W T L O Y g 7 L p F 2 r O h f V 2 l 2 9 0 r C L j E r o B J 2 i c + S g S 9 R A t 6 i J W o i g J / S C X t G b 8 W y 8 G x / G 5 6 x 1 x S h m j t A c j K 9 f g B + h U w = = < / l a t e x i t > p i +
F d M h E Y Q q H d v M F q l z A Q E 8 T 8 a e z 2 G R t G p V + 6 x a u z 2 v 1 K 0 i o x I 6 Q s f o F N n o A t X R D W q g J q L o C b 2 g V / R m P B v v x o f x O W 1 d M o q Z A z Q D 4 + s X f M e h U Q = = < / l a t e x i t >
G Y 3 < l a t e x i t s h a 1 _ b a s e 6 4 = " W C Q x a E e N X u 9 A u f b l 2 y A + f Y O 1 y G g = " > A A A C G H i c b V D L S s N A F J 3 U V 6 2 v q D v d B I v g q i S t o M u C C 1 1 W s A 9 p Y 5 h M b 9 q h k w c z E 6 G E g N / h B 7 j V T 3 A n b t 3 5 B f 6 G k z Q L 2 3 p g 4 N x z 7 u X e O W 7 E q J C m + a 2 V V l b X 1 j f K m 5 W t 7 Z 3 d P X 3 / o C P C m B N o k 5 C F v O d i A Y w G 0 J Z U M u h F H L D v M u i 6 k 6 v M 7 z 4 C F z Q M 7 u Q 0 A t v H o 4 B 6 l G C p J E c / G v h Y j l 0 v u U 6 d p J E + 5 C X B L L l P H b 1 q 1 s w c x j K x C l J F B V q O / j M Y h i T 2 I Z C E Y S H 6 l h l J O 8 F c U s I g r Q x i A R E m E z y C v q I B 9 k H Y S f 6 H 1 D h V y t D w Q q 5 e I I 1 c / T u R Y F + I q e + q z u x E s e h l 4 n 9 e P 5 b e p Z 3 become a standard technique in computer vision ( Krizhevsky et al. , 2012 ; Huang et al. , 2017 ; Chen et al. , 2020 ) , it is non-trivial to apply in machine translation since even a slight modification to a sequence can result in drastic changes in its syntax and semantics .
Indeed there is relatively little work in this direction due to these difficulties ( Sennrich et al. , 2016 ; Fadaee et al. , 2017 ; Wang et al. , 2018 ; Gao et al. , 2019 ; Kobayashi , 2018 ) .
Further , work based on word replacement either ignores the contexts of replaced words or breaks the alignment between source and target sequences , both detrimental for generating high-quality data .
Q I I o l B G S 2 y I u Z I U M j C 8 Q Y U g 5 E s q k i m H C q b j X I G H N M p I p t b o t Q u Q A H l i V j L e a w T D r 1 m t W o 1 W / P q 0 2 z y K i M j t E J O k M W u k B N d I N a q I 0 I e k I v 6 B W 9 a c / a u / a h f c 5 a S 1 o x c 4 j m o H 3 9 A o A T o V M = < / l a t e x i t > G Y 4 < l a t e x i t s h a 1 _ b a s e 6 4 = " V 4 N q c Q T + x K x l b y 5 w n 7 l p U A x Z g 8 Q = " > A A A C G H i c b V D L S s N A F J 3 U V 6 2 v q D v d B I v g q i S 1 o M u C C 1 1 W s A 9 p Y 5 h M b 9 q h k w c z E 6 G E g N / h B 7 j V T 3 A n b t 3 5 B f 6 G k z Q L 2 3 p g 4 N x z 7 u X e O W 7 E q J C m + a 2 V V l b X 1 j f K m 5 W t 7 Z 3 d P X 3 / o C P C m B N o k 5 C F v O d i A Y w G 0 J Z U M u h F H L D v M u i 6 k 6 v M 7 z 4 C F z Q M 7 u Q 0 A t v H o 4 B 6 l G C p J E c / G v h Y j l 0 v u U 6 d p J E + 5 C X B L L l P H b 1 q 1 s w c x j K x C l J F B V q O / j M Y h i T 2 I Z C E Y S H 6 l h l J O 8 F c U s I g r Q x i A R E m E z y C v q I B 9 k H Y S f 6 H 1 D h V y t D w Q q 5 e I I 1 c / T u R Y F + I q e + q z u x E s e h l 4 n 9 e P 5 b e p Z 3 Q I I o l B G S 2 y I u Z I U M j C 8 Q Y U g 5 E s q k i m H C q b j X I G H N M p I p t b o t Q u Q A H l i V j L e a w T D r 1 m n V e q 9 8 2 q k 2 z y K i M j t E J O k M W u k B N d I N a q I 0 I e k I v 6 B W 9 a c / a u / a h f c 5 a S 1 o x c 4 j m o H 3 9 A o G 5 o V Q = < / l a t e x i t > G Y 5 < l a t e x i t s h a 1 _ b a s e 6 4 = " V 7 U S 2 R z Z J 4 v J 3 z H J 6 1 F C V 1 e B S c 4 = " > A A A C G H i c b V D L S s N A F J 3 U V 6 2 v q D v d B I v g q i R V 0 W X B h S 4 r 2 I e 0 M U y m N + 3 Q y Y O Z i V B C w O / w A 9 z q J 7 g T t + 7 8 A n / D S Z q F b T 0 w c O 4 5 9 3 L v H D d i V E j T / N Z K S 8 s r q 2 v l 9 c r G 5 t b 2 j r 6 7 1 x Z h z A m 0 S M h C 3 n W x A E Y D a E k q G X Q j D t h 3 G X T c 8 V X m d x 6 B C x o G d 3 I S g e 3 j Y U A 9 S r B U k q M f 9 H 0 s R 6 6 X X K d O c p 4 + 5 C X B L L l P H b 1 q 1 s w c x i K x C l J F B Z q O / t M f h C T 2 I Z C E Y S F 6 l h l J O 8 F c U s I g r f R j A R E m Y z y E n q I B 9 k H Y S f 6 H 1 D h W y s D w Q q 5 e I I 1 c / T u R Y F + I i e + q z u x E M e 9 l 4 n 9 e L 5 b e p Z 3 Q I I o l B G S 6 y I u Z I U M j C 8 Q Y U A 5 E s o k i m H C q b j X I C H N M p I p t Z o t Q u Q A H l i V j z e e w S N r 1 m n V a q 9 + e V R t m k V E Z H a I j d I I s d I E a 6 A Y 1 U Q s R 9 I R e 0 C t 6 0 5 6 1 d + 1 D + 5 y 2 l r R i Z h / N Q P v 6 B Y N f o V U = < / l a t e x i t > G X 5 < l a t e x i t s h a 1 _ b a s e 6 4 = " / 6 Y i s M c D 2 n Y 5 Q l 5 g U 7 7 j Q T i s f + Y = " > A A A C G H i c b V D L S s N A F J 3 4 r P U V d a e b Y B F c l a Q q u i y 4 0 G U F + 4 A 2 l s n 0 p h 0 6 m Y S Z i V B C w O / w A 9 z q J 7 g T t + 7 8 A n / D S Z q F b T 0 w c O 4 5 9 3 L v H C 9 i V C r b / j a W l l d W 1 9 Z L G + X N r e 2 d X X N v v y X D W B B o k p C F o u N h C Y x y a C q q G H Q i A T j w G L S 9 8 X X m t x 9 B S B r y e z W J w A 3 w k F O f E q y 0 1 D c P e w F W I 8 9 P b t J + c p E + 5 C X B L O m k f b N i V + 0 c 1 i J x C l J B B R p 9 8 6 c 3 C E k c A F e E Y S m 7 j h 0 p N 8 F C U c I g L f d i C R E m Y z y E r q Y c B y D d J P 9 D a p 1 o Z W D 5 o d C P K y t X / 0 4 k O J B y E n i 6 M z t R z n u Z + J / X j Z V / 5 S a U R 7 E C T q a L / J h Z K r S y Q K w B F U A U m 2 i C i a D 6 V o u M s M B E 6 d h m t k i d C w h g W T L O f A 6 L p F W r O m f V 2 t 1 5 p W 4 X G Z X Q E T p G p 8 h B l 6 i O b l E D N R F B T + g F v a I 3 4 9 l 4 N z 6 M z 2 n r k l H M H K A Z G F + / g c W h V A = = < / l a t e x i t >
X < l a t e x i t s h a 1 _ b a s e 6 4 = " D S q t / 3 Q a 7 / U g 0 Q + g r n i 0 I N 8 O A F 8 = " > A A A C B 3 i c b V D L S g M x F M 3 4 r P V V d e k m W A R X Z a Y K u i y 6 c V n B P m A 6 l E x 6 p w 3 N J E O S E c r Q D / A D 3 O o n u B O 3 f o Z f 4 G + Y a W d h W w 8 E D u f c y z 0 5 Y c K Z N q 7 7 7 a y t b 2 x u b Z d 2 y r t 7 + w e H l a P j t p a p o t C i k k v V D Y k G z g S 0 D D M c u o k C E o c c O u H 4 L v c 7 T 6 A 0 k + L R T B I I Y j I U L G K U G C v 5 v Z i Y E S U 8 6 0 7 7 l a p b c 2 f A q 8 Q r S B U V a P Y r P 7 2 B p G k M w l B O t P Y 9 N z F B R p R h l M O 0 3 E s 1 J I S O y R B 8 S w W J Q Q f Z L P I U n 1 t l g C O p 7 B M G z 9 S / G x m J t Z 7 E o Z 3 M I + p l L x f / 8 / z U R D d B x k S S G h B 0 f i h K O T Y S 5 / / H A 6 a A G j 6 x h F D F b F Z M R 0 Q R a m x L C 1 e 0 7 Q U U 8 L w Z b 7 m H V d K u 1 7 z L W v 3 h q t q 4 L T o q o V N 0 h i 6 Q h 6 5 R A 9 2 j J m o h i i R 6 Q a / o z X l 2 3 p 0 P 5 3 M + u u Y U O y d o A c 7 X L + r v m q g = < / l a t e x i t >
Y < l a t e x i t s h a 1 _ b a s e 6 4 = " w V s e f u j 4 A 7 1 d B p 3 j P z Q + 9 3 d X K x s = " > A A A C B 3 i c b V D L S g M x F M 3 U V 6 2 v q k s 3 w S K 4 K j N V 0 G X R j c s K 9 i H t U D L p n T Y 0 k w x J R i h D P 8 A P c K u f 4 E 7 c + h l + g b 9 h p p 2 F b T 0 Q O J x z L / f k B D F n 2 r j u t 1 N Y W 9 / Y 3 C p u l 3 Z 2 9 / Y P y o d H L S 0 T R a F J J Z e q E x A N n A l o G m Y 4 d G I F J A o 4 t I P x b e a 3 n 0 B p J s W D m c T g R 2 Q o W M g o M V b q 9 i J i R p T w 9 H H a L 1 f c q j s D X i V e T i o o R 6 N f / u k N J E 0 i E I Z y o n X X c 2 P j p 0 Q Z R j l M S 7 1 E Q 0 z o m A y h a 6 k g E W g / n U W e 4 j O r D H A o l X 3 C 4 J n 6 d y M l k d a T K L C T W U S 9 7 G X i f 1 4 3 M e G 1 n z I R J w Y E n R 8 K E 4 6 N x N n / 8 Y A p o I Z P L C F U M Z s V 0 x F R h B r b 0 s I V b X s B B T x r x l v u Y Z W 0 a l X v o l q 7 v 6 z U b / K O i u g E n a J z 5 K E r V E d 3 q I G a i C K J X t A r e n O e n X f n w / m c j x a c f O c Y L c D 5 + g X s i Z q p < / l a t e x i t > G Y 2 < l a t e x i t s h a 1 _ b a s e 6 4 = " 6 V o U E A 0 h P 0 0 1 E 3 j 1 j 8 x L / L I c I F c = " > A A A C G H i c b V D L S s N A F J 3 4 r P U V d a e b w S K 4 K k k V d F l w o c s K 9 i F t L J P p T T t 0 8 m B m I p Q Q 8 D v 8 A L f 6 C e 7 E r T u / w N 9 w k m Z h W w 8 M n H v O v d w 7 x 4 0 4 k 8 q y v o 2 l 5 Z X V t f X S R n l z a 3 t n 1 9 z b b 8 k w F h S a N O S h 6 L h E A m c B N B V T H D q R A O K 7 H N r u + C r z 2 4 8 g J A u D O z W J w P H J M G A e o 0 R p q W 8 e 9 n y i R q 6 X X K f 9 p J Y + 5 C U l P L l P + 2 b F q l o 5 8 C K x C 1 J B B R p 9 8 6 c 3 C G n s Q 6 A o J 1 J 2 b S t S T k K E Y p R D W u 7 F E i J C x 2 Q I X U 0 D 4 o N 0 k v w P K T 7 R y g B 7 o d A v U D h X / 0 4 k x J d y 4 r u 6 M z t R z n u Z + J / X j Z V 3 6 S Q s i G I F A Z 0 u 8 m K O V Y i z Q P C A C a C K T z Q h V D B 9 K 6 Y j I g h V O r a Z L V L n A g J 4 l o w 9 n 8 M i a d W q 9 l m 1 d n t e q V t F R i V 0 h I 7 R K b L R B a q j G 9 R A T U T R E 3 p B r + j N e D b e j Q / j c 9 q 6 Z B Q z B 2 g G x t c v f m 2 h U g = = < / l a t e x i t >
In this paper we observe that a translation language model can be interpreted as a causal model , as described in Figure 1 .
Doing so allows us to ask counterfactual questions of the form : Given source and target sequences , if a phrase in the source sequence is changed , how would the target sequence change ?
We propose a data augmentation method for machine translation that generates counterfactual parallel translation data .
To ensure these counterfactuals are close to the original data we sample a new source phrase from a masked language model .
We then consider the ( path-specific ) counterfactual target phrase that is aligned to that source phrase ( given by an unsupervised phrasal alignment method ) .
The idea is that this augmentation procedure exposes inductive biases in existing language models that enables new translation models to learn more efficiently and exhibit more robust generalisation .
Specifically , our augmentation procedure performs the following three steps : 1 . We utilize unsupervised phrasal alignment ( e.g. Neubig et al. ( 2011 ) and Dyer et al . ( 2013 ) ) to obtain correspondences between source and target phrases .
2 . A source phrase is removed and then resampled according to a trained masked language model ( Devlin et al. , 2018 ; Raffel et al. , 2019 ) . 3 . We perform ( path-specific ) counterfactual inference on the causal model given by a trained translation language model ( Lample and Conneau , 2019 ) to resample only the aligned target phrase , given the changed source phrase .
Different from prior work , our approach takes advantage of both source / target context and alignment for data augmentation .
Experiments on IWSLT '15 English ?
Vietnamese , WMT '17 English ? German , and WMT'18 English ?
Turkish show that our method improves the translation performance on both high- resource and low-resource datasets .
We additionally demonstrate that our method complements existing approaches such as backtranslation ( Sennrich et al. , 2015a ) .
Finally , we demonstrate that our method improves translation robustness ( we evaluate this on the WMT '19 English ? French robustness dataset ) .
Background
In this section we describe background on neural machine translation ( NMT ) , phrasal alignment , and causal modelling .
Neural machine translation .
Given a set of parallel sequences , S = { ( X i , Y i ) }
N i=1 , NMT maximizes the log-likelihood of Y given X , assuming each ( X i , Y i ) pair is independently and identically distributed : max ?
( X i , Y i ) ?
S log p ?
( Y i | X i ) .
However , paired sequences are usually expensive to collect , as it requires an expert to translate sequences X i into another language Y i .
Data augmentation aims to generate new parallel sequences ( X i , ?i ) without manually collecting new data .
Phrasal alignment .
Phrasal alignment identifies the translation relationships among phrases in parallel sequences .
Given a parallel sequence ( X , Y ) , where X = ( X 1 = x 1 , X 2 = x 2 , ... , X |X | = x | X | ) and Y = ( Y 1 = y 1 , Y 2 = y 2 , ... , Y | Y | = y | Y | ) ( X/ Y and x/y denote a phrase and its value , respectively ) , phrasal alignment h learns a mapping that projects each position i of X to a position j of Y , i.e. j = h( i ) .
In this paper , we use pialign ( Neubig et al. , 2011 ) to obtain alignments .
Causal modelling .
We formulate causality using the structural causal model ( SCM ) framework of Pearl ( 2003 ) .
Each SCM is a set of structural equations represented by a graph .
The edges of this graph specify the inputs and outputs of the structural equations .
Specifically , a variable V i is caused by a set of observable parent variables pa( V i ) and unobserved variables U i if there exists a ( deterministic or stochastic ) structural equation f i : V i = f i ( pa( V i ) , U i ) .
If the structural equations f are identified , it is possible to compute a causal quantity called counterfactuals .
Counterfactuals are questions that , given the current state of the world , ask what would have changed if some variable V had been different .
For example , " Would a person have been able to obtain a visa if they had been born in a different country ? " .
Formally we denote the counterfactual value of a variable V i , had another variable W ? pa( V i ) been ? ( i.e. , compared to its observed value w ) as V i , W ? ?.
To compute counterfactuals we can follow a three -step procedure ( for more details see Chapter 4 of Pearl et al . ( 2016 ) ) :
1 . Abduction : Given a prior distribution on unobserved variables p( U i ) , compute the posterior given all observed variables V = v : p( U i | V = v ) ; 2 . Action : Modify the structural equation for V i , so that W is fixed to the counterfactual value ?
( the modified equation is denoted as f i , ? ) ;
3 . Prediction : Compute the distribution p( V i , W ? ?| V = v ) using p( U i | V = v ) , the observed variables v , and the modified structural equation f i , ?.
< l a t e x i t s h a 1 _ b a s e 6 4 = " 9 0 X X e b X x 9 f g v 2 9 h j f B P L A + 3 7 G X 1 < l a t e x i t s h a 1 _ b a s e 6 4 = " k 9 W k u K G g i a i q C U B 1 E D 1 V E k o l l N s = " > A A A C G H i c b V D L S s N A F J 3 U V 6 2 v q D v d B I v g q i R V 0 G X B h S 4 r 2 A e 0 s U y m N + 3 Q y S T M T I Q S A n 6 H H + B W P 8 G d u H X n F / g b T t I s b O u B g X P P u Z d 7 5 3 g R o 1 L Z 9 r d R W l l d W 9 8 o b 1 a 2 t n d 2 9 8 z 9 g 7 Y M Y 0 G g R U I W i q 6 H J T D K o a W o Y t C N B O D A Y 9 D x J t e Z 3 3 k E I W n I 7 9 U 0 A j f A I 0 5 9 S r D S 0 s A 8 6 g d Y j T 0 / u U k H i Z M + 5 C X B L O m m A 7 N q 1 + w c 1 j J x C l J F B Z o D 8 6 c / D E k c A F e E Y S l 7 j h 0 p N 8 F C U c I g r f R j C R E m E z y C n q Y c B y D d J P 9 D a p 1 q Z W j 5 o d C P K y t X / 0 4 k O J B y G n i 6 M z t R L n q Z + J / X i 5 V / 5 S a U R 7 E C T m a L / J h Z K r S y Q K w h F U A U m 2 q C i a D 6 V o u M s c B E 6 d j m t k i d C w h g W T L O Y g 7 L p F 2 v O e e 1 + t 1 F t W E X G Z X R M T p B Z 8 h B l 6 i B b l E T t R B B T + g F v a I 3 4 9 l 4 N z 6 M z 1 l r y S h m D t E c j K 9 f e y 2 h U A = = < / l a t e x i t > G X 2 < l a t e x i t s h a 1 _ b a s e 6 4 = " r h C G U P 7 y l x c M U t A W V v 7 8 y 5 I y K 2 8 = " > A A A C G H i c b V D L S s N A F J 3 U V 6 2 v q D v d B I v g q i R V 0 G X B h S 4 r 2 A e 0 s U y m N + 3 Q y S T M T I Q S A n 6 H H + B W P 8 G d u H X n F / g b T t I s b O u B g X P P u Z d 7 5 3 g R o 1 L Z 9 r d R W l l d W 9 8 o b 1 a 2 t n d 2 9 8 z 9 g 7 Y M Y 0 G g R U I W i q 6 H J T D K o a W o Y t C N B O D A Y 9 D x J t e Z 3 3 k E I W n I 7 9 U 0 A j f A I 0 5 9 S r D S 0 s A 8 6 g d Y j T 0 / u U k H S T 1 9 y E u C W d J N B 2 b V r t k 5 r G X i F K S K C j Q H 5 k 9 / G J I 4 A K 4 I w 1 L 2 H D t S b o K F o o R B W u n H E i J M J n g E P U 0 5 D k C 6 S f 6 H 1 D r V y t D y Q 6 E f V 1 a u / p 1 I c C D l N P B 0 Z 3 a i X P Q y 8 T + v F y v / y k 0 o j 2 I F n M w W + T G z V G h l g V h D K o A o N t U E E 0 H 1 r R Y Z Y 4 G J 0 r H N b Z E 6 F x D A s m S c x R y W S b t e c 8 5 r 9 b u L a s M u M i q j Y 3 S C z p C D L l E D 3 a I m a i G C n t A L e k V v x r P x b n w Y n 7 P W k l H M H K I 5 G F + / f N O h U Q = = < / l a t e x i t > G X 3 < l a t e x i t s h a 1 _ b a s e 6 4 = " G G m n j J W g B u b b J g j X J t t n N Z c x V 6 g = " > A A A C G H i c b V D L S s N A F J 3 4 r P U V d a e b Y B F c l a Q V d F l w o c s K 9 g F t L J P p T T t 0 M g k z E 6 G E g N / h B 7 j V T 3 A n b t 3 5 B f 6 G k z Q L 2 3 p g 4 N x z 7 u X e O V 7 E q F S 2 / W 2 s r K 6 t b 2 y W t s r b O 7 t 7 + + b B Y V u G s S D Q I i E L R d f D E h j l 0 F J U M e h G A n D g M e h 4 k + v M 7 z y C k D T k 9 2 o a g R v g E a c + J V h p a W A e 9 w O s x p 6 f 3 K S D p J 4 + 5 C X B L O m m A 7 N i V + 0 c 1 j J x C l J B B Z o D 8 6 c / D E k c A F e E Y S l 7 j h 0 p N 8 F C U c I g L f d j C R E m E z y C n q Y c B y D d J P 9 D a p 1 p Z W j 5 o d C P K y t X / 0 4 k O J B y G n i 6 M z t R L n q Z + J / X i 5 V / 5 S a U R 7 E C T m a L / J h Z K r S y Q K w h F U A U m 2 q C i a D 6 V o u M s c B E 6 d j m t k i d C w h g W T L O Y g 7 L p F 2 r O v V q 7 e 6 i 0 r C L j E r o B J 2 i c + S g S 9 R A t 6 i J W o i g J / S C X t G b 8 W y 8 G x / G 5 6 x 1 x S h m j t A c j K 9 f f n m h U g = = < / l a t e x i t > G X 4 < l a t e x i t s h a 1 _ b a s e 6 4 = " R Q R W p R 4 w E M / z C K 6 M y W q y d o g i Q + w = " > A A A C G H i c b V D L S s N A F J 3 4 r P U V d a e b Y B F c l a Q W d F l w o c s K 9 g F t L J P p T T t 0 M g k z E 6 G E g N / h B 7 j V T 3 A n b t 3 5 B f 6 G k z Q L 2 3 p g 4 N x z 7 u X e O V 7 E q F S 2 / W 2 s r K 6 t b 2 y W t s r b O 7 t 7 + + b B Y V u G s S D Q I i E L R d f D E h j l 0 F J U M e h G A n D g M e h 4 k + v M 7 z y C k D T k 9 2 o a g R v g E a c + J V h p a W A e 9 w O s x p 6 f 3 K S D p J 4 + 5 C X B L O m m A 7 N i V + 0 c 1 j J x C l J B B Z o D 8 6 c / D E k c A F e E Y S l 7 j h 0 p N 8 F C U c I g L f d j C R E m E z y C n q Y c B y D d J P 9 D a p 1 p Z W j 5 o d C P K y t X / 0 4 k O J B y G n i 6 M z t R L n q Z + J / X i 5 V / 5 S a U R 7 E C T m a L / J h Z K r S y Q K w h F U A U m 2 q C i a D 6 V o u M s c B E 6 d j m t k i d C w h g W T L O Y g 7 L p F 2 r O h f V 2 l 2 9 0 r C L j E r o B J 2 i c + S g S 9 R A t 6 i J W o i g J / S C X t G b 8 W y 8 G x / G 5 6 x 1 x S h m j t A c j K 9 f g B + h U w = = < / l a t G X 6 < l a t e x i t s h a 1 _ b a s e 6 4 = " 9 0 X X e b X x 9 f g v 2 9 h j f B P L A + 3 7 6 O o = " > A A A C G H i c b V D L S s N A F J 3 4 r P U V d a e b Y B F c l a S K u i y 4 0 G U F + 4 A 2 l s n 0 p h 0 6 m Y S Z i V B C w O / w A 9 z q J 7 g T t + 7 8 A n / D S Z q F b T 0 w c O 4 5 9 3 L v H C 9 i V C r b / j a W l l d W 1 9 Z L G + X N r e 2 d X X N v v y X D W B B o k p C F o u N h C Y x y a C q q G H Q i A T j w G L S 9 8 X X m t x 9 B S B r y e z W J w A 3 w k F O f E q y 0 1 D c P e w F W I 8 9 P b t J + c p E + 5 C X B L O m k f b N i V + 0 c 1 i J x C l J B B R p 9 8 6 c 3 C E k c A F e E Y S m 7 j h 0 p N 8 F C U c I g L f d i C R E m Y z y E r q Y c B y D d J P 9 D a p 1 o Z W D 5 o d C P K y t X / 0 4 k O J B y E n i 6 M z t R z n u Z + J / X j Z V / 5 S a U R 7 E C T q a L / J h Z K r S y Q K w B F U A U m 2 i C i a D 6 V o u M s M B E 6 d h m t k i d C w h g W T L O f A 6 L p F W r O m f V 2 t 1 5 p W 4 X G Z X Q E T p G p 8 h B l 6 i O b l E D N R F B T + g F v a I 3 4 9 l 4 N z 6 M z 2 n r k l H M H K A Z G F + / g 2 u h V Q = = < / l a t e x i t > G Y 1 < l a t e x i t s h a 1 _ b a s e 6 4 = " z 1 X M 2 O h h T g c 5 1 F a x M G + 3 w l S z 3 z s = " > A A A C G H i c b V D L S s N A F J 3 4 r P U V d a e b w S K 4 K k k V d F l w o c s K 9 i F t D J P p T T t 0 8 m B m I p Q Q 8 D v 8 A L f 6 C e 7 E r T u / w N 9 w 0 m Z h W w 8 M n H v O v d w 7 x 4 s 5 k 8 q y v o 2 l 5 Z X V t f X S R n l z a 3 t n 1 9 z b b 8 k o E R S a N O K R 6 H h E A m c h N B V T H D q x A B J 4 H N r e 6 C r 3 2 4 8 g J I v C O z W O w Q n I I G Q + o 0 R p y T U P e w F R Q 8 9 P r z M 3 t b O H S U k J T + 8 z 1 6 x Y V W s C v E j s g l R Q g Y Z r / v T 6 E U 0 C C B X l R M q u b c X K S Y l Q j H L I y r 1 E Q k z o i A y g q 2 l I A p B O O v l D h k + 0 0 s d + J P Q L F Z 6 o f y d S E k g 5 D j z d m Z 8 o 5 7 1 c / M / r J s q / d F I W x o m C k E 4 X + Q n H K s J 5 I L j P B F D F x 5 o Q K p i +
F d M h E Y Q q H d v M F q l z A Q E 8 T 8 a e z 2 G R t G p V + 6 x a u z 2 v 1 K 0 i o x I 6 Q s f o F N n o A t X R D W q g J q L o C b 2 g V / R m P B v v x o f x O W 1 d M o q Z A z Q D 4 + s X f M e h U Q = = < / l a t e x i t > G Y 2 < l a t e x i t s h a 1 _ b a s e 6 4 = " d R P V 3 s m a 7 e N H K j L c j Q e z Y y o M / 8 8 = " > A A A C Q X i c b V D L S s N A F J 3 4 f h t 1 6 S Z Y B B d S k l r b u i u 4 0 G U F + 5 A 2 l s n 0 p g 6 d P J i Z C G X I B / k d f o B b + w X i T t y 6 c Z J W 8 H V g 4 M y 5 r 8 P x Y k a F t O 2 J M T e / s L i 0 v L K 6 t r 6 x u b V t 7 u y 2 R J R w A k 0 S s Y h 3 P C y A 0 R C a k k o G n Z g D D j w G b W 9 0 n t X b 9 8 A F j c J r O Y 7 B D f A w p D 4 l W G q p b 5 6 r X r 6 k y 4 e e q + z i W e W 0 U q s e 2 0 U 7 R 0 b K l Z J j p 7 0 A y z v P V x d p X 5 X S 2 / x L M F M 3 a d o 3 C 1 / 9 1 l / i z E g B z d D o m y + 9 Q U S S A E J J G B a i 6 9 i x d B X m k h I G 6 V o v E R B j M s J D 6 G o a 4 g C E q 3 K f q X W o l Y H l R 1 y / U F q 5 + n 1 C 4 U C I c e D p z s y j + F 3 L x P 9 q 3 U T 6 N V f R M E 4 k h G R 6 y E + Y J S M r S 8 4 a U A 5 E s r E m m H C q v V r k D n N M p M 7 3 x x W h g w E O L E v G + Z 3 D X 9 I q F Z 2 T Y u m q X K j b s 4 x W 0 D 4 6 Q E f I Q V V U R 5 e o g Z q I o A f 0 h J 7 R x H g 0 X o 0 3 4 3 3 a O m f M Z v b Q D x g f n 9 z n r l I = < / l a t e x i t >
G Y 3 < l a t e x i t s h a 1 _ b a s e 6 4 = " W C Q x a E e N X u 9 A u f b l 2 y A + f Y O 1 y G g = " > A A A C G H i c b V D L S s N A F J 3 U V 6 2 v q D v d B I v g q i S t o M u C C 1 1 W s A 9 p Y 5 h M b 9 q h k w c z E 6 G E g N / h B 7 j V T 3 A n b t 3 5 B f 6 G k z Q L 2 3 p g 4 N x z 7 u X e O W 7 E q J C m + a 2 V V l b X 1 j f K m 5 W t 7 Z 3 d P X 3 / o C P C m B N o k 5 C F v O d i A Y w G 0 J Z U M u h F H L D v M u i 6 k 6 v M 7 z 4 C F z Q M 7 u Q 0 A t v H o 4 B 6 l G C p J E c / G v h Y j l 0 v u U 6 d p J E + 5 C X B L L l P H b 1 q 1 s w c x j K x C l J F B V q O / j M Y h i T 2 I Z C E Y S H 6 l h l J O 8 F c U s I g r Q x i A R E m E z y C v q I B 9 k H Y S f 6 H 1 D h V y t D w Q q 5 e I I 1 c / T u R Y F + I q e + q z u x E s e h l 4 n 9 e P 5 b e p Z 3 Q I I o l B G S 2 y I u Z I U M j C 8 Q Y U g 5 E s q k i m H C q b j X I G H N M p I p t b o t Q u Q A H l i V j L e a w T D r 1 m t W o 1 W / P q 0 2 z y K i M j t E J O k M W u k B N d I N a q I 0 I e k I v 6 B W 9 a c / a u / a h f c 5 a S 1 o x c 4 j m o H 3 9 A o A T o V M = < / l a t e x i t > G Y 4 < l a t e x i t s h a 1 _ b a s e 6 4 = " V 4 N q c Q T + x K x l b y 5 w n 7 l p U A x Z g 8 Q = " > A A A C G H i c b V D L S s N A F J 3 U V 6 2 v q D v d B I v g q i S 1 o M u C C 1 1 W s A 9 p Y 5 h M b 9 q h k w c z E 6 G E g N / h B 7 j V T 3 A n b t 3 5 B f 6 G k z Q L 2 3 p g 4 N x z 7 u X e O W 7 E q J C m + a 2 V V l b X 1 j f K m 5 W t 7 Z 3 d P X 3 / o C P C m B N o k 5 C F v O d i A Y w G 0 J Z U M u h F H L D v M u i 6 k 6 v M 7 z 4 C F z Q M 7 u Q 0 A t v H o 4 B 6 l G C p J E c / G v h Y j l 0 v u U 6 d p J E + 5 C X B L L l P H b 1 q 1 s w c x j K x C l J F B V q O / j M Y h i T 2 I Z C E Y S H 6 l h l J O 8 F c U s I g r Q x i A R E m E z y C v q I B 9 k H Y S f 6 H 1 D h V y t D w Q q 5 e I I 1 c / T u R Y F + I q e + q z u x E s e h l 4 n 9 e P 5 b e p Z 3 Q I I o l B G S 2 y I u Z I U M j C 8 Q Y U g 5 E s q k i m H C q b j X I G H N M p I p t b o t Q u Q A H l i V j L e a w T D r 1 m n V e q 9 8 2 q k 2 z y K i M j t E J O k M W u k B N d I N a q I 0 I e k I v 6 B W 9 a c / a u / a h f c 5 a S 1 o x c 4 j m o H 3 9 A o G 5 o V Q = < / l a t e x i t > G Y 5 < l a t e x i t s h a 1 _ b a s e 6 4 = " V 7 U S 2 R z Z J 4 v J 3 z H J 6 1 F C V 1 e B S c 4 = " > A A A C G H i c b V D L S s N A F J 3 U V 6 2 v q D v d B I v g q i R V 0 W X B h S 4 r 2 I e 0 M U y m N + 3 Q y Y O Z i V B C w O / w A 9 z q J 7 g T t + 7 8 A n / D S Z q F b T 0 w c O 4 5 9 3 L v H D d i V E j T / N Z K S 8 s r q 2 v l 9 c r G 5 t b 2 j r 6 7 1 x Z h z A m 0 S M h C 3 n W x A E Y D a E k q G X Q j D t h 3 G X T c 8 V X m d x 6 B C x o G d 3 I S g e 3 j Y U A 9 S r B U k q M f 9 H 0 s R 6 6 X X K d O c p 4 + 5 C X B L L l P H b 1 q 1 s w c x i K x C l J F B Z q O / t M f h C T 2 I Z C E Y S F 6 l h l J O 8 F c U s I g r f R j A R E m Y z y E n q I B 9 k H Y S f 6 H 1 D h W y s D w Q q 5 e I I 1 c / T u R Y F + I i e + q z u x E M e 9 l 4 n 9 e L 5 b e p Z 3 Q I I o l B G S 6 y I u Z I U M j C 8 Q Y U A 5 E s o k i m H C q b j X I C H N M p I p t Z o t Q u Q A H l i V j z e e w S N r 1 m n V a q 9 + e V R t m k V E Z H a I j d I I s d I E a 6 A Y 1 U Q s R 9 I R e 0 C t 6 0 5 6 1 d + 1 D + 5 y 2 l r R i Z h / N Q P v 6 B Y N f o V U = < / l a t e x i t > G Y 6 < l a t e x i t s h a 1 _ b a s e 6 4 = " K A T V w U A N i 5 0 m B O o T G D w B a n 8 e z i g = " > A A A C G H i c b V D L S s N A F J 3 U V 6 2 v q D v d B I v g q i R V 1 G X B h S 4 r 2 I e 0 M U y m N + 3 Q y Y O Z i V B C w O / w A 9 z q J 7 g T t + 7 8 A n / D S Z q F b T 0 w c O 4 5 9 3 L v H D d i V E j T / N Z K S 8 s r q 2 v l 9 c r G 5 t b 2 j r 6 7 1 x Z h z A m 0 S M h C 3 n W x A E Y D a E k q G X Q j D t h 3 G X T c 8 V X m d x 6 B C x o G d 3 I S g e 3 j Y U A 9 S r B U k q M f 9 H 0 s R 6 6 X X K d O c p 4 + 5 C X B L L l P H b 1 q 1 s w c x i K x C l J F B Z q O / t M f h C T 2 I Z C E Y S F 6 l h l J O 8 F c U s I g r f R j A R E m Y z y E n q I B 9 k H Y S f 6 H 1 D h W y s D w Q q 5 e I I 1 c / T u R Y F + I i e + q z u x E M e 9 l 4 n 9 e L 5 b e p Z 3 Q I I o l B G S 6 y I u Z I U M j C 8 Q Y U A 5 E s o k i m H C q b j X I C H N M p I p t Z o t Q u Q A H l i V j z e e w S N r 1 m n V a q 9 + e V R t m k V E Z H a I j d I I s d I E a 6 A Y 1 U Q s R 9 I R e 0 C t 6 0 5 6 1 d + 1 D + 5 y 2 l r R i Z h / N Q P v 6 B Y U F o V Y = < / l a t e x i t > G X 5 < l a t e x i t s h a 1 _ b a s e 6 4 = " / 6 Y i s M c D 2 n Y 5 Q l 5 g U 7 7 j Q T i s f + Y = " > A A A C G H i c b V D L S s N A F J 3 4 r P U V d a e b Y B F c l a Q q u i y 4 0 G U F + 4 A 2 l s n 0 p h 0 6 m Y S Z i V B C w O / w A 9 z q J 7 g T t + 7 8 A n / D S Z q F b T 0 w c O 4 5 9 3 L v H C 9 i V C r b / j a W l l d W 1 9 Z L G + X N r e 2 d X X N v v y X D W B B o k p C F o u N h C Y x y a C q q G H Q i A T j w G L S 9 8 X X m t x 9 B S B r y e z W J w A 3 w k F O f E q y 0 1 D c P e w F W I 8 9 P b t J + c p E + 5 C X B L O m k f b N i V + 0 c 1 i J x C l J B B R p 9 8 6 c 3 C E k c A F e E Y S m 7 j h 0 p N 8 F C U c I g L f d i C R E m Y z y E r q Y c B y D d J P 9 D a p 1 o Z W D 5 o d C P K y t X / 0 4 k O J B y E n i 6 M z t R z n u Z + J / X j Z V / 5 S a U R 7 E C T q a L / J h Z K r S y Q K w B F U A U m 2 i C i a D 6 V o u M s M B E 6 d h m t k i d C w h g W T L O f A 6 L p F W r O m f V 2 t 1 5 p W 4 X G Z X Q E T p G p 8 h B l 6 i O b l E D N R F B T + g F v a I 3 4 9 l 4 N z 6 M z 2 n r k l H M H K A Z G F + / g c W h V A = = < / l a t e x i t >
X < l a t e x i t s h a 1 _ b a s e 6 4 = " D S q t / 3 Q a 7 / U g 0 Q + g r n i 0 I N 8 O A F 8 = " > A A A C B 3 i c b V D L S g M x F M 3 4 r P V V d e k m W A R X Z a Y K u i y 6 c V n B P m A 6 l E x 6 p w 3 N J E O S E c r Q D / A D 3 O o n u B O 3 f o Z f 4 G + Y a W d h W w 8 E D u f c y z 0 5 Y c K Z N q 7 7 7 a y t b 2 x u b Z d 2 y r t 7 + w e H l a P j t p a p o t C i k k v V D Y k G z g S 0 D D M c u o k C E o c c O u H 4 L v c 7 T 6 A 0 k + L R T B I I Y j I U L G K U G C v 5 v Z i Y E S U 8 6 0 7 7 l a p b c 2 f A q 8 Q r S B U V a P Y r P 7 2 B p G k M w l B O t P Y 9 N z F B R p R h l M O 0 3 E s 1 J I S O y R B 8 S w W J Q Q f Z L P I U n 1 t l g C O p 7 B M G z 9 S / G x m J t Z 7 E o Z 3 M I + p l L x f / 8 / z U R D d B x k S S G h B 0 f i h K O T Y S 5 / / H A 6 a A G j 6 x h F D F b F Z M R 0 Q R a m x L C 1 e 0 7 Q U U 8 L w Z b 7 m H V d K u 1 7 z L W v 3 h q t q 4 L T o q o V N 0 h i 6 Q h 6 5 R A 9 2 j J m o h i i R 6 Q a / o z X l 2 3 p 0 P 5 3 M + u u Y U O y d o A c 7 X L + r v m q g = < / l a t e x i t >
Y < l a t e x i t s h a 1 _ b a s e 6 4 = " w V s e f u j 4 A 7 1 d B p 3 j P z Q + 9 3 d X K x s = " > A A A C B 3 i c b V D L S g M x F M 3 U V 6 2 v q k s 3 w S K 4 K j N V 0 G X R j c s K 9 i H t U D L p n T Y 0 k w x J R i h D P 8 A P c K u f 4 E 7 c + h l + g b 9 h p p 2 F b T 0 Q O J x z L / f k B D F n 2 r j u t 1 N Y W 9 / Y 3 C p u l 3 Z 2 9 / Y P y o d H L S 0 T R a F J J Z e q E x A N n A l o G m Y 4 d G I F J A o 4 t I P x b e a 3 n 0 B p J s W D m c T g R 2 Q o W M g o M V b q 9 i J i R p T w 9 H H a L 1 f c q j s D X i V e T i o o R 6 N f / u k N J E 0 i E I Z y o n X X c 2 P j p 0 Q Z R j l M S 7 1 E Q 0 z o m A y h a 6 k g E W g / n U W e 4 j O r D H A o l X 3 C 4 J n 6 d y M l k d a T K L C T W U S 9 7 G X i f 1 4 3 M e G 1 n z I R J w Y E n R 8 K E 4 6 N x N n / 8 Y A p o I Z P L C F U M Z s V 0 x F R h B r b 0 s I V b X s B B T x r x l v u Y Z W 0 a l X v o l q 7 v 6 z U b / K O i u g E n a J z 5 K E r V E d 3 q I G a i C K J X t A r e n O e n X f n w / m c j x a c f O c Y L c D 5 + g X s i Z q p < / l a t e x i t > G X 1 < l a t e x i t s h a 1 _ b a s e 6 4 = " k 9 W k u K G g i a i q C U B 1 E D 1 V E k o l l N s = " > A A A C G H i c b V D L S s N A F J 3 U V 6 2 v q D v d B I v g q i R V 0 G X B h S 4 r 2 A e 0 s U y m N + 3 Q y S T M T I Q S A n 6 H H + B W P 8 G d u H X n F / g b T t I s b O u B g X P P u Z d 7 5 3 g R o 1 L Z 9 r d R W l l d W 9 8 o b 1 a 2 t n d 2 9 8 z 9 g 7 Y M Y 0 G g R U I W i q 6 H J T D K o a W o Y t C N B O D A Y 9 D x J t e Z 3 3 k E I W n I 7 9 U 0 A j f A I 0 5 9 S r D S 0 s A 8 6 g d Y j T 0 / u U k H i Z M + 5 C X B L O m m A 7 N q 1 + w c 1 j J x C l J F B Z o D 8 6 c / D E k c A F e E Y S l 7 j h 0 p N 8 F C U c I g r f R j C R E m E z y C n q Y c B y D d J P 9 D a p 1 q Z W j 5 o d C P K y t X / 0 4 k O J B y G n i 6 M z t R L n q Z + J / X i 5 V / 5 S a U R 7 E C T m a L / J h Z K r S y Q K w h F U A U m 2 q C i a D 6 V o u M s c B E 6 d j m t k i d C w h g W T L O Y g 7 L p F 2 v O e e 1 + t 1 F t W E X G Z X R M T p B Z 8 h B l 6 i B b l E T t R B B T + g F v a I 3 4 9 l 4 N z 6 M z 1 l r y S h m D t E c j K 9 f e y 2 h U A = = < / l a t e x i t > G X 2 < l a t e x i t s h a 1 _ b a s e 6 4 = " r h C G U P 7 y l x c M U t A W V v 7 8 y 5 I y K 2 8 = " > A A A C G H i c b V D L S s N A F J 3 U V 6 2 v q D v d B I v g q i R V 0 G X B h S 4 r 2 A e 0 s U y m N + 3 Q y S T M T I Q S A n 6 H H + B W P 8 G d u H X n F / g b T t I s b O u B g X P P u Z d 7 5 3 g R o 1 L Z 9 r d R W l l d W 9 8 o b 1 a 2 t n d 2 9 8 z 9 g 7 Y M Y 0 G g R U I W i q 6 H J T D K o a W o Y t C N B O D A Y 9 D x J t e Z 3 3 k E I W n I 7 9 U 0 A j f A I 0 5 9 S r D S 0 s A 8 6 g d Y j T 0 / u U k H S T 1 9 y E u C W d J N B 2 b V r t k 5 r G X i F K S K C j Q H 5 k 9 / G J I 4 A K 4 I w 1 L 2 H D t S b o K F o o R B W u n H E i J M J n g E P U 0 5 D k C 6 S f 6 H 1 D r V y t D y Q 6 E f V 1 a u / p 1 I c C D l N P B 0 Z 3 a i X P Q y 8 T + v F y v / y k 0 o j 2 I F n M w W + T G z V G h l g V h D K o A o N t U E E 0 H 1 r R Y Z Y 4 G J 0 r H N b Z E 6 F x D A s m S c x R y W S b t e c 8 5 r 9 b u L a s M u M i q j Y 3 S C z p C D L l E D 3 a I m a i G C n t A L e k V v x r P x b n w Y n 7 P W k l H M H K I 5 G F + / f N O h U Q = = < / l a t e x i t > G X 3 < l a t e x i t s h a 1 _ b a s e 6 4 = " G G m n j J W g B u b b J g j X J t t n N Z c x V 6 g = " > A A A C G H i c b V D L S s N A F J 3 4 r P U V d a e b Y B F c l a Q V d F l w o c s K 9 g F t L J P p T T t 0 M g k z E 6 G E g N / h B 7 j V T 3 A n b t 3 5 B f 6 G k z Q L 2 3 p g 4 N x z 7 u X e O V 7 E q F S 2 / W 2 s r K 6 t b 2 y W t s r b O 7 t 7 + + b B Y V u G s S D Q I i E L R d f D E h j l 0 F J U M e h G A n D g M e h 4 k + v M 7 z y C k D T k 9 2 o a g R v g E a c + J V h p a W A e 9 w O s x p 6 f 3 K S D p J 4 + 5 C X B L O m m A 7 N i V + 0 c 1 j J x C l J B B Z o D 8 6 c / D E k c A F e E Y S l 7 j h 0 p N 8 F C U c I g L f d j C R E m E z y C n q Y c B y D d J P 9 D a p 1 p Z W j 5 o d C P K y t X / 0 4 k O J B y G n i 6 M z t R L n q Z + J / X i 5 V / 5 S a U R 7 E C T m a L / J h Z K r S y Q K w h F U A U m 2 q C i a D 6 V o u M s c B E 6 d j m t k i d C w h g W T L O Y g 7 L p F 2 r O v V q 7 e 6 i 0 r C L j E r o B J 2 i c + S g S 9 R A t 6 i J W o i g J / S C X t G b 8 W y 8 G x / G 5 6 x 1 x S h m j t A c j K 9 f f n m h U g = = < / l a t e x i t > G X 4 < l a t e x i t s h a 1 _ b a s e 6 4 = " R Q R W p R 4 w E M / z C K 6 M y W q y d o g i Q + w = " > A A A C G H i c b V D L S s N A F J 3 4 r P U V d a e b Y B F c l a Q W d F l w o c s K 9 g F t L J P p T T t 0 M g k z E 6 G E g N / h B 7 j V T 3 A n b t 3 5 B f 6 G k z Q L 2 3 p g 4 N x z 7 u X e O V 7 E q F S 2 / W 2 s r K 6 t b 2 y W t s r b O 7 t 7 + + b B Y V u G s S D Q I i E L R d f D E h j l 0 F J U M e h G A n D g M e h 4 k + v M 7 z y C k D T k 9 2 o a g R v g E a c + J V h p a W A e 9 w O s x p 6 f 3 K S D p J 4 + 5 C X B L O m m A 7 N i V + 0 c 1 j J x C l J B B Z o D 8 6 c / D E k c A F e E Y S l 7 j h 0 p N 8 F C U c I g L f d j C R E m E z y C n q Y c B y D d J P 9 D a p 1 p Z W j 5 o d C P K y t X / 0 4 k O J B y G n i 6 M z t R L n q Z + J / X i 5 V / 5 S a U R 7 E C T m a L / J h Z K r S y Q K w h F U A U m 2 q C i a D 6 V o u M s c B E 6 d j m t k i d C w h g W T L O Y g 7 L p F 2 r O h f V 2 l 2 9 0 r C L j E r o B J 2 i c + S g S 9 R A t 6 i J W o i g J / S C X t G b 8 W y 8 G x / G 5 6 x 1 x S h m j t A c j K 9 f g B + h U w = = < / l a t 6 O o = " > A A A C G H i c b V D L S s N A F J 3 4 r P U V d a e b Y B F c l a S K u i y 4 0 G U F + 4 A 2 l s n 0 p h 0 6 m Y S Z i V B C w O / w A 9 z q J 7 g T t + 7 8 A n / D S Z q F b T 0 w c O 4 5 9 3 L v H C 9 i V C r b / j a W l l d W 1 9 Z L G + X N r e 2 d X X N v v y X D W B B o k p C F o u N h C Y x y a C q q G H Q i A T j w G L S 9 8 X X m t x 9 B S B r y e z W J w A 3 w k F O f E q y 0 1 D c P e w F W I 8 9 P b t J + c p E + 5 C X B L O m k f b N i V + 0 c 1 i J x C l J B B R p 9 8 6 c 3 C E k c A F e E Y S m 7 j h 0 p N 8 F C U c I g L f d i C R E m Y z y E r q Y c B y D d J P 9 D a p 1 o Z W D 5 o d C P K y t X / 0 4 k O J B y E n i 6 M z t R z n u Z + J / X j Z V / 5 S a U R 7 E C T q a L / J h Z K r S y Q K w B F U A U m 2 i C i a D 6 V o u M s M B E 6 d h m t k i d C w h g W T L O f A 6 L p F W r O m f V 2 t 1 5 p W 4 X G Z X Q E T p G p 8 h B l 6 i O b l E D N R F B T + g F v a I 3 4 9 l 4 N z 6 M z 2 n r k l H M H K A Z G F + / g 2 u h V Q = = < / l a t e x i t > G Y 1 < l a t e x i t s h a 1 _ b a s e 6 4 = " z 1 X M 2 O h h T g c 5 1 F a x M G + 3 w l S z 3 z s = " > A A A C G H i c b V D L S s N A F J 3 4 r P U V d a e b w S K 4 K k k V d F l w o c s K 9 i F t D J P p T T t 0 8 m B m I p Q Q 8 D v 8 A L f 6 C e 7 E r T u / w N 9 w 0 m Z h W w 8 M n H v O v d w 7 x 4 s 5 k 8 q y v o 2 l 5 Z X V t f X S R n l z a 3 t n 1 9 z b b 8 k o E R S a N O K R 6 H h E A m c h N B V T H D q x A B J 4 H N r e 6 C r 3 2 4 8 g J I v C O z W O w Q n I I G Q + o 0 R p y T U P e w F R Q 8 9 P r z M 3 t b O H S U k J T + 8 z 1 6 x Y V W s C v E j s g l R Q g Y Z r / v T 6 E U 0 C C B X l R M q u b c X K S Y l Q j H L I y r 1 E Q k z o i A y g q 2 l I A p B O O v l D h k + 0 0 s d + J P Q L F Z 6 o f y d S E k g 5 D j z d m Z 8 o 5 7 1 c / M / r J s q / d F I W x o m C k E 4 X + Q n H K s J 5 I L j P B F D F x 5 o Q K p i +
F d M h E Y Q q H d v M F q l z A Q E 8 T 8 a e z 2 G R t G p V + 6 x a u z 2 v 1 K 0 i o x I 6 Q s f o F N n o A t X R D W q g J q L o C b 2 g V / R m P B v v x o f x O W 1 d M o q Z A z Q D 4 + s X f M e h U Q = = < / l a t e x i t > G Y 2 < l a t e x i t s h a 1 _ b a s e 6 4 = " d R P V 3 s m a 7 e N H K j L c j Q e z Y y o M / 8 8 = " > A A A C Q X i c b V D L S s N A F J 3 4 f h t 1 6 S Z Y B B d S k l r b u i u 4 0 G U F + 5 A 2 l s n 0 p g 6 d P J i Z C G X I B / k d f o B b + w X i T t y 6 c Z J W 8 H V g 4 M y 5 r 8 P x Y k a F t O 2 J M T e / s L i 0 v L K 6 t r 6 x u b V t 7 u y 2 R J R w A k 0 S s Y h 3 P C y A 0 R C a k k o G n Z g D D j w G b W 9 0 n t X b 9 8 A F j c J r O Y 7 B D f A w p D 4 l W G q p b 5 6 r X r 6 k y 4 e e q + z i W e W 0 U q s e 2 0 U 7 R 0 b K l Z J j p 7 0 A y z v P V x d p X 5 X S 2 / x L M F M 3 a d o 3 C 1 / 9 1 l / i z E g B z d D o m y + 9 Q U S S A E J J G B a i 6 9 i x d B X m k h I G 6 V o v E R B j M s J D 6 G o a 4 g C E q 3 K f q X W o l Y H l R 1 y / U F q 5 + n 1 C 4 U C I c e D p z s y j + F 3 L x P 9 q 3 U T 6 N V f R M E 4 k h G R 6 y E + Y J S M r S 8 4 a U A 5 E s r E m m H C q v V r k D n N M p M 7 3 x x W h g w E O L E v G + Z 3 D X 9 I q F Z 2 T Y u m q X K j b s 4 x W 0 D 4 6 Q E f I Q V V U R 5 e o g Z q I o A f 0 h J 7 R x H g 0 X o 0 3 4 3 3 a O m f M Z v b Q D x g f n 9 z n r l I = < / l a t e x i t >
G Y 3 < l a t e x i t s h a 1 _ b a s e 6 4 = " W C Q x a E e N X u 9 A u f b l 2 y A + f Y O 1 y G g = " > A A A C G H i c b V D L S s N A F J 3 U V 6 2 v q D v d B I v g q i S t o M u C C 1 1 W s A 9 p Y 5 h M b 9 q h k w c z E 6 G E g N / h B 7 j V T 3 A n b t 3 5 B f 6 G k z Q L 2 3 p g 4 N x z 7 u X e O W 7 E q J C m + a 2 V V l b X 1 j f K m 5 W t 7 Z 3 d P X 3 / o C P C m B N o k 5 C F v O d i A Y w G 0 J Z U M u h F H L D v M u i 6 k 6 v M 7 z 4 C F z Q M 7 u Q 0 A t v H o 4 B 6 l G C p J E c / G v h Y j l 0 v u U 6 d p J E + 5 C X B L L l P H b 1 q 1 s w c x j K x C l J F B V q O / j M Y h i T 2 I Z C E Y S H 6 l h l J O 8 F c U s I g r Q x i A R E m E z y C v q I B 9 k H Y S f 6 H 1 D h V y t D w Q q 5 e I I 1 c / T u R Y F + I q e + q z u x E s e h l 4 n 9 e P 5 b e p Z 3 Q I I o l B G S 2 y I u Z I U M j C 8 Q Y U g 5 E s q k i m H C q b j X I G H N M p I p t b o t Q u Q A H l i V j L e a w T D r 1 m t W o 1 W / P q 0 2 z y K i M j t E J O k M W u k B N d I N a q I 0 I e k I v 6 B W 9 a c / a u / a h f c 5 a S 1 o x c 4 j m o H 3 9 A o A T o V M = < / l a t e x i t > G Y 4 < l a t e x i t s h a 1 _ b a s e 6 4 = " V 4 N q c Q T + x K x l b y 5 w n 7 l p U A x Z g 8 Q = " > A A A C G H i c b V D L S s N A F J 3 U V 6 2 v q D v d B I v g q i S 1 o M u C C 1 1 W s A 9 p Y 5 h M b 9 q h k w c z E 6 G E g N / h B 7 j V T 3 A n b t 3 5 B f 6 G k z Q L 2 3 p g 4 N x z 7 u X e O W 7 E q J C m + a 2 V V l b X 1 j f K m 5 W t 7 Z 3 d P X 3 / o C P C m B N o k 5 C F v O d i A Y w G 0 J Z U M u h F H L D v M u i 6 k 6 v M 7 z 4 C F z Q M 7 u Q 0 A t v H o 4 B 6 l G C p J E c / G v h Y j l 0 v u U 6 d p J E + 5 C X B L L l P H b 1 q 1 s w c x j K x C l J F B V q O / j M Y h i T 2 I Z C E Y S H 6 l h l J O 8 F c U s I g r Q x i A R E m E z y C v q I B 9 k H Y S f 6 H 1 D h V y t D w Q q 5 e I I 1 c / T u R Y F + I q e + q z u x E s e h l 4 n 9 e P 5 b e p Z 3 < l a t e x i t s h a 1 _ b a s e 6 4 = " 9 0 X X e b X x 9 f g v 2 9 h j f B P L A + 3 7 Q I I o l B G S 2 y I u Z I U M j C 8 Q Y U g 5 E s q k i m H C q b j X I G H N M p I p t b o t Q u Q A H l i V j L e a w T D r 1 m n V e q 9 8 2 q k 2 z y K i M j t E J O k M W u k B N d I N a q I 0 I e k I v 6 B W 9 a c / a u / a h f c 5 a S 1 o x c 4 j m o H 3 9 A o G 5 o V Q = < / l a t e x i t > G Y 5 < l a t e x i t s h a 1 _ b a s e 6 4 = " V 7 U S 2 R z Z J 4 v J 3 z H J 6 1 F C V 1 e B S c 4 = " > A A A C G H i c b V D L S s N A F J 3 U V 6 2 v q D v d B I v g q i R V 0 W X B h S 4 r 2 I e 0 M U y m N + 3 Q y Y O Z i V B C w O / w A 9 z q J 7 g T t + 7 8 A n / D S Z q F b T 0 w c O 4 5 9 3 L v H D d i V E j T / N Z K S 8 s r q 2 v l 9 c r G 5 t b 2 j r 6 7 1 x Z h z A m 0 S M h C 3 n W x A E Y D a E k q G X Q j D t h 3 G X T c 8 V X m d x 6 B C x o G d 3 I S g e 3 j Y U A 9 S r B U k q M f 9 H 0 s R 6 6 X X K d O c p 4 + 5 C X B L L l P H b 1 q 1 s w c x i K x C l J F B Z q O / t M f h C T 2 I Z C E Y S F 6 l h l J O 8 F c U s I g r f R j A R E m Y z y E n q I B 9 k H Y S f Z I U M j C 8 Q Y U A 5 E s o k i m H C q b j X I C H N M p I p t Z o t Q u Q A H l i V j z e e w S N r 1 m n V a q 9 + e V R t m k V E Z H a I j d I I s d I E a 6 A Y 1 U Q s R 9 I R e 0 C t 6 0 5 6 1 d + 1 D + 5 y 2 l r R i Z h / N Q P v 6 B Y N f o V U = < / l a t e x i t > G Y 6 < l a t e x i t s h a 1 _ b a s e 6 4 = " K A T V w U A N i 5 0 m B O o T G D w B a n 8 e z i g = " > A A A C G H i c b V D L S s N A F J 3 U V 6 2 v q D v d B I v g q i R V 1 G X B h S 4 r 2 I e 0 M U y m N + 3 Q y Y O Z i V B C w O / w A 9 z q J 7 g T t + 7 8 A n / D S Z q F b T 0 w c O 4 5 9 3 L v H D d i V E j T / N Z K S 8 s r q 2 v l 9 c r G 5 t b 2 j r 6 7 1 x Z h z A m 0 S M h C 3 n W x A E Y D a E k q G X Q j D t h 3 G X T c 8 V X m d x 6 B C x o G d 3 I S g e 3 j Y U A 9 S r B U k q M f 9 H 0 s R 6 6 X X K d O c p 4 + 5 C X B L L l P H b 1 q 1 s w c x i K x C l J F B Z q O / t M f h C T 2 I Z C E Y S F 6 l h l J O 8 F c U s I g r f R j A R E m Y z y E n q I B 9 k H Y S f Z I U M j C 8 Q Y U A 5 E s o k i m H C q b j X I C H N M p I p t Z o t Q u Q A H l i V j z e e w S N r 1 m n V a q 9 + e V R t m k V E Z H a I j d I I s d I E a 6 A Y 1 U Q s R 9 I R e 0 C t 6 0 5 6 1 d + 1 D + 5 y 2 l r R i Z h / N Q P v 6 B Y U F o V Y = < / l a t e x i t > G X 5 < l a t e x i t s h a 1 _ b a s e 6 4 = " / 6 Y i s M c D 2 n Y 5 Q l 5 g U 7 7 j Q T i s f + Y = " > A A A C G H i c b V D L S s N A F J 3 4 r P U V d a e b Y B F c l a Q q u i y 4 0 G U F + 4 A 2 l s n 0 p h 0 6 m Y S Z i V B C w O / w A 9 z q J 7 g T t + 7 8 A n / D S Z q F b T 0 w c O 4 5 9 3 L v H C 9 i V C r b / j a W l l d W 1 9 Z L G + X N r e 2 d X X N v v y X D W B B o k p C F o u N h C Y x y a C q q G H Q i A T j w G L S 9 8 X X m t x 9 B S B r y e z W J w A 3 w k F O f E q y 0 1 D c P e w F W I 8 9 P b t J + c p E + 5 C X B L O m k f b N i V + 0 c 1 i J x C l J B B R p 9 8 6 c 3 C E k c A F e E Y S m 7 j h 0 p N 8 F C U c I g L f d i C R E m Y z y E r q Y c B y D d J P 9 D a p 1 o Z W D 5 o d C P K y t X / 0 4 k O J B y E n i 6 M z t R z n u Z + J / X j Z V / 5 S a U R 7 E C T q a L / J h Z K r S y Q K w B F U A U m 2 i C i a D 6 V o u M s M B E 6 d h m t k i d C w h g W T L O f A 6 L p F W r O m f V 2 t 1 5 p W 4 X G Z X Q E T p G p 8 h B l 6 i O b l E D N R F B T + g F v a I 3 4 9 l 4 N z 6 M z 2 n r k l H M H K A Z G F + / g c W h V A = = < / l a t e x i t > G X 1 < l a t e x i t s h a 1 _ b a s e 6 4 = " k 9 W k u K G g i a i q C U B 1 E D 1 V E k o l l N s = " > A A A C G H i c b V D L S s N A F J 3 U V 6 2 v q D v d B I v g q i R V 0 G X B h S 4 r 2 A e 0 s U y m N + 3 Q y S T M T I Q S A n 6 H H + B W P 8 G d u H X n F / g b T t I s b O u B g X P P u Z d 7 5 3 g R o 1 L Z 9 r d R W l l d W 9 8 o b 1 a 2 t n d 2 9 8 z 9 g 7 Y M Y 0 G g R U I W i q 6 H J T D K o a W o Y t C N B O D A Y 9 D x J t e Z 3 3 k E I W n I 7 9 U 0 A j f A I 0 5 9 S r D S 0 s A 8 6 g d Y j T 0 / u U k H i Z M + 5 C X B L O m m A 7 N q 1 + w c 1 j J x C l J F B Z o D 8 6 c / D E k c A F e E Y S l 7 j h 0 p N 8 F C U c I g r f R j C R E m E z y C n q Y c B y D d J P 9 D a p 1 q Z W j 5 o d C P K y t X / 0 4 k O J B y G n i 6 M z t R L n q Z + J / X i 5 V / 5 S a U R 7 E C T m a L / J h Z K r S y Q K w h F U A U m 2 q C i a D 6 V o u M s c B E 6 d j m t k i d C w h g W T L O Y g 7 L p F 2 v O e e 1 + t 1 F t W E X G Z X R M T p B Z 8 h B l 6 i B b l E T t R B B T + g F v a I 3 4 9 l 4 N z 6 M z 1 l r y S h m D t E c j K 9 f e y 2 h U A = = < / l a t e x i t > G X 2 < l a t e x i t s h a 1 _ b a s e 6 4 = " r h C G U P 7 y l x c M U t A W V v 7 8 y 5 I y K 2 8 = " > A A A C G H i c b V D L S s N A F J 3 U V 6 2 v q D v d B I v g q i R V 0 G X B h S 4 r 2 A e 0 s U y m N + 3 Q y S T M T I Q S A n 6 H H + B W P 8 G d u H X n F / g b T t I s b O u B g X P P u Z d 7 5 3 g R o 1 L Z 9 r d R W l l d W 9 8 o b 1 a 2 t n d 2 9 8 z 9 g 7 Y M Y 0 G g R U I W i q 6 H J T D K o a W o Y t C N B O D A Y 9 D x J t e Z 3 3 k E I W n I 7 9 U 0 A j f A I 0 5 9 S r D S 0 s A 8 6 g d Y j T 0 / u U k H S T 1 9 y E u C W d J N B 2 b V r t k 5 r G X i F K S K C j Q H 5 k 9 / G J I 4 A K 4 I w 1 L 2 H D t S b o K F o o R B W u n H E i J M J n g E P U 0 5 D k C 6 S f 6 H 1 D r V y t D y Q 6 E f V 1 a u / p 1 I c C D l N P B 0 Z 3 a i X P Q y 8 T + v F y v / y k 0 o j 2 I F n M w W + T G z V G h l g V h D K o A o N t U E E 0 H 1 r R Y Z Y 4 G J 0 r H N b Z E 6 F x D A s m S c x R y W S b t e c 8 5 r 9 b u L a s M u M i q j Y 3 S C z p C D L l E D 3 a I m a i G C n t A L e k V v x r P x b n w Y n 7 P W k l H M H K I 5 G F + / f N O h U Q = = < / l a t e x i t > G X 3 < l a t e x i t s h a 1 _ b a s e 6 4 = " G G m n j J W g B u b b J g j X J t t n N Z c x V 6 g = " > A A A C G H i c b V D L S s N A F J 3 4 r P U V d a e b Y B F c l a Q V d F l w o c s K 9 g F t L J P p T T t 0 M g k z E 6 G E g N / h B 7 j V T 3 A n b t 3 5 B f 6 G k z Q L 2 3 p g 4 N x z 7 u X e O V 7 E q F S 2 / W 2 s r K 6 t b 2 y W t s r b O 7 t 7 + + b B Y V u G s S D Q I i E L R d f D E h j l 0 F J U M e h G A n D g M e h 4 k + v M 7 z y C k D T k 9 2 o a g R v g E a c + J V h p a W A e 9 w O s x p 6 f 3 K S D p J 4 + 5 C X B L O m m A 7 N i V + 0 c 1 j J x C l J B B Z o D 8 6 c / D E k c A F e E Y S l 7 j h 0 p N 8 F C U c I g L f d j C R E m E z y C n q Y c B y D d J P 9 D a p 1 p Z W j 5 o d C P K y t X / 0 4 k O J B y G n i 6 M z t R L n q Z + J / X i 5 V / 5 S a U R 7 E C T m a L / J h Z K r S y Q K w h F U A U m 2 q C i a D 6 V o u M s c B E 6 d j m t k i d C w h g W T L O Y g 7 L p F 2 r O v V q 7 e 6 i 0 r C L j E r o B J 2 i c + S g S 9 R A t 6 i J W o i g J / S C X t G b 8 W y 8 G x / G 5 6 x 1 x S h m j t A c j K 9 f f n m h U g = = < / l a t e x i t > G X 4 < l a t e x i t s h a 1 _ b a s e 6 4 = " R Q R W p R 4 w E M / z C K 6 M y W q y d o g i Q + w = " > A A A C G H i c b V D L S s N A F J 3 4 r P U V d a e b Y B F c l a Q W d F l w o c s K 9 g F t L J P p T T t 0 M g k z E 6 G E g N / h B 7 j V T 3 A n b t 3 5 B f 6 G k z Q L 2 3 p g 4 N x z 7 u X e O V 7 E q F S 2 / W 2 s r K 6 t b 2 y W t s r b O 7 t 7 + + b B Y V u G s S D Q I i E L R d f D E h j l 0 F J U M e h G A n D g M e h 4 k + v M 7 z y C k D T k 9 2 o a g R v g E a c + J V h p a W A e 9 w O s x p 6 f 3 K S D p J 4 + 5 C X B L O m m A 7 N i V + 0 c 1 j J x C l J B B Z o D 8 6 c / D E k c A F e E Y S l 7 j h 0 p N 8 F C U c I g L f d j C R E m E z y C n q Y c B y D d J P 9 D a p 1 p Z W j 5 o d C P K y t X / 0 4 k O J B y G n i 6 M z t R L n q Z + J / X i 5 V / 5 S a U R 7 E C T m a L / J h Z K r S y Q K w h F U A U m 2 q C i a D 6 V o u M s c B E 6 d j m t k i d C w h g W T L O Y g 7 L p F 2 r O h f V 2 l 2 9 0 r C L j E r o B J 2 i c + S g S 9 R A t 6 i J W o i g J / S C X t G b 8 W y 8 G x / G 5 6 x 1 x S h m j t A c j K 9 f g B + h U w = = < / l a t 6 O o = " > A A A C G H i c b V D L S s N A F J 3 4 r P U V d a e b Y B F c l a S K u i y 4 0 G U F + 4 A 2 l s n 0 p h 0 6 m Y S Z i V B C w O / w A 9 z q J 7 g T t + 7 8 A n / D S Z q F b T 0 w c O 4 5 9 3 L v H C 9 i V C r b / j a W l l d W 1 9 Z L G + X N r e 2 d X X N v v y X D W B B o k p C F o u N h C Y x y a C q q G H Q i A T j w G L S 9 8 X X m t x 9 B S B r y e z W J w A 3 w k F O f E q y 0 1 D c P e w F W I 8 9 P b t J + c p E + 5 C X B L O m k f b N i V + 0 c 1 i J x C l J B B R p 9 8 6 c 3 C E k c A F e E Y S m 7 j h 0 p N 8 F C U c I g L f d i C R E m Y z y E r q Y c B y D d J P 9 D a p 1 o Z W D 5 o d C P K y t X / 0 4 k O J B y E n i 6 M z t R z n u Z + J / X j Z V / 5 S a U R 7 E C T q a L / J h Z K r S y Q K w B F U A U m 2 i C i a D 6 V o u M s M B E 6 d h m t k i d C w h g W T L O f A 6 L p F W r O m f V 2 t 1 5 p W 4 X G Z X Q E T p G p 8 h B l 6 i O b l E D N R F B T + g F v a I 3 4 9 l 4 N z 6 M z 2 n r k l H M H K A Z G F + / g 2 u h V Q = = < / l a t e x i t > G Y 1 < l a t e x i t s h a 1 _ b a s e 6 4 = " z 1 X M 2 O h h T g c 5 1 F a x M G + 3 w l S z 3 z s = " > A A A C G H i c b V D L S s N A F J 3 4 r P U V d a e b w S K 4 K k k V d F l w o c s K 9 i F t D J P p T T t 0 8 m B m I p Q Q 8 D v 8 A L f 6 C e 7 E r T u / w N 9 w 0 m Z h W w 8 M n H v O v d w 7 x 4 s 5 k 8 q y v o 2 l 5 Z X V t f X S R n l z a 3 t n 1 9 z b b 8 k o E R S a N O K R 6 H h E A m c h N B V T H D q x A B J 4 H N r e 6 C r 3 2 4 8 g J I v C O z W O w Q n I I G Q + o 0 R p y T U P e w F R Q 8 9 P r z M 3 t b O H S U k J T + 8 z 1 6 x Y V W s C v E j s g l R Q g Y Z r / v T 6 E U 0 C C B X l R M q u b c X K S Y l Q j H L I y r 1 E Q k z o i A y g q 2 l I A p B O O v l D h k + 0 0 s d + J P Q L F Z 6 o f y d S E k g 5 D j z d m Z 8 o 5 7 1 c / M / r J s q / d F I W x o m C k E 4 X + Q n H K s J 5 I L j P B F D F x 5 o Q K p i +
F d M h E Y Q q H d v M F q l z A Q E 8 T 8 a e z 2 G R t G p V + 6 x a u z 2 v 1 K 0 i o x I 6 Q s f o F N n o A t X R D W q g J q L o C b 2 g V / R m P B v v x o f x O W 1 d M o q Z A z Q D 4 + s X f M e h U Q = = < / l a t e x i t > G Y 2 < l a t e x i t s h a 1 _ b a s e 6 4 = " d R P V 3 s m a 7 e N H K j L c j Q e z Y y o M / 8 8 = " > A A A C Q X i c b V D L S s N A F J 3 4 f h t 1 6 S Z Y B B d S k l r b u i u 4 0 G U F + 5 A 2 l s n 0 p g 6 d P J i Z C G X I B / k d f o B b + w X i T t y 6 c Z J W 8 H V g 4 M y 5 r 8 P x Y k a F t O 2 J M T e / s L i 0 v L K 6 t r 6 x u b V t 7 u y 2 R J R w A k 0 S s Y h 3 P C y A 0 R C a k k o G n Z g D D j w G b W 9 0 n t X b 9 8 A F j c J r O Y 7 B D f A w p D 4 l W G q p b 5 6 r X r 6 k y 4 e e q + z i W e W 0 U q s e 2 0 U 7 R 0 b K l Z J j p 7 0 A y z v P V x d p X 5 X S 2 / x L M F M 3 a d o 3 C 1 / 9 1 l / i z E g B z d D o m y + 9 Q U S S A E J J G B a i 6 9 i x d B X m k h I G 6 V o v E R B j M s J D 6 G o a 4 g C E q 3 K f q X W o l Y H l R 1 y / U F q 5 + n 1 C 4 U C I c e D p z s y j + F 3 L x P 9 q 3 U T 6 N V f R M E 4 k h G R 6 y E + Y J S M r S 8 4 a U A 5 E s r E m m H C q v V r k D n N M p M 7 3 x x W h g w E O L E v G + Z 3 D X 9 I q F Z 2 T Y u m q X K j b s 4 x W 0 D 4 6 Q E f I Q V V U R 5 e o g Z q I o A f 0 h J 7 R x H g 0 X o 0 3 4 3 3 a O m f M Z v b Q D x g f n 9 z n r l I = < / l a t e x i t >
G Y 3 < l a t e x i t s h a 1 _ b a s e 6 4 = " W C Q x a E e N X u 9 A u f b l 2 y A + f Y O 1 y G g = " > A A A C G H i c b V D L S s N A F J 3 U V 6 2 v q D v d B I v g q i S t o M u C C 1 1 W s A 9 p Y 5 h M b 9 q h k w c z E 6 G E g N / h B 7 j V T 3 A n b t 3 5 B f 6 G k z Q L 2 3 p g 4 N x z 7 u X e O W 7 E q J C m + a 2 V V l b X 1 j f K m 5 W t 7 Z 3 d P X 3 / o C P C m B N o k 5 C F v O d i A Y w G 0 J Z U M u h F H L D v M u i 6 k 6 v M 7 z 4 C F z Q M 7 u Q 0 A t v H o 4 B 6 l G C p J E c / G v h Y j l 0 v u U 6 d p J E + 5 C X B L L l P H b 1 q 1 s w c x j K x C l J F B V q O / j M Y h i T 2 I Z C E Y S H 6 l h l J O 8 F c U s I g r Q x i A R E m E z y C v q I B 9 k H Y S f 6 H 1 D h V y t D w Q q 5 e I I 1 c / T u R Y F + I q e + q z u x E s e h l 4 n 9 e P 5 b e p Z 3 Q I I o l B G S 2 y I u Z I U M j C 8 Q Y U g 5 E s q k i m H C q b j X I G H N M p I p t b o t Q u Q A H l i V j L e a w T D r 1 m t W o 1 W / P q 0 2 z y K i M j t E J O k M W u k B N d I N a q I 0 I e k I v 6 B W 9 a c / a u / a h f c 5 a S 1 o x c 4 j m o H 3 9 A o A T o V M = < / l a t e x i t > G Y 4 < l a t e x i t s h a 1 _ b a s e 6 4 = " V 4 N q c Q T + x K x l b y 5 w n 7 l p U A x Z g 8 Q = " > A A A C G H i c b V D L S s N A F J 3 U V 6 2 v q D v d B I v g q i S 1 o M u C C 1 1 W s A 9 p Y 5 h M b 9 q h k w c z E 6 G E g N / h B 7 j V T 3 A n b t 3 5 B f 6 G k z Q L 2 3 p g 4 N x z 7 u X e O W 7 E q J C m + a 2 V V l b X 1 j f K m 5 W t 7 Z 3 d P X 3 / o C P C m B N o k 5 C F v O d i A Y w G 0 J Z U M u h F H L D v M u i 6 k 6 v M 7 z 4 C F z Q M 7 u Q 0 A t v H o 4 B 6 l G C p J E c / G v h Y j l 0 v u U 6 d p J E + 5 C X B L L l P H b 1 q 1 s w c x j K x C l J F B V q O / j M Y h i T 2 I Z C E Y S H 6 l h l J O 8 F c U s I g r Q x i A R E m E z y C v q I B 9 k H Y S f 6 H 1 D h V y t D w Q q 5 e I I 1 c / T u R Y F + I q e + q z u x E s e h l 4 n 9 e P 5 b e p Z 3 Q I I o l B G S 2 y I u Z I U M j C 8 Q Y U g 5 E s q k i m H C q b j X I G H N M p I p t b o t Q u Q A H l i V j L e a w T D r 1 m n V e q 9 8 2 q k 2 z y K i M j t E J O k M W u k B N d I N a q I 0 I e k I v 6 B W 9 a c / a u / a h f c 5 a S 1 o x c 4 j m o H 3 9 A o G 5 o V Q = < / l a t e x i t > G Y 5 < l a t e x i t s h a 1 _ b a s e 6 4 = " V 7 U S 2 R z Z J 4 v J 3 z H J 6 1 F C V 1 e B S c 4 = " > A A A C G H i c b V D L S s N A F J 3 U V 6 2 v q D v d B I v g q i R V 0 W X B h S 4 r 2 I e 0 M U y m N + 3 Q y Y O Z i V B C w O / w A 9 z q J 7 g T t + 7 8 A n / D S Z q F b T 0 w c O 4 5 9 3 L v H D d i V E j T / N Z K S 8 s r q 2 v l 9 c r G 5 t b 2 j r 6 7 1 x Z h z A m 0 S M h C 3 n W x A E Y D a E k q G X Q j D t h 3 G X T c 8 V X m d x 6 B C x o G d 3 I S g e 3 j Y U A 9 S r B U k q M f 9 H 0 s R 6 6 X X K d O c p 4 + 5 C X B L L l P H b 1 q 1 s w c x i K x C l J F B Z q O / t M f h C T 2 I Z C E Y S F 6 l h l J O 8 F c U s I g r f R j A R E m Y z y E n q I B 9 k H Y S f 6 H 1 D h W y s D w Q q 5 e I I 1 c / T u R Y F + I i e + q z u x E M e 9 l 4 n 9 e L 5 b e p Z 3 Q I I o l B G S 6 y I u Z I U M j C 8 Q Y U A 5 E s o k i m H C q b j X I C H N M p I p t Z o t Q u Q A H l i V j z e e w S N r 1 m n V a q 9 + e V R t m k V E Z H a I j d I I s d I E a 6 A Y 1 U Q s R 9 I R e 0 C t 6 0 5 6 1 d + 1 D + 5 y 2 l r R i Z h / N Q P v 6 B Y N f o V U = < / l a t e x i t > G Y 6 < l a t e x i t s h a 1 _ b a s e 6 4 = " K A T V w U A N i 5 0 m B O o T G D w B a n 8 e z i g = " > A A A C G H i c b V D L S s N A F J 3 U V 6 2 v q D v d B I v g q i R V 1 G X B h S 4 r 2 I e 0 M U y m N + 3 Q y Y O Z i V B C w O / w A 9 z q J 7 g T t + 7 8 A n / D S Z q F b T 0 w c O 4 5 9 3 L v H D d i V E j T / N Z K S 8 s r q 2 v l 9 c r G 5 t b 2 j r 6 7 1 x Z h z A m 0 S M h C 3 n W x A E Y D a E k q G X Q j D t h 3 G X T c 8 V X m d x 6 B C x o G d 3 I S g e 3 j Y U A 9 S r B U k q M f 9 H 0 s R 6 6 X X K d O c p 4 + 5 C X B L L l P H b 1 q 1 s w c x i K x C l J F B Z q O / t M f h C T 2 I Z C E Y S F 6 l h l J O 8 F c U s I g r f R j A R E m Y z y E n q I B 9 k H Y S f 6 H 1 D h W y s D w Q q 5 e I I 1 c / T u R Y F + I i e + q z u x E M e 9 l 4 n 9 e L 5 b e p Z 3 Q I I o l B G S 6 y I u Z I U M j C 8 Q Y U A 5 E s o k i m H C q b j X I C H N M p I p t Z o t Q u Q A H l i V j z e e w S N r 1 m n V a q 9 + e V R t m k V E Z H a I j d I I s d I E a 6 A Y 1 U Q s R 9 I R e 0 C t 6 0 5 6 1 d + 1 D + 5 y 2 l r R i Z h / N Q P v 6 B Y U F o V Y = < / l a t e x i t > G X 5 < l a t e x i t s h a 1 _ b a s e 6 4 = " / 6 Y i s M c D 2 n Y 5 Q l 5 g U 7 7 j Q T i s f + Y = " > A A A C G H i c b V D L S s N A F J 3 4 r P U V d a e b Y B F c l a Q q u i y 4 0 G U F + 4 A 2 l s n 0 p h 0 6 m Y S Z i V B C w O / w A 9 z q J 7 g T t + 7 8 A n / D S Z q F b T 0 w c O 4 5 9 3 L v H C 9 i V C r b / j a W l l d W 1 9 Z L G + X N r e 2 d X X N v v y X D W B B o k p C F o u N h C Y x y a C q q G H Q i A T j w G L S 9 8 X X m t x 9 B S B r y e z W J w A 3 w k F O f E q y 0 1 D c P e w F W I 8 9 P b t J + c p E + 5 C X B L O m k f b N i V + 0 c 1 i J x C l J B B R p 9 8 6 c 3 C E k c A F e E Y S m 7 j h 0 p N 8 F C U c I g L f d i C R E m Y z y E r q Y c B y D d J P 9 D a p 1 o Z W D 5 o d C P K y t X / 0 4 k O J B y E n i 6 M z t R z n u Z + J / X j Z V / 5 S a U R 7 E C T q a L / J h Z K r S y Q K w B F U A U m 2 i C i a D 6 V o u M s M B E 6 d h m t k i d C w h g W T L O f A 6 L p F W r O m f V 2 t 1 5 p W 4 X G Z X Q E T p G p 8 h B l 6 i O b l E D N R F B T + g F v a I 3 4 9 l 4 N z 6 M z 2 n r k l H M H K A Z G F + / g c W h V A = = < / l a t e x i t > 2 . Action x3 ? p( X 3 |X 3 ) < l a t e x i t s h a 1 _ b a s e 6 4 = " j 6 o V g g x e M 7 S D P r 3 W n 9 1 8 n L / y Z E 8 = " > A A A C T 3 i c b Z D L S g M x F I Y z 9 V b v V Z d u g k V Q 0 D L T a q 0 7 0 Y 1 L B a u F z j B k 0 t M 2 N H M h y Y g l z n P 5 H C 5 d u N V H c C d m 6 g j e f g h 8 / O e c n M M f J J x J Z d t P V m l q e m Z 2 r j y / s L i 0 v L J a W V u / l n E q K L R p z G P R C Y g E z i J o K 6 Y 4 d B I B J A w 4 3 A S j s 7 x + c w t C s j i 6 U u M E v J A M I t Z n l C h j + Z V L 7 U 4 + 6 Y p B 4 G m 7 d t w 8 b L a O 9 u y a P V E O B 8 2 6 Y 2 f u k C h 9 l / m N D L u S h T j Z 6 f g N f I / d k K g h J V x 3 M l / v N 7 J d v 1 L 9 m s Z / w S m g i g p d + J V X t x f T N I R I U U 6 k 7 D p 2 o j x N h G K U Q 7 b g p h I S Q k d k A F 2 D E Q l B e n p y d Y a 3 j d P D / V i Y F y k 8 c b 9 P a B J K O Q 4 D 0 5 k f K n / X c v O / W j d V / Z a n W Z S k C i L 6 u a i f c q x i n O e I e 0 w A V X x s g F D B z K 2 Y D o k g V J m 0 f 2 y R J h 0 Q w D O T j P M 7 h 7 9 w X a 8 5 j V r 9 8 q B 6 c l p k V E a b a A v t I A c d o R N 0 j i 5 Q G 1 H 0 g J 7 R C 3 q 1 H q 0 3 6 7 1 U t J a s A j b Q D 5 X m P w D g Y 7 C b < / l a t e x i t >
1 . Abduction apple the red is very large p( G Y 2 |X , Y ) < l a t e x i t s h a 1 _ b a s e 6 4 = " a A F X u 5 / 1 9 4 l 4 N 9 v V P 4 0 v 7 5 x r L e Q = " > A A A C V X i c b V B b S w J B G B 2 3 M r O L V o + 9 D E l g I L J r Z v U m 9 V C P B Z m G b j I 7 f t r Q 7 I W Z 2 U C 2 / W n 9 j u i 5 h 1 7 q J w T N q o V a B w b O n P P d O E 7 A m V S m + Z o y F h a X 0 s u Z l e z q 2 v p G L r + 5 d S P 9 U F B o U J / 7 o u U Q C Z x 5 0 F B M c W g F A o j r c G g 6 D 2 e J 3 3 w E I Z n v X a t h A L Z L B h 7 r M 0 q U l r r 5 Z l C M O q M x b T F w 7 M g s n 9 Q O a 8 d H J b N s j p C Q a q 1 i m f F 5 t 3 L X c Y m 6 p 4 R H t 3 G M n / D v t x W X 8 J S 3 j 7 v 5 w s 8 E / J d Y E 1 J A E 1 x 2 8 + + d n k 9 D F z x F O Z G y b Z m B s i M i F K M c 4 m w n l B A Q + k A G 0 N b U I y 5 I O x p d H u M 9 r f R w 3 x f 6 e Q q P 1 O m O i L h S D l 1 H V y Z H y n k v E f / z 2 q H q H 9 s R 8 4 J Q g U f H i / o h x 8 r H S Z q 4 x w R Q x Y e a E C q Y v h X T e y I I V T r z m S 1 S J w M C e K y T s e Z z + E t u K m X r o F y 5 q h b q p 5 O M M m g H 7 a I i s t A R q q M L d I k a i K J n 9 I Y + 0 G f q J f V l L B r p c a m R m v R s o x k Y u W 9 b Y L J n < / l a t e x i t >
3 . Prediction ?2 ? p( Y 2 , {X3 x3 , X 3 x 3 , Y 2 y 2 } | X , Y ) < l a t e x i t s h a 1 _ b a s e 6 4 = " a 3 f l g p e x P r A x q e s 1 l T 1 I T + e o v K Y = " > A A A D P H i c j V L L b h M x F P U M r x J e K S z Z W E S I g k I 0 M y l p 2 V X A g g 2 i S K R N F U c N V V J J B n x W i k I O E K h A 8 h 7 7 m W s C g l E C z R M B x c v q y 5 o 8 / g F S 8 y N / r W Q m j j E 5 y n n J G t U v F z T + G z J s M 5 S Q Z m a D z v P e s t 7 / X D j r B P G q w 2 4 v C w J I p 1 W Z m 4 8 h i o n i G y 5 2 T 2 E R t T A z + 3 x a D u I u J g F R T K Y u P e N 7 x z M Z d 6 7 p k V E 8 Z F W Z g Y / O 0 a 9 d 0 N Z e k t b S m V s Q n d S b a K J 4 t K G I t / r T a f a 3 6 c d x s / V s T X w T h E r T Q M g 7 j b e 8 R G R e s y i D X T F C l h m F Q 6 p G h U n M m w D Z I p a C k 7 J R O Y O h g T j N Q I z P 3 x + K H L j P G a S H d y T W e Z 1 c r D M 2 U m m W J U 9 Z L q v N c n d z E D S u d 7 o 8 M z 8 t K Q 8 4 W g 9 J K Y F 3 g + q P j M Z f A t J g 5 Q J n k b l f M p l R S p t 2 v s T Z F O W d A g r C N j c M b 5 B W 4 d 0 t 4 4 2 5 v S 5 B U F / K J I V R O M n p m n Q 8 T 0 q 5 R w 1 k b n j f y I j i K O m G 3 E 7 3 b b R 2 8 W J q 8 h e 6 j B 2 g H h W g P H a D X 6 B D 1 E f O Y 9 9 n 7 4 n 3 1 v / k / / J / + r 4 X U 9 5 Y 1 9 9 B a + L / / A o X S B b 0 = < / l a t e x i t >
Method
Our goal is to take an input sequence pair ( X , Y ) and create augmented data from it .
We aim to do so by removing phrases , resampling them in the source sequence , and computing the counterfactual effect of doing so in the target sequence .
We argue that for any such augmentation method for NMT , it is crucial to leverage both contextual and alignment information , for the following reasons .
( 1 ) Context :
As contextual information is widely used to disambiguate words ( Peters et al. , 2018 ) and generate realistic -looking sequences ( Zellers et al. , 2019 ) , it is critical to utilize contextual information to obtain grammatically -correct and semanticallysound sequences .
( 2 ) Alignment : Phrasal alignment plays a critical role in statistical machine translation ( Brown et al. , 1993 ; Vogel et al. , 1996 ) .
As phrasal alignment provides information about which phrase in the source sequence produces a phrase in the target sequence , a data augmentation algorithm which disregards alignment risks breaking the symmetry between source and target sequences .
To this end , in Section 3 . 2 ) .
Additionally , there are unobserved variables G X i , G Y i that cause each individual phrase ( more on this below ) .
We choose this fully connected structure to take contexts of each phrase into account .
Note that this graph is cyclic , yet the counterfactual distribution we care about is identifiable given the posterior of the unobserved variables ( which we describe below ) and the known equations of the causal model ( i.e. , the translation language model ) .
Consider that we have an alignment between X and Y , which singles - out the causal effects shown with black arrows in Figure 2 .
Our idea is to derive a new sequence pair ( X , ? ) by computing a counterfactual .
We propose to calculate the counterfactual corresponding to a single alignment , i.e. a path-specific counterfactual : " What would Y j have looked like , had X i = xi instead of x i , given that Y j is aligned to X i , and all other phrases X ?i , Y ?j had been held constant ? " .
This allows us to consider 1 . Context :
By holding all other phrases constant we control for the specific context around the changed phrases xi , ?j 1 ; 2 . Alignment :
The derived counterfactual is based on the direct effect of X i on Y j , where this singled - out link is identified from an alignment .
We now outline the three steps to calculate the counterfactual .
The example in Figure 2 is used for illustration .
The goal is to sample from the following counterfactual distribution : p( Y 2 , {X 3 ?x 3 , X ?3 ?x ?3 , Y ?2 ?y ?2 } | X , Y ) with the translation language model , which describes " What would Y 2 have looked like , had X 3 = x3 instead of x 3 , given that Y 2 is aligned to X 3 , and all other phrases X ?3 , Y ?2 had been held constant ? " .
For ease of illustration , we assume both X 3 and Y 2 190 contain one token after Byte Pair Encoding ( BPE ) segmentation ( Sennrich et al. , 2015 b ) .
In Section 3.3 , we explain how we use a sequence - to-sequence model to generate phrases containing multiple tokens after segmentation .
1 . Abduction .
The goal of the abduction step is to estimate any unobserved variables that impact the counterfactual .
As our translation language model specifies a categorical distribution p( Y 2 | X , Y ?2 ) , this unobserved randomness , i.e. the prior of G Y 2 , takes the form of a Gumbel random vector .
This is due to the fact that random sampling from a categorical distribution can be done via a procedure called the Gumbel - Max Trick ( Maddison et al. , 2014 b ) . Definition 3.1 ( Gumbel - Max Trick ) .
Two steps are required to sample from a categorical distribution p( Y ) with K categories : 1 . Sample g 1 , . . . , g K ? Gumbel ( 0 , 1 ) .
Each g k can be computed as g k = ? log (?
log u k ) where u k ? Uniform ( 0 , 1 ) ; 2 . Compute y = arg max k=1 , ... , K log p( Y = k ) + g k .
As such , sampling from the translation language model p( Y 2 | X , Y ?2 ) with vocabulary size | V | can be written as follows , y 2 = arg max k=1 , ... , |V | log p( Y 2 = k|X , Y ?2 ) + g k , s.t. g k ? Gumbel ( 0 , 1 ) .
The abduction step samples from the posterior distribution over these Gumbel random variables , given the observed pair ( X , Y ) , i.e. , p( G Y 2 | X , Y ) .
Fortunately , sampling from the posterior is straightforward to do in two steps ( Maddison et al. , 2014a ; Maddison and Tarlow , 2017 ) ? p( G Y j | X , Y ) Sample ?k * ? Gumbel ( 0 , 1 ) for k ?
1 to | V | do if k = k * then // Sample from truncated Gumbel Sample h k ? Gumbel ( 0 , 1 ) u k = h k + log p( Y j = k|X , Y ?j ) ?k = ? log ( e ?u k + e ? k * ) conditioned on the remaining phrases in X , we sample a realistic replacement word for X 3 .
In Figure 2 , we sample x3 = ' apple ' in place of x 3 = ' house ' .
( 1 ) The sample ?2 from the counterfactual distribution is based on the direct effect of X 3 on Y 2 .
We remark that the causal model we consider was first introduced by Oberst and Sontag ( 2019 ) and called the Gumbel - Max Structural Causal Model .
Our insight here is that counterfactuals from this model can be used as an effective data augmentation method for machine translation .
Data Augmentation
Given the above procedure to replace phrases , we propose a new data augmentation method , shown in Algorithm 2 .
The algorithm takes an input pair of sequences ( X , Y ) and loops through every phrase X i ?
X .
At each iteration with probability c it replaces the phrase pair ( x i , y j ) with ( x i , ?j ) .
Training Language Models
We introduce a special [ MASK ] token ( Devlin et al. , 2018 ) the one- hot representation of a word is replaced by a soft distribution of words given by a language model .
DADA uses gradient information to generate adversarial sequences for more robust NMT .
AdvAug ( Cheng et al. , 2020 ) extends DADA , where embeddings of virtual sequences are sampled from an adversarial distribution for augmentation .
SCDA and AdvAug ignore the alignment information , thereby breaking the symmetry of source and target sequences .
While DADA takes both context and alignment into account , it replaces multiple words in source and target sequences simultaneously , which risks generating unnatural sequences .
In this paper , we utilize both alignment and contextual information to sequentially replace aligned phrases for better performance .
Backtranslation .
The idea of backtranslation dates back to statistical machine translation ( Goutte et al. , 2009 ; Bojar and Tamchyna , 2011 )
Experiments
We now describe the improvements with the data augmentation based on TCWR .
Language Model Details
We use the monolingual training data , including News Commentary and News Crawl 2010 , provided by WMT '18 , for Eq. 2 , while the training set of each language pair is used for Eq. 3 .
The statistics of the monolingual and parallel corpora are summarized in Table 1 and 2 , respectively .
To reduce memory overhead , we train a shared language model for Eq. 2 and 3 , i.e. ? 1 and ?
2 are tied .
A language model is trained for each language pair to avoid performing multilingual NMT for a fair comparison with baselines , as jointly training a single model for several language pairs has been shown to be effective for both low-resource and high- resource languages ( Aharoni et al. , 2019 ) .
Therefore , we pre-train four models for En-Tr , En-De , En-Vi and En-Fr , respectively .
The encoder and decoder are composed of six layers .
The encoder is initialized with XLM ( Lample and Conneau , 2019 ) pre-trained with the masked language model , while the decoder is randomly initialized .
The input-output embeddings are tied for reducing the size of the model ( Press and Wolf , 2016 ) .
To achieve faster convergence , we apply PreNorm ( Nguyen and Salazar , 2019 ) for getting rid of the warm - up stage of Transformer .
The learning rate is set to 1e - 5 and is linearly decayed with more training steps .
The hidden size o is set to 1024 .
Same as BERT , the maximum sequence size is set to 512 .
We use LAMB ( You et al. , 2019 ) as the optimizer .
GELU ( Hendrycks and Gimpel , 2016 ) is used as the activation function .
16 sequences are used at each pre-training step .
We train the masked language model for 50 % of the time and the left time is used for training the translation language model .
NMT Model Details
We use fairseq 2 to implement the NMT models .
The vocabularty size is 37K .
Six encoder and decoder layers are applied .
The hidden size is set to 1024 .
16 self-attention heads are employed .
We use Adam as the optimizer .
The learning rate is initially set to 1e - 7 and is gradually increased to 5e - 4 with 4 K warm - up steps , before applying linear decay .
Dropout is set to 0.3 .
Label smoothing with the smoothing factor 0.1 is used .
For decoding , we use beam search , and the beam size is set to 12 .
SacreBLEU ( Post , 2018 ) is used as the metric .
Sensitivity Study
Pre-training Steps
We study the effect of pre-training steps on machine translation quality .
We use the language models at different pre-training steps and evaluate these models on the development set of the WMT '18 English ?
Turkish task .
The results are shown in Figure 3 .
The BLEU score improves with more pre-training steps and peaks at around 110K steps .
We do not observe better performance with more pre-training steps , as the models become more overfitted on the training sets .
Effect of the XLM Initialization
We plot the learning curves of the language model for En- Tr with / without XLM initialization .
As shown in Figure 4 , the model with the XLM initialization converges faster and better compared to the model with the random initialization .
As XLM is trained using the masked language model objective on large-scale monolingual data , we draw the conclusion that large-scale pre-training can improve downstream language model pre-training tasks .
We further evaluate the models on the development set of the WMT '18 English ?
Turkish task .
The model with the XLM initialization also performs better ( 17.49 BLEU ) compared to its counterpart ( 16.68 BLEU ) .
Thus , the model with the XLM initialization can also generate better data for improving NMT .
Sampling Probability
As shown in Figure 5 , we vary the sampling probability in Algorithm 2 and evaluate on the development set of the WMT '18 English ?
Turkish task .
We observe that the BLEU score is maximized with sampling probability 0.2 .
The BLEU scores decrease with larger sampling probabilities .
components .
We randomly choose a phrase with uniform distribution to replace the original phrase for ablating source and target contexts .
For ablating alignment , we randomly choose a position in the target sequence instead of following the alignment given by pialign .
We also study removing ?k in Eq. 1 . Since ?k comes from the abduction step , which encodes the information from the original pair ( X , Y ) , Eq. 1 encourages the model to sample a new pair that is similar to the original pair .
Therefore , the model without ?k collapses to a probabilistic approach that directly samples phrases from the translation language model , disregarding the information from the original pair .
Ablation Study
The results are shown in Table 3 .
We observe that ablating the source context , target context and alignment are negative for translation quality , demonstrating the necessity of considering all these components for data augmentation .
The result of ablating ?k shows the effectiveness of incorporating the original information from ( X , Y ) .
Translation Result
We evaluate the algorithms on WMT '17 English ? German ( En- De ) , WMT '18 English ? Turkish ( En- Tr ) and IWSLT '15 English ? Vietnamese ( En - Vi ) .
As shown in Table 2 , En-Tr and En- Vi are two low-resource language pairs , while En- De is a highresource language pair .
For En-Tr , we use newstest17 for validation and newstest18 for testing .
For En- De , we use new-stest16 for validation and newstest17 for testing .
For En-Vi , we use the TED tst2012 for validation and the TED tst2013 for testing .
We compare TCWR with six baselines , Word-Dropout , BPEDropout , SwitchOut , SCDA , TDA and DADA .
For WordDropout and BPEDropout , we perform a range search on its dropout probability from 0 to 1 and select the best one on de- velopment sets .
Similarly , we choose the temperature with the highest score on development sets for SwitchOut .
For SCDA , we search the replacing probability and set it to 0.15 .
We follow the official implementation 3 of TDA .
We reuse the hyperparameters from for DADA .
The results on three language pairs are shown in Table 4 . Compared to the baseline with no data augmentation , TCWR yields improvements of 2.03 , 1.63 and 1.79 BLEU for En-Tr , En-De and En-Vi , respectively .
TCWR also outperforms the other augmentation methods , which further confirms the effectiveness of considering source context , target context , and alignment for NMT data augmentation .
Besides , these results demonstrate that TCWR brings consistent improvements to both low-resource and high- resource language pairs .
Backtranslation Result
As backtranslation is a widely - used data augmentation method by utilizing monolingual data to generate new parallel pairs , we show how TCWR can be used with backtranslation .
To perform backtranslation , we use the monolingual sequences from News Crawl 2017 , News Crawl 2010 and VNTC 4 for En-Tr , En-De and En-Vi , respectively .
Then we perform data augmentation on both training data and backtranslated data .
As shown in Table 5 , TCWR improves upon backtranslation , demonstrating that TCWR and backtranslation are not mutually exclusive , and TCWR can enhance the performance of backtranslation .
Machine Translation Robustness
Noisy or non-standard input text ( e.g. text with spelling errors and code switching ) can cause significant degradation in most NMT systems .
We use the WMT'19 English ?
French robustness dataset for evaluating translation robustness .
As the parallel pairs are scarce for this task , we com -195 En : Kosovo is taking a hard look at its privatisation process in light of recurring [ complaints / problems ] training examples with language models trained using noisy and non-standard text .
We thereby conclude that TCWR can improve NMT robustness .
Case Study
As shown in Table 6 , we perform a case study of TCWR .
We observe that TCWR can reasonably substitute words in source sequences based on contexts and modify corresponding target words , which demonstrates the benefits of considering both context and alignment for augmentation .
Conclusion
We proposed a data augmentation method for NMT , which introduces a causal inductive bias that takes both context and alignment into account .
The method was shown to improve the performance of translation , backtranslation and translation robustness on four NMT benchmarks .
r 2 A e 0 s U y m N + 3 Q y S T M T I Q S A n 6 H H + B W P 8 G d u H X n F / g b T t I s b O u B g X P P u Z d 7 5 3 g R o 1 L Z 9 r d R W l l d W 9 8 o b 1 a 2 t n d 2 9 8 z 9 g 7 Y M Y 0 G g R U I W i q 6 H J T D K o a W o Y t C N B O D A Y 9 D x J t e Z3 3 k E I W n I 7 9 U 0 A j f A I 0 5 9 S r D S 0 s A 8 6 g d Y j T 0 / u U k H S T 1 9 y
